import{dE as Br,dF as Hr,dG as Ur,dH as kr,dI as Wr,dJ as Xr,dK as dr,g as Vr,T as Re,G as Ee,F as $,C as jt,p as Rt,m as ke,dL as zr,dM as Gr,dN as gi,$ as r,i as oe,b as qr,S as jr,dO as yi,dP as $t,c as Yt,dQ as Zt,dR as At,J as He,U as Ye,R as ot,N as Ge,dS as et,Y as tt,W as Ze,dT as $r,z as qe,H as Bt,X as Vn,I as Yr,K as Zr,E as Kr,dU as Jr,dV as Qr,dW as Ke,dX as le,dY as xt,dZ as eo,d_ as Tt,M as mt,d as gt,o as vi,_ as Ce,Q as Et,d$ as Kt,Z as Pt,a0 as St,e0 as to,e1 as Ht,e2 as wi,e3 as no,e4 as Jt,e5 as io,e6 as ro,e7 as oo,e8 as so}from"./index--BqaKNiR.js";import{T as ao}from"./TileWMS-Ojl1fCoy.js";import{d as _e}from"./dialog-CY10jn-b.js";class kt extends Br{constructor(l,M,m){super(),m!==void 0&&M===void 0?this.setFlatCoordinates(m,l):(M=M||0,this.setCenterAndRadius(l,M,m))}clone(){const l=new kt(this.flatCoordinates.slice(),void 0,this.layout);return l.applyProperties(this),l}closestPointXY(l,M,m,g){const o=this.flatCoordinates,i=l-o[0],t=M-o[1],p=i*i+t*t;if(p<g){if(p===0)for(let x=0;x<this.stride;++x)m[x]=o[x];else{const x=this.getRadius()/Math.sqrt(p);m[0]=o[0]+x*i,m[1]=o[1]+x*t;for(let b=2;b<this.stride;++b)m[b]=o[b]}return m.length=this.stride,p}return g}containsXY(l,M){const m=this.flatCoordinates,g=l-m[0],o=M-m[1];return g*g+o*o<=this.getRadiusSquared_()}getCenter(){return this.flatCoordinates.slice(0,this.stride)}computeExtent(l){const M=this.flatCoordinates,m=M[this.stride]-M[0];return Hr(M[0]-m,M[1]-m,M[0]+m,M[1]+m,l)}getRadius(){return Math.sqrt(this.getRadiusSquared_())}getRadiusSquared_(){const l=this.flatCoordinates[this.stride]-this.flatCoordinates[0],M=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return l*l+M*M}getType(){return"Circle"}intersectsExtent(l){const M=this.getExtent();if(Ur(l,M)){const m=this.getCenter();return l[0]<=m[0]&&l[2]>=m[0]||l[1]<=m[1]&&l[3]>=m[1]?!0:kr(l,this.intersectsCoordinate.bind(this))}return!1}setCenter(l){const M=this.stride,m=this.flatCoordinates[M]-this.flatCoordinates[0],g=l.slice();g[M]=g[0]+m;for(let o=1;o<M;++o)g[M+o]=l[o];this.setFlatCoordinates(this.layout,g),this.changed()}setCenterAndRadius(l,M,m){this.setLayout(m,l,0),this.flatCoordinates||(this.flatCoordinates=[]);const g=this.flatCoordinates;let o=Wr(g,0,l,this.stride);g[o++]=g[0]+M;for(let i=1,t=this.stride;i<t;++i)g[o++]=g[i];g.length=o,this.changed()}getCoordinates(){return null}setCoordinates(l,M){}setRadius(l){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+l,this.changed()}rotate(l,M){const m=this.getCenter(),g=this.getStride();this.setCenter(Xr(m,0,m.length,g,l,M,m)),this.changed()}}var st={},Qt={},Ai;function jn(){return Ai||(Ai=1,(function(){Qt.defaults={"0.1":{explicitCharkey:!1,trim:!0,normalize:!0,normalizeTags:!1,attrkey:"@",charkey:"#",explicitArray:!1,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!1,validator:null,xmlns:!1,explicitChildren:!1,childkey:"@@",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,emptyTag:""},"0.2":{explicitCharkey:!1,trim:!1,normalize:!1,normalizeTags:!1,attrkey:"$",charkey:"_",explicitArray:!0,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!0,validator:null,xmlns:!1,explicitChildren:!1,preserveChildrenOrder:!1,childkey:"$$",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,rootName:"root",xmldec:{version:"1.0",encoding:"UTF-8",standalone:!0},doctype:null,renderOpts:{pretty:!0,indent:"  ",newline:`
`},headless:!1,chunkSize:1e4,emptyTag:"",cdata:!1}}}).call(Qt)),Qt}var en={},at={},lt={},Ei;function ct(){return Ei||(Ei=1,(function(){var v,l,M,m,g,o,i,t=[].slice,p={}.hasOwnProperty;v=function(){var x,b,w,A,E,L;if(L=arguments[0],E=2<=arguments.length?t.call(arguments,1):[],g(Object.assign))Object.assign.apply(null,arguments);else for(x=0,w=E.length;x<w;x++)if(A=E[x],A!=null)for(b in A)p.call(A,b)&&(L[b]=A[b]);return L},g=function(x){return!!x&&Object.prototype.toString.call(x)==="[object Function]"},o=function(x){var b;return!!x&&((b=typeof x)=="function"||b==="object")},M=function(x){return g(Array.isArray)?Array.isArray(x):Object.prototype.toString.call(x)==="[object Array]"},m=function(x){var b;if(M(x))return!x.length;for(b in x)if(p.call(x,b))return!1;return!0},i=function(x){var b,w;return o(x)&&(w=Object.getPrototypeOf(x))&&(b=w.constructor)&&typeof b=="function"&&b instanceof b&&Function.prototype.toString.call(b)===Function.prototype.toString.call(Object)},l=function(x){return g(x.valueOf)?x.valueOf():x},lt.assign=v,lt.isFunction=g,lt.isObject=o,lt.isArray=M,lt.isEmpty=m,lt.isPlainObject=i,lt.getValue=l}).call(lt)),lt}var sn={exports:{}},lo=sn.exports,bi;function fr(){return bi||(bi=1,(function(){sn.exports=(function(){function v(){}return v.prototype.hasFeature=function(l,M){return!0},v.prototype.createDocumentType=function(l,M,m){throw new Error("This DOM method is not implemented.")},v.prototype.createDocument=function(l,M,m){throw new Error("This DOM method is not implemented.")},v.prototype.createHTMLDocument=function(l){throw new Error("This DOM method is not implemented.")},v.prototype.getFeature=function(l,M){throw new Error("This DOM method is not implemented.")},v})()}).call(lo)),sn.exports}var an={exports:{}},ln={exports:{}},un={exports:{}},uo=un.exports,_i;function co(){return _i||(_i=1,(function(){un.exports=(function(){function v(){}return v.prototype.handleError=function(l){throw new Error(l)},v})()}).call(uo)),un.exports}var cn={exports:{}},po=cn.exports,Li;function fo(){return Li||(Li=1,(function(){cn.exports=(function(){function v(l){this.arr=l||[]}return Object.defineProperty(v.prototype,"length",{get:function(){return this.arr.length}}),v.prototype.item=function(l){return this.arr[l]||null},v.prototype.contains=function(l){return this.arr.indexOf(l)!==-1},v})()}).call(po)),cn.exports}var ho=ln.exports,Mi;function mo(){return Mi||(Mi=1,(function(){var v,l;v=co(),l=fo(),ln.exports=(function(){function M(){this.defaultParams={"canonical-form":!1,"cdata-sections":!1,comments:!1,"datatype-normalization":!1,"element-content-whitespace":!0,entities:!0,"error-handler":new v,infoset:!0,"validate-if-schema":!1,namespaces:!0,"namespace-declarations":!0,"normalize-characters":!1,"schema-location":"","schema-type":"","split-cdata-sections":!0,validate:!1,"well-formed":!0},this.params=Object.create(this.defaultParams)}return Object.defineProperty(M.prototype,"parameterNames",{get:function(){return new l(Object.keys(this.defaultParams))}}),M.prototype.getParameter=function(m){return this.params.hasOwnProperty(m)?this.params[m]:null},M.prototype.canSetParameter=function(m,g){return!0},M.prototype.setParameter=function(m,g){return g!=null?this.params[m]=g:delete this.params[m]},M})()}).call(ho)),ln.exports}var pn={exports:{}},dn={exports:{}},fn={exports:{}},go=fn.exports,xi;function We(){return xi||(xi=1,(function(){fn.exports={Element:1,Attribute:2,Text:3,CData:4,EntityReference:5,EntityDeclaration:6,ProcessingInstruction:7,Comment:8,Document:9,DocType:10,DocumentFragment:11,NotationDeclaration:12,Declaration:201,Raw:202,AttributeDeclaration:203,ElementDeclaration:204,Dummy:205}}).call(go)),fn.exports}var hn={exports:{}},yo=hn.exports,Ti;function hr(){return Ti||(Ti=1,(function(){var v;v=We(),nt(),hn.exports=(function(){function l(M,m,g){if(this.parent=M,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),m==null)throw new Error("Missing attribute name. "+this.debugInfo(m));this.name=this.stringify.name(m),this.value=this.stringify.attValue(g),this.type=v.Attribute,this.isId=!1,this.schemaTypeInfo=null}return Object.defineProperty(l.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(l.prototype,"ownerElement",{get:function(){return this.parent}}),Object.defineProperty(l.prototype,"textContent",{get:function(){return this.value},set:function(M){return this.value=M||""}}),Object.defineProperty(l.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(l.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(l.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(l.prototype,"specified",{get:function(){return!0}}),l.prototype.clone=function(){return Object.create(this)},l.prototype.toString=function(M){return this.options.writer.attribute(this,this.options.writer.filterOptions(M))},l.prototype.debugInfo=function(M){return M=M||this.name,M==null?"parent: <"+this.parent.name+">":"attribute: {"+M+"}, parent: <"+this.parent.name+">"},l.prototype.isEqualNode=function(M){return!(M.namespaceURI!==this.namespaceURI||M.prefix!==this.prefix||M.localName!==this.localName||M.value!==this.value)},l})()}).call(yo)),hn.exports}var mn={exports:{}},vo=mn.exports,Pi;function $n(){return Pi||(Pi=1,(function(){mn.exports=(function(){function v(l){this.nodes=l}return Object.defineProperty(v.prototype,"length",{get:function(){return Object.keys(this.nodes).length||0}}),v.prototype.clone=function(){return this.nodes=null},v.prototype.getNamedItem=function(l){return this.nodes[l]},v.prototype.setNamedItem=function(l){var M;return M=this.nodes[l.nodeName],this.nodes[l.nodeName]=l,M||null},v.prototype.removeNamedItem=function(l){var M;return M=this.nodes[l],delete this.nodes[l],M||null},v.prototype.item=function(l){return this.nodes[Object.keys(this.nodes)[l]]||null},v.prototype.getNamedItemNS=function(l,M){throw new Error("This DOM method is not implemented.")},v.prototype.setNamedItemNS=function(l){throw new Error("This DOM method is not implemented.")},v.prototype.removeNamedItemNS=function(l,M){throw new Error("This DOM method is not implemented.")},v})()}).call(vo)),mn.exports}var wo=dn.exports,Si;function Yn(){return Si||(Si=1,(function(){var v,l,M,m,g,o,i,t,p=function(b,w){for(var A in w)x.call(w,A)&&(b[A]=w[A]);function E(){this.constructor=b}return E.prototype=w.prototype,b.prototype=new E,b.__super__=w.prototype,b},x={}.hasOwnProperty;t=ct(),i=t.isObject,o=t.isFunction,g=t.getValue,m=nt(),v=We(),l=hr(),M=$n(),dn.exports=(function(b){p(w,b);function w(A,E,L){var D,F,I,T;if(w.__super__.constructor.call(this,A),E==null)throw new Error("Missing element name. "+this.debugInfo());if(this.name=this.stringify.name(E),this.type=v.Element,this.attribs={},this.schemaTypeInfo=null,L!=null&&this.attribute(L),A.type===v.Document&&(this.isRoot=!0,this.documentObject=A,A.rootObject=this,A.children)){for(T=A.children,F=0,I=T.length;F<I;F++)if(D=T[F],D.type===v.DocType){D.name=this.name;break}}}return Object.defineProperty(w.prototype,"tagName",{get:function(){return this.name}}),Object.defineProperty(w.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(w.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(w.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(w.prototype,"id",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(w.prototype,"className",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(w.prototype,"classList",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(w.prototype,"attributes",{get:function(){return(!this.attributeMap||!this.attributeMap.nodes)&&(this.attributeMap=new M(this.attribs)),this.attributeMap}}),w.prototype.clone=function(){var A,E,L,D;L=Object.create(this),L.isRoot&&(L.documentObject=null),L.attribs={},D=this.attribs;for(E in D)x.call(D,E)&&(A=D[E],L.attribs[E]=A.clone());return L.children=[],this.children.forEach(function(F){var I;return I=F.clone(),I.parent=L,L.children.push(I)}),L},w.prototype.attribute=function(A,E){var L,D;if(A!=null&&(A=g(A)),i(A))for(L in A)x.call(A,L)&&(D=A[L],this.attribute(L,D));else o(E)&&(E=E.apply()),this.options.keepNullAttributes&&E==null?this.attribs[A]=new l(this,A,""):E!=null&&(this.attribs[A]=new l(this,A,E));return this},w.prototype.removeAttribute=function(A){var E,L,D;if(A==null)throw new Error("Missing attribute name. "+this.debugInfo());if(A=g(A),Array.isArray(A))for(L=0,D=A.length;L<D;L++)E=A[L],delete this.attribs[E];else delete this.attribs[A];return this},w.prototype.toString=function(A){return this.options.writer.element(this,this.options.writer.filterOptions(A))},w.prototype.att=function(A,E){return this.attribute(A,E)},w.prototype.a=function(A,E){return this.attribute(A,E)},w.prototype.getAttribute=function(A){return this.attribs.hasOwnProperty(A)?this.attribs[A].value:null},w.prototype.setAttribute=function(A,E){throw new Error("This DOM method is not implemented."+this.debugInfo())},w.prototype.getAttributeNode=function(A){return this.attribs.hasOwnProperty(A)?this.attribs[A]:null},w.prototype.setAttributeNode=function(A){throw new Error("This DOM method is not implemented."+this.debugInfo())},w.prototype.removeAttributeNode=function(A){throw new Error("This DOM method is not implemented."+this.debugInfo())},w.prototype.getElementsByTagName=function(A){throw new Error("This DOM method is not implemented."+this.debugInfo())},w.prototype.getAttributeNS=function(A,E){throw new Error("This DOM method is not implemented."+this.debugInfo())},w.prototype.setAttributeNS=function(A,E,L){throw new Error("This DOM method is not implemented."+this.debugInfo())},w.prototype.removeAttributeNS=function(A,E){throw new Error("This DOM method is not implemented."+this.debugInfo())},w.prototype.getAttributeNodeNS=function(A,E){throw new Error("This DOM method is not implemented."+this.debugInfo())},w.prototype.setAttributeNodeNS=function(A){throw new Error("This DOM method is not implemented."+this.debugInfo())},w.prototype.getElementsByTagNameNS=function(A,E){throw new Error("This DOM method is not implemented."+this.debugInfo())},w.prototype.hasAttribute=function(A){return this.attribs.hasOwnProperty(A)},w.prototype.hasAttributeNS=function(A,E){throw new Error("This DOM method is not implemented."+this.debugInfo())},w.prototype.setIdAttribute=function(A,E){return this.attribs.hasOwnProperty(A)?this.attribs[A].isId:E},w.prototype.setIdAttributeNS=function(A,E,L){throw new Error("This DOM method is not implemented."+this.debugInfo())},w.prototype.setIdAttributeNode=function(A,E){throw new Error("This DOM method is not implemented."+this.debugInfo())},w.prototype.getElementsByTagName=function(A){throw new Error("This DOM method is not implemented."+this.debugInfo())},w.prototype.getElementsByTagNameNS=function(A,E){throw new Error("This DOM method is not implemented."+this.debugInfo())},w.prototype.getElementsByClassName=function(A){throw new Error("This DOM method is not implemented."+this.debugInfo())},w.prototype.isEqualNode=function(A){var E,L,D;if(!w.__super__.isEqualNode.apply(this,arguments).isEqualNode(A)||A.namespaceURI!==this.namespaceURI||A.prefix!==this.prefix||A.localName!==this.localName||A.attribs.length!==this.attribs.length)return!1;for(E=L=0,D=this.attribs.length-1;0<=D?L<=D:L>=D;E=0<=D?++L:--L)if(!this.attribs[E].isEqualNode(A.attribs[E]))return!1;return!0},w})(m)}).call(wo)),dn.exports}var gn={exports:{}},yn={exports:{}},Ao=yn.exports,Ni;function Bn(){return Ni||(Ni=1,(function(){var v,l=function(m,g){for(var o in g)M.call(g,o)&&(m[o]=g[o]);function i(){this.constructor=m}return i.prototype=g.prototype,m.prototype=new i,m.__super__=g.prototype,m},M={}.hasOwnProperty;v=nt(),yn.exports=(function(m){l(g,m);function g(o){g.__super__.constructor.call(this,o),this.value=""}return Object.defineProperty(g.prototype,"data",{get:function(){return this.value},set:function(o){return this.value=o||""}}),Object.defineProperty(g.prototype,"length",{get:function(){return this.value.length}}),Object.defineProperty(g.prototype,"textContent",{get:function(){return this.value},set:function(o){return this.value=o||""}}),g.prototype.clone=function(){return Object.create(this)},g.prototype.substringData=function(o,i){throw new Error("This DOM method is not implemented."+this.debugInfo())},g.prototype.appendData=function(o){throw new Error("This DOM method is not implemented."+this.debugInfo())},g.prototype.insertData=function(o,i){throw new Error("This DOM method is not implemented."+this.debugInfo())},g.prototype.deleteData=function(o,i){throw new Error("This DOM method is not implemented."+this.debugInfo())},g.prototype.replaceData=function(o,i,t){throw new Error("This DOM method is not implemented."+this.debugInfo())},g.prototype.isEqualNode=function(o){return!(!g.__super__.isEqualNode.apply(this,arguments).isEqualNode(o)||o.data!==this.data)},g})(v)}).call(Ao)),yn.exports}var Eo=gn.exports,Oi;function Zn(){return Oi||(Oi=1,(function(){var v,l,M=function(g,o){for(var i in o)m.call(o,i)&&(g[i]=o[i]);function t(){this.constructor=g}return t.prototype=o.prototype,g.prototype=new t,g.__super__=o.prototype,g},m={}.hasOwnProperty;v=We(),l=Bn(),gn.exports=(function(g){M(o,g);function o(i,t){if(o.__super__.constructor.call(this,i),t==null)throw new Error("Missing CDATA text. "+this.debugInfo());this.name="#cdata-section",this.type=v.CData,this.value=this.stringify.cdata(t)}return o.prototype.clone=function(){return Object.create(this)},o.prototype.toString=function(i){return this.options.writer.cdata(this,this.options.writer.filterOptions(i))},o})(l)}).call(Eo)),gn.exports}var vn={exports:{}},bo=vn.exports,Ii;function Kn(){return Ii||(Ii=1,(function(){var v,l,M=function(g,o){for(var i in o)m.call(o,i)&&(g[i]=o[i]);function t(){this.constructor=g}return t.prototype=o.prototype,g.prototype=new t,g.__super__=o.prototype,g},m={}.hasOwnProperty;v=We(),l=Bn(),vn.exports=(function(g){M(o,g);function o(i,t){if(o.__super__.constructor.call(this,i),t==null)throw new Error("Missing comment text. "+this.debugInfo());this.name="#comment",this.type=v.Comment,this.value=this.stringify.comment(t)}return o.prototype.clone=function(){return Object.create(this)},o.prototype.toString=function(i){return this.options.writer.comment(this,this.options.writer.filterOptions(i))},o})(l)}).call(bo)),vn.exports}var wn={exports:{}},_o=wn.exports,Di;function Jn(){return Di||(Di=1,(function(){var v,l,M,m=function(o,i){for(var t in i)g.call(i,t)&&(o[t]=i[t]);function p(){this.constructor=o}return p.prototype=i.prototype,o.prototype=new p,o.__super__=i.prototype,o},g={}.hasOwnProperty;M=ct().isObject,l=nt(),v=We(),wn.exports=(function(o){m(i,o);function i(t,p,x,b){var w;i.__super__.constructor.call(this,t),M(p)&&(w=p,p=w.version,x=w.encoding,b=w.standalone),p||(p="1.0"),this.type=v.Declaration,this.version=this.stringify.xmlVersion(p),x!=null&&(this.encoding=this.stringify.xmlEncoding(x)),b!=null&&(this.standalone=this.stringify.xmlStandalone(b))}return i.prototype.toString=function(t){return this.options.writer.declaration(this,this.options.writer.filterOptions(t))},i})(l)}).call(_o)),wn.exports}var An={exports:{}},En={exports:{}},Lo=En.exports,Ci;function Qn(){return Ci||(Ci=1,(function(){var v,l,M=function(g,o){for(var i in o)m.call(o,i)&&(g[i]=o[i]);function t(){this.constructor=g}return t.prototype=o.prototype,g.prototype=new t,g.__super__=o.prototype,g},m={}.hasOwnProperty;l=nt(),v=We(),En.exports=(function(g){M(o,g);function o(i,t,p,x,b,w){if(o.__super__.constructor.call(this,i),t==null)throw new Error("Missing DTD element name. "+this.debugInfo());if(p==null)throw new Error("Missing DTD attribute name. "+this.debugInfo(t));if(!x)throw new Error("Missing DTD attribute type. "+this.debugInfo(t));if(!b)throw new Error("Missing DTD attribute default. "+this.debugInfo(t));if(b.indexOf("#")!==0&&(b="#"+b),!b.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/))throw new Error("Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT. "+this.debugInfo(t));if(w&&!b.match(/^(#FIXED|#DEFAULT)$/))throw new Error("Default value only applies to #FIXED or #DEFAULT. "+this.debugInfo(t));this.elementName=this.stringify.name(t),this.type=v.AttributeDeclaration,this.attributeName=this.stringify.name(p),this.attributeType=this.stringify.dtdAttType(x),w&&(this.defaultValue=this.stringify.dtdAttDefault(w)),this.defaultValueType=b}return o.prototype.toString=function(i){return this.options.writer.dtdAttList(this,this.options.writer.filterOptions(i))},o})(l)}).call(Lo)),En.exports}var bn={exports:{}},Mo=bn.exports,Fi;function ei(){return Fi||(Fi=1,(function(){var v,l,M,m=function(o,i){for(var t in i)g.call(i,t)&&(o[t]=i[t]);function p(){this.constructor=o}return p.prototype=i.prototype,o.prototype=new p,o.__super__=i.prototype,o},g={}.hasOwnProperty;M=ct().isObject,l=nt(),v=We(),bn.exports=(function(o){m(i,o);function i(t,p,x,b){if(i.__super__.constructor.call(this,t),x==null)throw new Error("Missing DTD entity name. "+this.debugInfo(x));if(b==null)throw new Error("Missing DTD entity value. "+this.debugInfo(x));if(this.pe=!!p,this.name=this.stringify.name(x),this.type=v.EntityDeclaration,!M(b))this.value=this.stringify.dtdEntityValue(b),this.internal=!0;else{if(!b.pubID&&!b.sysID)throw new Error("Public and/or system identifiers are required for an external entity. "+this.debugInfo(x));if(b.pubID&&!b.sysID)throw new Error("System identifier is required for a public external entity. "+this.debugInfo(x));if(this.internal=!1,b.pubID!=null&&(this.pubID=this.stringify.dtdPubID(b.pubID)),b.sysID!=null&&(this.sysID=this.stringify.dtdSysID(b.sysID)),b.nData!=null&&(this.nData=this.stringify.dtdNData(b.nData)),this.pe&&this.nData)throw new Error("Notation declaration is not allowed in a parameter entity. "+this.debugInfo(x))}}return Object.defineProperty(i.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(i.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(i.prototype,"notationName",{get:function(){return this.nData||null}}),Object.defineProperty(i.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(i.prototype,"xmlEncoding",{get:function(){return null}}),Object.defineProperty(i.prototype,"xmlVersion",{get:function(){return null}}),i.prototype.toString=function(t){return this.options.writer.dtdEntity(this,this.options.writer.filterOptions(t))},i})(l)}).call(Mo)),bn.exports}var _n={exports:{}},xo=_n.exports,Ri;function ti(){return Ri||(Ri=1,(function(){var v,l,M=function(g,o){for(var i in o)m.call(o,i)&&(g[i]=o[i]);function t(){this.constructor=g}return t.prototype=o.prototype,g.prototype=new t,g.__super__=o.prototype,g},m={}.hasOwnProperty;l=nt(),v=We(),_n.exports=(function(g){M(o,g);function o(i,t,p){if(o.__super__.constructor.call(this,i),t==null)throw new Error("Missing DTD element name. "+this.debugInfo());p||(p="(#PCDATA)"),Array.isArray(p)&&(p="("+p.join(",")+")"),this.name=this.stringify.name(t),this.type=v.ElementDeclaration,this.value=this.stringify.dtdElementValue(p)}return o.prototype.toString=function(i){return this.options.writer.dtdElement(this,this.options.writer.filterOptions(i))},o})(l)}).call(xo)),_n.exports}var Ln={exports:{}},To=Ln.exports,Bi;function ni(){return Bi||(Bi=1,(function(){var v,l,M=function(g,o){for(var i in o)m.call(o,i)&&(g[i]=o[i]);function t(){this.constructor=g}return t.prototype=o.prototype,g.prototype=new t,g.__super__=o.prototype,g},m={}.hasOwnProperty;l=nt(),v=We(),Ln.exports=(function(g){M(o,g);function o(i,t,p){if(o.__super__.constructor.call(this,i),t==null)throw new Error("Missing DTD notation name. "+this.debugInfo(t));if(!p.pubID&&!p.sysID)throw new Error("Public or system identifiers are required for an external entity. "+this.debugInfo(t));this.name=this.stringify.name(t),this.type=v.NotationDeclaration,p.pubID!=null&&(this.pubID=this.stringify.dtdPubID(p.pubID)),p.sysID!=null&&(this.sysID=this.stringify.dtdSysID(p.sysID))}return Object.defineProperty(o.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(o.prototype,"systemId",{get:function(){return this.sysID}}),o.prototype.toString=function(i){return this.options.writer.dtdNotation(this,this.options.writer.filterOptions(i))},o})(l)}).call(To)),Ln.exports}var Po=An.exports,Hi;function ii(){return Hi||(Hi=1,(function(){var v,l,M,m,g,o,i,t,p=function(b,w){for(var A in w)x.call(w,A)&&(b[A]=w[A]);function E(){this.constructor=b}return E.prototype=w.prototype,b.prototype=new E,b.__super__=w.prototype,b},x={}.hasOwnProperty;t=ct().isObject,i=nt(),v=We(),l=Qn(),m=ei(),M=ti(),g=ni(),o=$n(),An.exports=(function(b){p(w,b);function w(A,E,L){var D,F,I,T,u,h;if(w.__super__.constructor.call(this,A),this.type=v.DocType,A.children){for(T=A.children,F=0,I=T.length;F<I;F++)if(D=T[F],D.type===v.Element){this.name=D.name;break}}this.documentObject=A,t(E)&&(u=E,E=u.pubID,L=u.sysID),L==null&&(h=[E,L],L=h[0],E=h[1]),E!=null&&(this.pubID=this.stringify.dtdPubID(E)),L!=null&&(this.sysID=this.stringify.dtdSysID(L))}return Object.defineProperty(w.prototype,"entities",{get:function(){var A,E,L,D,F;for(D={},F=this.children,E=0,L=F.length;E<L;E++)A=F[E],A.type===v.EntityDeclaration&&!A.pe&&(D[A.name]=A);return new o(D)}}),Object.defineProperty(w.prototype,"notations",{get:function(){var A,E,L,D,F;for(D={},F=this.children,E=0,L=F.length;E<L;E++)A=F[E],A.type===v.NotationDeclaration&&(D[A.name]=A);return new o(D)}}),Object.defineProperty(w.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(w.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(w.prototype,"internalSubset",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),w.prototype.element=function(A,E){var L;return L=new M(this,A,E),this.children.push(L),this},w.prototype.attList=function(A,E,L,D,F){var I;return I=new l(this,A,E,L,D,F),this.children.push(I),this},w.prototype.entity=function(A,E){var L;return L=new m(this,!1,A,E),this.children.push(L),this},w.prototype.pEntity=function(A,E){var L;return L=new m(this,!0,A,E),this.children.push(L),this},w.prototype.notation=function(A,E){var L;return L=new g(this,A,E),this.children.push(L),this},w.prototype.toString=function(A){return this.options.writer.docType(this,this.options.writer.filterOptions(A))},w.prototype.ele=function(A,E){return this.element(A,E)},w.prototype.att=function(A,E,L,D,F){return this.attList(A,E,L,D,F)},w.prototype.ent=function(A,E){return this.entity(A,E)},w.prototype.pent=function(A,E){return this.pEntity(A,E)},w.prototype.not=function(A,E){return this.notation(A,E)},w.prototype.up=function(){return this.root()||this.documentObject},w.prototype.isEqualNode=function(A){return!(!w.__super__.isEqualNode.apply(this,arguments).isEqualNode(A)||A.name!==this.name||A.publicId!==this.publicId||A.systemId!==this.systemId)},w})(i)}).call(Po)),An.exports}var Mn={exports:{}},So=Mn.exports,Ui;function ri(){return Ui||(Ui=1,(function(){var v,l,M=function(g,o){for(var i in o)m.call(o,i)&&(g[i]=o[i]);function t(){this.constructor=g}return t.prototype=o.prototype,g.prototype=new t,g.__super__=o.prototype,g},m={}.hasOwnProperty;v=We(),l=nt(),Mn.exports=(function(g){M(o,g);function o(i,t){if(o.__super__.constructor.call(this,i),t==null)throw new Error("Missing raw text. "+this.debugInfo());this.type=v.Raw,this.value=this.stringify.raw(t)}return o.prototype.clone=function(){return Object.create(this)},o.prototype.toString=function(i){return this.options.writer.raw(this,this.options.writer.filterOptions(i))},o})(l)}).call(So)),Mn.exports}var xn={exports:{}},No=xn.exports,ki;function oi(){return ki||(ki=1,(function(){var v,l,M=function(g,o){for(var i in o)m.call(o,i)&&(g[i]=o[i]);function t(){this.constructor=g}return t.prototype=o.prototype,g.prototype=new t,g.__super__=o.prototype,g},m={}.hasOwnProperty;v=We(),l=Bn(),xn.exports=(function(g){M(o,g);function o(i,t){if(o.__super__.constructor.call(this,i),t==null)throw new Error("Missing element text. "+this.debugInfo());this.name="#text",this.type=v.Text,this.value=this.stringify.text(t)}return Object.defineProperty(o.prototype,"isElementContentWhitespace",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(o.prototype,"wholeText",{get:function(){var i,t,p;for(p="",t=this.previousSibling;t;)p=t.data+p,t=t.previousSibling;for(p+=this.data,i=this.nextSibling;i;)p=p+i.data,i=i.nextSibling;return p}}),o.prototype.clone=function(){return Object.create(this)},o.prototype.toString=function(i){return this.options.writer.text(this,this.options.writer.filterOptions(i))},o.prototype.splitText=function(i){throw new Error("This DOM method is not implemented."+this.debugInfo())},o.prototype.replaceWholeText=function(i){throw new Error("This DOM method is not implemented."+this.debugInfo())},o})(l)}).call(No)),xn.exports}var Tn={exports:{}},Oo=Tn.exports,Wi;function si(){return Wi||(Wi=1,(function(){var v,l,M=function(g,o){for(var i in o)m.call(o,i)&&(g[i]=o[i]);function t(){this.constructor=g}return t.prototype=o.prototype,g.prototype=new t,g.__super__=o.prototype,g},m={}.hasOwnProperty;v=We(),l=Bn(),Tn.exports=(function(g){M(o,g);function o(i,t,p){if(o.__super__.constructor.call(this,i),t==null)throw new Error("Missing instruction target. "+this.debugInfo());this.type=v.ProcessingInstruction,this.target=this.stringify.insTarget(t),this.name=this.target,p&&(this.value=this.stringify.insValue(p))}return o.prototype.clone=function(){return Object.create(this)},o.prototype.toString=function(i){return this.options.writer.processingInstruction(this,this.options.writer.filterOptions(i))},o.prototype.isEqualNode=function(i){return!(!o.__super__.isEqualNode.apply(this,arguments).isEqualNode(i)||i.target!==this.target)},o})(l)}).call(Oo)),Tn.exports}var Pn={exports:{}},Io=Pn.exports,Xi;function mr(){return Xi||(Xi=1,(function(){var v,l,M=function(g,o){for(var i in o)m.call(o,i)&&(g[i]=o[i]);function t(){this.constructor=g}return t.prototype=o.prototype,g.prototype=new t,g.__super__=o.prototype,g},m={}.hasOwnProperty;l=nt(),v=We(),Pn.exports=(function(g){M(o,g);function o(i){o.__super__.constructor.call(this,i),this.type=v.Dummy}return o.prototype.clone=function(){return Object.create(this)},o.prototype.toString=function(i){return""},o})(l)}).call(Io)),Pn.exports}var Sn={exports:{}},Do=Sn.exports,Vi;function Co(){return Vi||(Vi=1,(function(){Sn.exports=(function(){function v(l){this.nodes=l}return Object.defineProperty(v.prototype,"length",{get:function(){return this.nodes.length||0}}),v.prototype.clone=function(){return this.nodes=null},v.prototype.item=function(l){return this.nodes[l]||null},v})()}).call(Do)),Sn.exports}var Nn={exports:{}},Fo=Nn.exports,zi;function Ro(){return zi||(zi=1,(function(){Nn.exports={Disconnected:1,Preceding:2,Following:4,Contains:8,ContainedBy:16,ImplementationSpecific:32}}).call(Fo)),Nn.exports}var Bo=pn.exports,Gi;function nt(){return Gi||(Gi=1,(function(){var v,l,M,m,g,o,i,t,p,x,b,w,A,E,L,D,F,I={}.hasOwnProperty;F=ct(),D=F.isObject,L=F.isFunction,E=F.isEmpty,A=F.getValue,t=null,M=null,m=null,g=null,o=null,b=null,w=null,x=null,i=null,l=null,p=null,v=null,pn.exports=(function(){function T(u){this.parent=u,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),this.value=null,this.children=[],this.baseURI=null,t||(t=Yn(),M=Zn(),m=Kn(),g=Jn(),o=ii(),b=ri(),w=oi(),x=si(),i=mr(),l=We(),p=Co(),$n(),v=Ro())}return Object.defineProperty(T.prototype,"nodeName",{get:function(){return this.name}}),Object.defineProperty(T.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(T.prototype,"nodeValue",{get:function(){return this.value}}),Object.defineProperty(T.prototype,"parentNode",{get:function(){return this.parent}}),Object.defineProperty(T.prototype,"childNodes",{get:function(){return(!this.childNodeList||!this.childNodeList.nodes)&&(this.childNodeList=new p(this.children)),this.childNodeList}}),Object.defineProperty(T.prototype,"firstChild",{get:function(){return this.children[0]||null}}),Object.defineProperty(T.prototype,"lastChild",{get:function(){return this.children[this.children.length-1]||null}}),Object.defineProperty(T.prototype,"previousSibling",{get:function(){var u;return u=this.parent.children.indexOf(this),this.parent.children[u-1]||null}}),Object.defineProperty(T.prototype,"nextSibling",{get:function(){var u;return u=this.parent.children.indexOf(this),this.parent.children[u+1]||null}}),Object.defineProperty(T.prototype,"ownerDocument",{get:function(){return this.document()||null}}),Object.defineProperty(T.prototype,"textContent",{get:function(){var u,h,f,N,W;if(this.nodeType===l.Element||this.nodeType===l.DocumentFragment){for(W="",N=this.children,h=0,f=N.length;h<f;h++)u=N[h],u.textContent&&(W+=u.textContent);return W}else return null},set:function(u){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),T.prototype.setParent=function(u){var h,f,N,W,B;for(this.parent=u,u&&(this.options=u.options,this.stringify=u.stringify),W=this.children,B=[],f=0,N=W.length;f<N;f++)h=W[f],B.push(h.setParent(this));return B},T.prototype.element=function(u,h,f){var N,W,B,s,C,z,J,ce,de,Le,he;if(z=null,h===null&&f==null&&(de=[{},null],h=de[0],f=de[1]),h==null&&(h={}),h=A(h),D(h)||(Le=[h,f],f=Le[0],h=Le[1]),u!=null&&(u=A(u)),Array.isArray(u))for(B=0,J=u.length;B<J;B++)W=u[B],z=this.element(W);else if(L(u))z=this.element(u.apply());else if(D(u)){for(C in u)if(I.call(u,C))if(he=u[C],L(he)&&(he=he.apply()),!this.options.ignoreDecorators&&this.stringify.convertAttKey&&C.indexOf(this.stringify.convertAttKey)===0)z=this.attribute(C.substr(this.stringify.convertAttKey.length),he);else if(!this.options.separateArrayItems&&Array.isArray(he)&&E(he))z=this.dummy();else if(D(he)&&E(he))z=this.element(C);else if(!this.options.keepNullNodes&&he==null)z=this.dummy();else if(!this.options.separateArrayItems&&Array.isArray(he))for(s=0,ce=he.length;s<ce;s++)W=he[s],N={},N[C]=W,z=this.element(N);else D(he)?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&C.indexOf(this.stringify.convertTextKey)===0?z=this.element(he):(z=this.element(C),z.element(he)):z=this.element(C,he)}else!this.options.keepNullNodes&&f===null?z=this.dummy():!this.options.ignoreDecorators&&this.stringify.convertTextKey&&u.indexOf(this.stringify.convertTextKey)===0?z=this.text(f):!this.options.ignoreDecorators&&this.stringify.convertCDataKey&&u.indexOf(this.stringify.convertCDataKey)===0?z=this.cdata(f):!this.options.ignoreDecorators&&this.stringify.convertCommentKey&&u.indexOf(this.stringify.convertCommentKey)===0?z=this.comment(f):!this.options.ignoreDecorators&&this.stringify.convertRawKey&&u.indexOf(this.stringify.convertRawKey)===0?z=this.raw(f):!this.options.ignoreDecorators&&this.stringify.convertPIKey&&u.indexOf(this.stringify.convertPIKey)===0?z=this.instruction(u.substr(this.stringify.convertPIKey.length),f):z=this.node(u,h,f);if(z==null)throw new Error("Could not create any elements with: "+u+". "+this.debugInfo());return z},T.prototype.insertBefore=function(u,h,f){var N,W,B,s,C;if(u?.type)return B=u,s=h,B.setParent(this),s?(W=children.indexOf(s),C=children.splice(W),children.push(B),Array.prototype.push.apply(children,C)):children.push(B),B;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(u));return W=this.parent.children.indexOf(this),C=this.parent.children.splice(W),N=this.parent.element(u,h,f),Array.prototype.push.apply(this.parent.children,C),N},T.prototype.insertAfter=function(u,h,f){var N,W,B;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(u));return W=this.parent.children.indexOf(this),B=this.parent.children.splice(W+1),N=this.parent.element(u,h,f),Array.prototype.push.apply(this.parent.children,B),N},T.prototype.remove=function(){var u;if(this.isRoot)throw new Error("Cannot remove the root element. "+this.debugInfo());return u=this.parent.children.indexOf(this),[].splice.apply(this.parent.children,[u,u-u+1].concat([])),this.parent},T.prototype.node=function(u,h,f){var N,W;return u!=null&&(u=A(u)),h||(h={}),h=A(h),D(h)||(W=[h,f],f=W[0],h=W[1]),N=new t(this,u,h),f!=null&&N.text(f),this.children.push(N),N},T.prototype.text=function(u){var h;return D(u)&&this.element(u),h=new w(this,u),this.children.push(h),this},T.prototype.cdata=function(u){var h;return h=new M(this,u),this.children.push(h),this},T.prototype.comment=function(u){var h;return h=new m(this,u),this.children.push(h),this},T.prototype.commentBefore=function(u){var h,f;return h=this.parent.children.indexOf(this),f=this.parent.children.splice(h),this.parent.comment(u),Array.prototype.push.apply(this.parent.children,f),this},T.prototype.commentAfter=function(u){var h,f;return h=this.parent.children.indexOf(this),f=this.parent.children.splice(h+1),this.parent.comment(u),Array.prototype.push.apply(this.parent.children,f),this},T.prototype.raw=function(u){var h;return h=new b(this,u),this.children.push(h),this},T.prototype.dummy=function(){var u;return u=new i(this),u},T.prototype.instruction=function(u,h){var f,N,W,B,s;if(u!=null&&(u=A(u)),h!=null&&(h=A(h)),Array.isArray(u))for(B=0,s=u.length;B<s;B++)f=u[B],this.instruction(f);else if(D(u))for(f in u)I.call(u,f)&&(N=u[f],this.instruction(f,N));else L(h)&&(h=h.apply()),W=new x(this,u,h),this.children.push(W);return this},T.prototype.instructionBefore=function(u,h){var f,N;return f=this.parent.children.indexOf(this),N=this.parent.children.splice(f),this.parent.instruction(u,h),Array.prototype.push.apply(this.parent.children,N),this},T.prototype.instructionAfter=function(u,h){var f,N;return f=this.parent.children.indexOf(this),N=this.parent.children.splice(f+1),this.parent.instruction(u,h),Array.prototype.push.apply(this.parent.children,N),this},T.prototype.declaration=function(u,h,f){var N,W;return N=this.document(),W=new g(N,u,h,f),N.children.length===0?N.children.unshift(W):N.children[0].type===l.Declaration?N.children[0]=W:N.children.unshift(W),N.root()||N},T.prototype.dtd=function(u,h){var f,N,W,B,s,C,z,J,ce,de;for(N=this.document(),W=new o(N,u,h),ce=N.children,B=s=0,z=ce.length;s<z;B=++s)if(f=ce[B],f.type===l.DocType)return N.children[B]=W,W;for(de=N.children,B=C=0,J=de.length;C<J;B=++C)if(f=de[B],f.isRoot)return N.children.splice(B,0,W),W;return N.children.push(W),W},T.prototype.up=function(){if(this.isRoot)throw new Error("The root node has no parent. Use doc() if you need to get the document object.");return this.parent},T.prototype.root=function(){var u;for(u=this;u;){if(u.type===l.Document)return u.rootObject;if(u.isRoot)return u;u=u.parent}},T.prototype.document=function(){var u;for(u=this;u;){if(u.type===l.Document)return u;u=u.parent}},T.prototype.end=function(u){return this.document().end(u)},T.prototype.prev=function(){var u;if(u=this.parent.children.indexOf(this),u<1)throw new Error("Already at the first node. "+this.debugInfo());return this.parent.children[u-1]},T.prototype.next=function(){var u;if(u=this.parent.children.indexOf(this),u===-1||u===this.parent.children.length-1)throw new Error("Already at the last node. "+this.debugInfo());return this.parent.children[u+1]},T.prototype.importDocument=function(u){var h;return h=u.root().clone(),h.parent=this,h.isRoot=!1,this.children.push(h),this},T.prototype.debugInfo=function(u){var h,f;return u=u||this.name,u==null&&!((h=this.parent)!=null&&h.name)?"":u==null?"parent: <"+this.parent.name+">":(f=this.parent)!=null&&f.name?"node: <"+u+">, parent: <"+this.parent.name+">":"node: <"+u+">"},T.prototype.ele=function(u,h,f){return this.element(u,h,f)},T.prototype.nod=function(u,h,f){return this.node(u,h,f)},T.prototype.txt=function(u){return this.text(u)},T.prototype.dat=function(u){return this.cdata(u)},T.prototype.com=function(u){return this.comment(u)},T.prototype.ins=function(u,h){return this.instruction(u,h)},T.prototype.doc=function(){return this.document()},T.prototype.dec=function(u,h,f){return this.declaration(u,h,f)},T.prototype.e=function(u,h,f){return this.element(u,h,f)},T.prototype.n=function(u,h,f){return this.node(u,h,f)},T.prototype.t=function(u){return this.text(u)},T.prototype.d=function(u){return this.cdata(u)},T.prototype.c=function(u){return this.comment(u)},T.prototype.r=function(u){return this.raw(u)},T.prototype.i=function(u,h){return this.instruction(u,h)},T.prototype.u=function(){return this.up()},T.prototype.importXMLBuilder=function(u){return this.importDocument(u)},T.prototype.replaceChild=function(u,h){throw new Error("This DOM method is not implemented."+this.debugInfo())},T.prototype.removeChild=function(u){throw new Error("This DOM method is not implemented."+this.debugInfo())},T.prototype.appendChild=function(u){throw new Error("This DOM method is not implemented."+this.debugInfo())},T.prototype.hasChildNodes=function(){return this.children.length!==0},T.prototype.cloneNode=function(u){throw new Error("This DOM method is not implemented."+this.debugInfo())},T.prototype.normalize=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},T.prototype.isSupported=function(u,h){return!0},T.prototype.hasAttributes=function(){return this.attribs.length!==0},T.prototype.compareDocumentPosition=function(u){var h,f;return h=this,h===u?0:this.document()!==u.document()?(f=v.Disconnected|v.ImplementationSpecific,Math.random()<.5?f|=v.Preceding:f|=v.Following,f):h.isAncestor(u)?v.Contains|v.Preceding:h.isDescendant(u)?v.Contains|v.Following:h.isPreceding(u)?v.Preceding:v.Following},T.prototype.isSameNode=function(u){throw new Error("This DOM method is not implemented."+this.debugInfo())},T.prototype.lookupPrefix=function(u){throw new Error("This DOM method is not implemented."+this.debugInfo())},T.prototype.isDefaultNamespace=function(u){throw new Error("This DOM method is not implemented."+this.debugInfo())},T.prototype.lookupNamespaceURI=function(u){throw new Error("This DOM method is not implemented."+this.debugInfo())},T.prototype.isEqualNode=function(u){var h,f,N;if(u.nodeType!==this.nodeType||u.children.length!==this.children.length)return!1;for(h=f=0,N=this.children.length-1;0<=N?f<=N:f>=N;h=0<=N?++f:--f)if(!this.children[h].isEqualNode(u.children[h]))return!1;return!0},T.prototype.getFeature=function(u,h){throw new Error("This DOM method is not implemented."+this.debugInfo())},T.prototype.setUserData=function(u,h,f){throw new Error("This DOM method is not implemented."+this.debugInfo())},T.prototype.getUserData=function(u){throw new Error("This DOM method is not implemented."+this.debugInfo())},T.prototype.contains=function(u){return u?u===this||this.isDescendant(u):!1},T.prototype.isDescendant=function(u){var h,f,N,W,B;for(B=this.children,N=0,W=B.length;N<W;N++)if(h=B[N],u===h||(f=h.isDescendant(u),f))return!0;return!1},T.prototype.isAncestor=function(u){return u.isDescendant(this)},T.prototype.isPreceding=function(u){var h,f;return h=this.treePosition(u),f=this.treePosition(this),h===-1||f===-1?!1:h<f},T.prototype.isFollowing=function(u){var h,f;return h=this.treePosition(u),f=this.treePosition(this),h===-1||f===-1?!1:h>f},T.prototype.treePosition=function(u){var h,f;return f=0,h=!1,this.foreachTreeNode(this.document(),function(N){if(f++,!h&&N===u)return h=!0}),h?f:-1},T.prototype.foreachTreeNode=function(u,h){var f,N,W,B,s;for(u||(u=this.document()),B=u.children,N=0,W=B.length;N<W;N++){if(f=B[N],s=h(f))return s;if(s=this.foreachTreeNode(f,h),s)return s}},T})()}).call(Bo)),pn.exports}var On={exports:{}},Ho=On.exports,qi;function gr(){return qi||(qi=1,(function(){var v=function(M,m){return function(){return M.apply(m,arguments)}},l={}.hasOwnProperty;On.exports=(function(){function M(m){this.assertLegalName=v(this.assertLegalName,this),this.assertLegalChar=v(this.assertLegalChar,this);var g,o,i;m||(m={}),this.options=m,this.options.version||(this.options.version="1.0"),o=m.stringify||{};for(g in o)l.call(o,g)&&(i=o[g],this[g]=i)}return M.prototype.name=function(m){return this.options.noValidation?m:this.assertLegalName(""+m||"")},M.prototype.text=function(m){return this.options.noValidation?m:this.assertLegalChar(this.textEscape(""+m||""))},M.prototype.cdata=function(m){return this.options.noValidation?m:(m=""+m||"",m=m.replace("]]>","]]]]><![CDATA[>"),this.assertLegalChar(m))},M.prototype.comment=function(m){if(this.options.noValidation)return m;if(m=""+m||"",m.match(/--/))throw new Error("Comment text cannot contain double-hypen: "+m);return this.assertLegalChar(m)},M.prototype.raw=function(m){return this.options.noValidation?m:""+m||""},M.prototype.attValue=function(m){return this.options.noValidation?m:this.assertLegalChar(this.attEscape(m=""+m||""))},M.prototype.insTarget=function(m){return this.options.noValidation?m:this.assertLegalChar(""+m||"")},M.prototype.insValue=function(m){if(this.options.noValidation)return m;if(m=""+m||"",m.match(/\?>/))throw new Error("Invalid processing instruction value: "+m);return this.assertLegalChar(m)},M.prototype.xmlVersion=function(m){if(this.options.noValidation)return m;if(m=""+m||"",!m.match(/1\.[0-9]+/))throw new Error("Invalid version number: "+m);return m},M.prototype.xmlEncoding=function(m){if(this.options.noValidation)return m;if(m=""+m||"",!m.match(/^[A-Za-z](?:[A-Za-z0-9._-])*$/))throw new Error("Invalid encoding: "+m);return this.assertLegalChar(m)},M.prototype.xmlStandalone=function(m){return this.options.noValidation?m:m?"yes":"no"},M.prototype.dtdPubID=function(m){return this.options.noValidation?m:this.assertLegalChar(""+m||"")},M.prototype.dtdSysID=function(m){return this.options.noValidation?m:this.assertLegalChar(""+m||"")},M.prototype.dtdElementValue=function(m){return this.options.noValidation?m:this.assertLegalChar(""+m||"")},M.prototype.dtdAttType=function(m){return this.options.noValidation?m:this.assertLegalChar(""+m||"")},M.prototype.dtdAttDefault=function(m){return this.options.noValidation?m:this.assertLegalChar(""+m||"")},M.prototype.dtdEntityValue=function(m){return this.options.noValidation?m:this.assertLegalChar(""+m||"")},M.prototype.dtdNData=function(m){return this.options.noValidation?m:this.assertLegalChar(""+m||"")},M.prototype.convertAttKey="@",M.prototype.convertPIKey="?",M.prototype.convertTextKey="#text",M.prototype.convertCDataKey="#cdata",M.prototype.convertCommentKey="#comment",M.prototype.convertRawKey="#raw",M.prototype.assertLegalChar=function(m){var g,o;if(this.options.noValidation)return m;if(g="",this.options.version==="1.0"){if(g=/[\0-\x08\x0B\f\x0E-\x1F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,o=m.match(g))throw new Error("Invalid character in string: "+m+" at index "+o.index)}else if(this.options.version==="1.1"&&(g=/[\0\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,o=m.match(g)))throw new Error("Invalid character in string: "+m+" at index "+o.index);return m},M.prototype.assertLegalName=function(m){var g;if(this.options.noValidation)return m;if(this.assertLegalChar(m),g=/^([:A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])([\x2D\.0-:A-Z_a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*$/,!m.match(g))throw new Error("Invalid character in name");return m},M.prototype.textEscape=function(m){var g;return this.options.noValidation?m:(g=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,m.replace(g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;"))},M.prototype.attEscape=function(m){var g;return this.options.noValidation?m:(g=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,m.replace(g,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"))},M})()}).call(Ho)),On.exports}var In={exports:{}},Dn={exports:{}},Cn={exports:{}},Uo=Cn.exports,ji;function Hn(){return ji||(ji=1,(function(){Cn.exports={None:0,OpenTag:1,InsideTag:2,CloseTag:3}}).call(Uo)),Cn.exports}var ko=Dn.exports,$i;function yr(){return $i||($i=1,(function(){var v,l,M,m={}.hasOwnProperty;M=ct().assign,v=We(),Jn(),ii(),Zn(),Kn(),Yn(),ri(),oi(),si(),mr(),Qn(),ti(),ei(),ni(),l=Hn(),Dn.exports=(function(){function g(o){var i,t,p;o||(o={}),this.options=o,t=o.writer||{};for(i in t)m.call(t,i)&&(p=t[i],this["_"+i]=this[i],this[i]=p)}return g.prototype.filterOptions=function(o){var i,t,p,x,b,w,A,E;return o||(o={}),o=M({},this.options,o),i={writer:this},i.pretty=o.pretty||!1,i.allowEmpty=o.allowEmpty||!1,i.indent=(t=o.indent)!=null?t:"  ",i.newline=(p=o.newline)!=null?p:`
`,i.offset=(x=o.offset)!=null?x:0,i.dontPrettyTextNodes=(b=(w=o.dontPrettyTextNodes)!=null?w:o.dontprettytextnodes)!=null?b:0,i.spaceBeforeSlash=(A=(E=o.spaceBeforeSlash)!=null?E:o.spacebeforeslash)!=null?A:"",i.spaceBeforeSlash===!0&&(i.spaceBeforeSlash=" "),i.suppressPrettyCount=0,i.user={},i.state=l.None,i},g.prototype.indent=function(o,i,t){var p;return!i.pretty||i.suppressPrettyCount?"":i.pretty&&(p=(t||0)+i.offset+1,p>0)?new Array(p).join(i.indent):""},g.prototype.endline=function(o,i,t){return!i.pretty||i.suppressPrettyCount?"":i.newline},g.prototype.attribute=function(o,i,t){var p;return this.openAttribute(o,i,t),p=" "+o.name+'="'+o.value+'"',this.closeAttribute(o,i,t),p},g.prototype.cdata=function(o,i,t){var p;return this.openNode(o,i,t),i.state=l.OpenTag,p=this.indent(o,i,t)+"<![CDATA[",i.state=l.InsideTag,p+=o.value,i.state=l.CloseTag,p+="]]>"+this.endline(o,i,t),i.state=l.None,this.closeNode(o,i,t),p},g.prototype.comment=function(o,i,t){var p;return this.openNode(o,i,t),i.state=l.OpenTag,p=this.indent(o,i,t)+"<!-- ",i.state=l.InsideTag,p+=o.value,i.state=l.CloseTag,p+=" -->"+this.endline(o,i,t),i.state=l.None,this.closeNode(o,i,t),p},g.prototype.declaration=function(o,i,t){var p;return this.openNode(o,i,t),i.state=l.OpenTag,p=this.indent(o,i,t)+"<?xml",i.state=l.InsideTag,p+=' version="'+o.version+'"',o.encoding!=null&&(p+=' encoding="'+o.encoding+'"'),o.standalone!=null&&(p+=' standalone="'+o.standalone+'"'),i.state=l.CloseTag,p+=i.spaceBeforeSlash+"?>",p+=this.endline(o,i,t),i.state=l.None,this.closeNode(o,i,t),p},g.prototype.docType=function(o,i,t){var p,x,b,w,A;if(t||(t=0),this.openNode(o,i,t),i.state=l.OpenTag,w=this.indent(o,i,t),w+="<!DOCTYPE "+o.root().name,o.pubID&&o.sysID?w+=' PUBLIC "'+o.pubID+'" "'+o.sysID+'"':o.sysID&&(w+=' SYSTEM "'+o.sysID+'"'),o.children.length>0){for(w+=" [",w+=this.endline(o,i,t),i.state=l.InsideTag,A=o.children,x=0,b=A.length;x<b;x++)p=A[x],w+=this.writeChildNode(p,i,t+1);i.state=l.CloseTag,w+="]"}return i.state=l.CloseTag,w+=i.spaceBeforeSlash+">",w+=this.endline(o,i,t),i.state=l.None,this.closeNode(o,i,t),w},g.prototype.element=function(o,i,t){var p,x,b,w,A,E,L,D,F,I,T,u,h,f;t||(t=0),I=!1,T="",this.openNode(o,i,t),i.state=l.OpenTag,T+=this.indent(o,i,t)+"<"+o.name,u=o.attribs;for(F in u)m.call(u,F)&&(p=u[F],T+=this.attribute(p,i,t));if(b=o.children.length,w=b===0?null:o.children[0],b===0||o.children.every(function(N){return(N.type===v.Text||N.type===v.Raw)&&N.value===""}))i.allowEmpty?(T+=">",i.state=l.CloseTag,T+="</"+o.name+">"+this.endline(o,i,t)):(i.state=l.CloseTag,T+=i.spaceBeforeSlash+"/>"+this.endline(o,i,t));else if(i.pretty&&b===1&&(w.type===v.Text||w.type===v.Raw)&&w.value!=null)T+=">",i.state=l.InsideTag,i.suppressPrettyCount++,I=!0,T+=this.writeChildNode(w,i,t+1),i.suppressPrettyCount--,I=!1,i.state=l.CloseTag,T+="</"+o.name+">"+this.endline(o,i,t);else{if(i.dontPrettyTextNodes){for(h=o.children,A=0,L=h.length;A<L;A++)if(x=h[A],(x.type===v.Text||x.type===v.Raw)&&x.value!=null){i.suppressPrettyCount++,I=!0;break}}for(T+=">"+this.endline(o,i,t),i.state=l.InsideTag,f=o.children,E=0,D=f.length;E<D;E++)x=f[E],T+=this.writeChildNode(x,i,t+1);i.state=l.CloseTag,T+=this.indent(o,i,t)+"</"+o.name+">",I&&i.suppressPrettyCount--,T+=this.endline(o,i,t),i.state=l.None}return this.closeNode(o,i,t),T},g.prototype.writeChildNode=function(o,i,t){switch(o.type){case v.CData:return this.cdata(o,i,t);case v.Comment:return this.comment(o,i,t);case v.Element:return this.element(o,i,t);case v.Raw:return this.raw(o,i,t);case v.Text:return this.text(o,i,t);case v.ProcessingInstruction:return this.processingInstruction(o,i,t);case v.Dummy:return"";case v.Declaration:return this.declaration(o,i,t);case v.DocType:return this.docType(o,i,t);case v.AttributeDeclaration:return this.dtdAttList(o,i,t);case v.ElementDeclaration:return this.dtdElement(o,i,t);case v.EntityDeclaration:return this.dtdEntity(o,i,t);case v.NotationDeclaration:return this.dtdNotation(o,i,t);default:throw new Error("Unknown XML node type: "+o.constructor.name)}},g.prototype.processingInstruction=function(o,i,t){var p;return this.openNode(o,i,t),i.state=l.OpenTag,p=this.indent(o,i,t)+"<?",i.state=l.InsideTag,p+=o.target,o.value&&(p+=" "+o.value),i.state=l.CloseTag,p+=i.spaceBeforeSlash+"?>",p+=this.endline(o,i,t),i.state=l.None,this.closeNode(o,i,t),p},g.prototype.raw=function(o,i,t){var p;return this.openNode(o,i,t),i.state=l.OpenTag,p=this.indent(o,i,t),i.state=l.InsideTag,p+=o.value,i.state=l.CloseTag,p+=this.endline(o,i,t),i.state=l.None,this.closeNode(o,i,t),p},g.prototype.text=function(o,i,t){var p;return this.openNode(o,i,t),i.state=l.OpenTag,p=this.indent(o,i,t),i.state=l.InsideTag,p+=o.value,i.state=l.CloseTag,p+=this.endline(o,i,t),i.state=l.None,this.closeNode(o,i,t),p},g.prototype.dtdAttList=function(o,i,t){var p;return this.openNode(o,i,t),i.state=l.OpenTag,p=this.indent(o,i,t)+"<!ATTLIST",i.state=l.InsideTag,p+=" "+o.elementName+" "+o.attributeName+" "+o.attributeType,o.defaultValueType!=="#DEFAULT"&&(p+=" "+o.defaultValueType),o.defaultValue&&(p+=' "'+o.defaultValue+'"'),i.state=l.CloseTag,p+=i.spaceBeforeSlash+">"+this.endline(o,i,t),i.state=l.None,this.closeNode(o,i,t),p},g.prototype.dtdElement=function(o,i,t){var p;return this.openNode(o,i,t),i.state=l.OpenTag,p=this.indent(o,i,t)+"<!ELEMENT",i.state=l.InsideTag,p+=" "+o.name+" "+o.value,i.state=l.CloseTag,p+=i.spaceBeforeSlash+">"+this.endline(o,i,t),i.state=l.None,this.closeNode(o,i,t),p},g.prototype.dtdEntity=function(o,i,t){var p;return this.openNode(o,i,t),i.state=l.OpenTag,p=this.indent(o,i,t)+"<!ENTITY",i.state=l.InsideTag,o.pe&&(p+=" %"),p+=" "+o.name,o.value?p+=' "'+o.value+'"':(o.pubID&&o.sysID?p+=' PUBLIC "'+o.pubID+'" "'+o.sysID+'"':o.sysID&&(p+=' SYSTEM "'+o.sysID+'"'),o.nData&&(p+=" NDATA "+o.nData)),i.state=l.CloseTag,p+=i.spaceBeforeSlash+">"+this.endline(o,i,t),i.state=l.None,this.closeNode(o,i,t),p},g.prototype.dtdNotation=function(o,i,t){var p;return this.openNode(o,i,t),i.state=l.OpenTag,p=this.indent(o,i,t)+"<!NOTATION",i.state=l.InsideTag,p+=" "+o.name,o.pubID&&o.sysID?p+=' PUBLIC "'+o.pubID+'" "'+o.sysID+'"':o.pubID?p+=' PUBLIC "'+o.pubID+'"':o.sysID&&(p+=' SYSTEM "'+o.sysID+'"'),i.state=l.CloseTag,p+=i.spaceBeforeSlash+">"+this.endline(o,i,t),i.state=l.None,this.closeNode(o,i,t),p},g.prototype.openNode=function(o,i,t){},g.prototype.closeNode=function(o,i,t){},g.prototype.openAttribute=function(o,i,t){},g.prototype.closeAttribute=function(o,i,t){},g})()}).call(ko)),Dn.exports}var Wo=In.exports,Yi;function ai(){return Yi||(Yi=1,(function(){var v,l=function(m,g){for(var o in g)M.call(g,o)&&(m[o]=g[o]);function i(){this.constructor=m}return i.prototype=g.prototype,m.prototype=new i,m.__super__=g.prototype,m},M={}.hasOwnProperty;v=yr(),In.exports=(function(m){l(g,m);function g(o){g.__super__.constructor.call(this,o)}return g.prototype.document=function(o,i){var t,p,x,b,w;for(i=this.filterOptions(i),b="",w=o.children,p=0,x=w.length;p<x;p++)t=w[p],b+=this.writeChildNode(t,i,0);return i.pretty&&b.slice(-i.newline.length)===i.newline&&(b=b.slice(0,-i.newline.length)),b},g})(v)}).call(Wo)),In.exports}var Xo=an.exports,Zi;function vr(){return Zi||(Zi=1,(function(){var v,l,M,m,g,o,i,t=function(x,b){for(var w in b)p.call(b,w)&&(x[w]=b[w]);function A(){this.constructor=x}return A.prototype=b.prototype,x.prototype=new A,x.__super__=b.prototype,x},p={}.hasOwnProperty;i=ct().isPlainObject,M=fr(),l=mo(),m=nt(),v=We(),o=gr(),g=ai(),an.exports=(function(x){t(b,x);function b(w){b.__super__.constructor.call(this,null),this.name="#document",this.type=v.Document,this.documentURI=null,this.domConfig=new l,w||(w={}),w.writer||(w.writer=new g),this.options=w,this.stringify=new o(w)}return Object.defineProperty(b.prototype,"implementation",{value:new M}),Object.defineProperty(b.prototype,"doctype",{get:function(){var w,A,E,L;for(L=this.children,A=0,E=L.length;A<E;A++)if(w=L[A],w.type===v.DocType)return w;return null}}),Object.defineProperty(b.prototype,"documentElement",{get:function(){return this.rootObject||null}}),Object.defineProperty(b.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(b.prototype,"strictErrorChecking",{get:function(){return!1}}),Object.defineProperty(b.prototype,"xmlEncoding",{get:function(){return this.children.length!==0&&this.children[0].type===v.Declaration?this.children[0].encoding:null}}),Object.defineProperty(b.prototype,"xmlStandalone",{get:function(){return this.children.length!==0&&this.children[0].type===v.Declaration?this.children[0].standalone==="yes":!1}}),Object.defineProperty(b.prototype,"xmlVersion",{get:function(){return this.children.length!==0&&this.children[0].type===v.Declaration?this.children[0].version:"1.0"}}),Object.defineProperty(b.prototype,"URL",{get:function(){return this.documentURI}}),Object.defineProperty(b.prototype,"origin",{get:function(){return null}}),Object.defineProperty(b.prototype,"compatMode",{get:function(){return null}}),Object.defineProperty(b.prototype,"characterSet",{get:function(){return null}}),Object.defineProperty(b.prototype,"contentType",{get:function(){return null}}),b.prototype.end=function(w){var A;return A={},w?i(w)&&(A=w,w=this.options.writer):w=this.options.writer,w.document(this,w.filterOptions(A))},b.prototype.toString=function(w){return this.options.writer.document(this,this.options.writer.filterOptions(w))},b.prototype.createElement=function(w){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.createDocumentFragment=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.createTextNode=function(w){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.createComment=function(w){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.createCDATASection=function(w){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.createProcessingInstruction=function(w,A){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.createAttribute=function(w){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.createEntityReference=function(w){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.getElementsByTagName=function(w){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.importNode=function(w,A){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.createElementNS=function(w,A){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.createAttributeNS=function(w,A){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.getElementsByTagNameNS=function(w,A){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.getElementById=function(w){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.adoptNode=function(w){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.normalizeDocument=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.renameNode=function(w,A,E){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.getElementsByClassName=function(w){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.createEvent=function(w){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.createRange=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.createNodeIterator=function(w,A,E){throw new Error("This DOM method is not implemented."+this.debugInfo())},b.prototype.createTreeWalker=function(w,A,E){throw new Error("This DOM method is not implemented."+this.debugInfo())},b})(m)}).call(Xo)),an.exports}var Fn={exports:{}},Vo=Fn.exports,Ki;function zo(){return Ki||(Ki=1,(function(){var v,l,M,m,g,o,i,t,p,x,b,w,A,E,L,D,F,I,T,u,h,f,N,W={}.hasOwnProperty;N=ct(),h=N.isObject,u=N.isFunction,f=N.isPlainObject,T=N.getValue,v=We(),w=vr(),A=Yn(),m=Zn(),g=Kn(),L=ri(),I=oi(),E=si(),x=Jn(),b=ii(),o=Qn(),t=ei(),i=ti(),p=ni(),M=hr(),F=gr(),D=ai(),l=Hn(),Fn.exports=(function(){function B(s,C,z){var J;this.name="?xml",this.type=v.Document,s||(s={}),J={},s.writer?f(s.writer)&&(J=s.writer,s.writer=new D):s.writer=new D,this.options=s,this.writer=s.writer,this.writerOptions=this.writer.filterOptions(J),this.stringify=new F(s),this.onDataCallback=C||function(){},this.onEndCallback=z||function(){},this.currentNode=null,this.currentLevel=-1,this.openTags={},this.documentStarted=!1,this.documentCompleted=!1,this.root=null}return B.prototype.createChildNode=function(s){var C,z,J,ce,de,Le,he,K;switch(s.type){case v.CData:this.cdata(s.value);break;case v.Comment:this.comment(s.value);break;case v.Element:J={},he=s.attribs;for(z in he)W.call(he,z)&&(C=he[z],J[z]=C.value);this.node(s.name,J);break;case v.Dummy:this.dummy();break;case v.Raw:this.raw(s.value);break;case v.Text:this.text(s.value);break;case v.ProcessingInstruction:this.instruction(s.target,s.value);break;default:throw new Error("This XML node type is not supported in a JS object: "+s.constructor.name)}for(K=s.children,de=0,Le=K.length;de<Le;de++)ce=K[de],this.createChildNode(ce),ce.type===v.Element&&this.up();return this},B.prototype.dummy=function(){return this},B.prototype.node=function(s,C,z){var J;if(s==null)throw new Error("Missing node name.");if(this.root&&this.currentLevel===-1)throw new Error("Document can only have one root node. "+this.debugInfo(s));return this.openCurrent(),s=T(s),C==null&&(C={}),C=T(C),h(C)||(J=[C,z],z=J[0],C=J[1]),this.currentNode=new A(this,s,C),this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,z!=null&&this.text(z),this},B.prototype.element=function(s,C,z){var J,ce,de,Le,he,K;if(this.currentNode&&this.currentNode.type===v.DocType)this.dtdElement.apply(this,arguments);else if(Array.isArray(s)||h(s)||u(s))for(Le=this.options.noValidation,this.options.noValidation=!0,K=new w(this.options).element("TEMP_ROOT"),K.element(s),this.options.noValidation=Le,he=K.children,ce=0,de=he.length;ce<de;ce++)J=he[ce],this.createChildNode(J),J.type===v.Element&&this.up();else this.node(s,C,z);return this},B.prototype.attribute=function(s,C){var z,J;if(!this.currentNode||this.currentNode.children)throw new Error("att() can only be used immediately after an ele() call in callback mode. "+this.debugInfo(s));if(s!=null&&(s=T(s)),h(s))for(z in s)W.call(s,z)&&(J=s[z],this.attribute(z,J));else u(C)&&(C=C.apply()),this.options.keepNullAttributes&&C==null?this.currentNode.attribs[s]=new M(this,s,""):C!=null&&(this.currentNode.attribs[s]=new M(this,s,C));return this},B.prototype.text=function(s){var C;return this.openCurrent(),C=new I(this,s),this.onData(this.writer.text(C,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},B.prototype.cdata=function(s){var C;return this.openCurrent(),C=new m(this,s),this.onData(this.writer.cdata(C,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},B.prototype.comment=function(s){var C;return this.openCurrent(),C=new g(this,s),this.onData(this.writer.comment(C,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},B.prototype.raw=function(s){var C;return this.openCurrent(),C=new L(this,s),this.onData(this.writer.raw(C,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},B.prototype.instruction=function(s,C){var z,J,ce,de,Le;if(this.openCurrent(),s!=null&&(s=T(s)),C!=null&&(C=T(C)),Array.isArray(s))for(z=0,de=s.length;z<de;z++)J=s[z],this.instruction(J);else if(h(s))for(J in s)W.call(s,J)&&(ce=s[J],this.instruction(J,ce));else u(C)&&(C=C.apply()),Le=new E(this,s,C),this.onData(this.writer.processingInstruction(Le,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this},B.prototype.declaration=function(s,C,z){var J;if(this.openCurrent(),this.documentStarted)throw new Error("declaration() must be the first node.");return J=new x(this,s,C,z),this.onData(this.writer.declaration(J,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},B.prototype.doctype=function(s,C,z){if(this.openCurrent(),s==null)throw new Error("Missing root node name.");if(this.root)throw new Error("dtd() must come before the root node.");return this.currentNode=new b(this,C,z),this.currentNode.rootNodeName=s,this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,this},B.prototype.dtdElement=function(s,C){var z;return this.openCurrent(),z=new i(this,s,C),this.onData(this.writer.dtdElement(z,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},B.prototype.attList=function(s,C,z,J,ce){var de;return this.openCurrent(),de=new o(this,s,C,z,J,ce),this.onData(this.writer.dtdAttList(de,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},B.prototype.entity=function(s,C){var z;return this.openCurrent(),z=new t(this,!1,s,C),this.onData(this.writer.dtdEntity(z,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},B.prototype.pEntity=function(s,C){var z;return this.openCurrent(),z=new t(this,!0,s,C),this.onData(this.writer.dtdEntity(z,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},B.prototype.notation=function(s,C){var z;return this.openCurrent(),z=new p(this,s,C),this.onData(this.writer.dtdNotation(z,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},B.prototype.up=function(){if(this.currentLevel<0)throw new Error("The document node has no parent.");return this.currentNode?(this.currentNode.children?this.closeNode(this.currentNode):this.openNode(this.currentNode),this.currentNode=null):this.closeNode(this.openTags[this.currentLevel]),delete this.openTags[this.currentLevel],this.currentLevel--,this},B.prototype.end=function(){for(;this.currentLevel>=0;)this.up();return this.onEnd()},B.prototype.openCurrent=function(){if(this.currentNode)return this.currentNode.children=!0,this.openNode(this.currentNode)},B.prototype.openNode=function(s){var C,z,J,ce;if(!s.isOpen){if(!this.root&&this.currentLevel===0&&s.type===v.Element&&(this.root=s),z="",s.type===v.Element){this.writerOptions.state=l.OpenTag,z=this.writer.indent(s,this.writerOptions,this.currentLevel)+"<"+s.name,ce=s.attribs;for(J in ce)W.call(ce,J)&&(C=ce[J],z+=this.writer.attribute(C,this.writerOptions,this.currentLevel));z+=(s.children?">":"/>")+this.writer.endline(s,this.writerOptions,this.currentLevel),this.writerOptions.state=l.InsideTag}else this.writerOptions.state=l.OpenTag,z=this.writer.indent(s,this.writerOptions,this.currentLevel)+"<!DOCTYPE "+s.rootNodeName,s.pubID&&s.sysID?z+=' PUBLIC "'+s.pubID+'" "'+s.sysID+'"':s.sysID&&(z+=' SYSTEM "'+s.sysID+'"'),s.children?(z+=" [",this.writerOptions.state=l.InsideTag):(this.writerOptions.state=l.CloseTag,z+=">"),z+=this.writer.endline(s,this.writerOptions,this.currentLevel);return this.onData(z,this.currentLevel),s.isOpen=!0}},B.prototype.closeNode=function(s){var C;if(!s.isClosed)return C="",this.writerOptions.state=l.CloseTag,s.type===v.Element?C=this.writer.indent(s,this.writerOptions,this.currentLevel)+"</"+s.name+">"+this.writer.endline(s,this.writerOptions,this.currentLevel):C=this.writer.indent(s,this.writerOptions,this.currentLevel)+"]>"+this.writer.endline(s,this.writerOptions,this.currentLevel),this.writerOptions.state=l.None,this.onData(C,this.currentLevel),s.isClosed=!0},B.prototype.onData=function(s,C){return this.documentStarted=!0,this.onDataCallback(s,C+1)},B.prototype.onEnd=function(){return this.documentCompleted=!0,this.onEndCallback()},B.prototype.debugInfo=function(s){return s==null?"":"node: <"+s+">"},B.prototype.ele=function(){return this.element.apply(this,arguments)},B.prototype.nod=function(s,C,z){return this.node(s,C,z)},B.prototype.txt=function(s){return this.text(s)},B.prototype.dat=function(s){return this.cdata(s)},B.prototype.com=function(s){return this.comment(s)},B.prototype.ins=function(s,C){return this.instruction(s,C)},B.prototype.dec=function(s,C,z){return this.declaration(s,C,z)},B.prototype.dtd=function(s,C,z){return this.doctype(s,C,z)},B.prototype.e=function(s,C,z){return this.element(s,C,z)},B.prototype.n=function(s,C,z){return this.node(s,C,z)},B.prototype.t=function(s){return this.text(s)},B.prototype.d=function(s){return this.cdata(s)},B.prototype.c=function(s){return this.comment(s)},B.prototype.r=function(s){return this.raw(s)},B.prototype.i=function(s,C){return this.instruction(s,C)},B.prototype.att=function(){return this.currentNode&&this.currentNode.type===v.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},B.prototype.a=function(){return this.currentNode&&this.currentNode.type===v.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},B.prototype.ent=function(s,C){return this.entity(s,C)},B.prototype.pent=function(s,C){return this.pEntity(s,C)},B.prototype.not=function(s,C){return this.notation(s,C)},B})()}).call(Vo)),Fn.exports}var Rn={exports:{}},Go=Rn.exports,Ji;function qo(){return Ji||(Ji=1,(function(){var v,l,M,m=function(o,i){for(var t in i)g.call(i,t)&&(o[t]=i[t]);function p(){this.constructor=o}return p.prototype=i.prototype,o.prototype=new p,o.__super__=i.prototype,o},g={}.hasOwnProperty;v=We(),M=yr(),l=Hn(),Rn.exports=(function(o){m(i,o);function i(t,p){this.stream=t,i.__super__.constructor.call(this,p)}return i.prototype.endline=function(t,p,x){return t.isLastRootNode&&p.state===l.CloseTag?"":i.__super__.endline.call(this,t,p,x)},i.prototype.document=function(t,p){var x,b,w,A,E,L,D,F,I;for(D=t.children,b=w=0,E=D.length;w<E;b=++w)x=D[b],x.isLastRootNode=b===t.children.length-1;for(p=this.filterOptions(p),F=t.children,I=[],A=0,L=F.length;A<L;A++)x=F[A],I.push(this.writeChildNode(x,p,0));return I},i.prototype.attribute=function(t,p,x){return this.stream.write(i.__super__.attribute.call(this,t,p,x))},i.prototype.cdata=function(t,p,x){return this.stream.write(i.__super__.cdata.call(this,t,p,x))},i.prototype.comment=function(t,p,x){return this.stream.write(i.__super__.comment.call(this,t,p,x))},i.prototype.declaration=function(t,p,x){return this.stream.write(i.__super__.declaration.call(this,t,p,x))},i.prototype.docType=function(t,p,x){var b,w,A,E;if(x||(x=0),this.openNode(t,p,x),p.state=l.OpenTag,this.stream.write(this.indent(t,p,x)),this.stream.write("<!DOCTYPE "+t.root().name),t.pubID&&t.sysID?this.stream.write(' PUBLIC "'+t.pubID+'" "'+t.sysID+'"'):t.sysID&&this.stream.write(' SYSTEM "'+t.sysID+'"'),t.children.length>0){for(this.stream.write(" ["),this.stream.write(this.endline(t,p,x)),p.state=l.InsideTag,E=t.children,w=0,A=E.length;w<A;w++)b=E[w],this.writeChildNode(b,p,x+1);p.state=l.CloseTag,this.stream.write("]")}return p.state=l.CloseTag,this.stream.write(p.spaceBeforeSlash+">"),this.stream.write(this.endline(t,p,x)),p.state=l.None,this.closeNode(t,p,x)},i.prototype.element=function(t,p,x){var b,w,A,E,L,D,F,I,T;x||(x=0),this.openNode(t,p,x),p.state=l.OpenTag,this.stream.write(this.indent(t,p,x)+"<"+t.name),I=t.attribs;for(F in I)g.call(I,F)&&(b=I[F],this.attribute(b,p,x));if(A=t.children.length,E=A===0?null:t.children[0],A===0||t.children.every(function(u){return(u.type===v.Text||u.type===v.Raw)&&u.value===""}))p.allowEmpty?(this.stream.write(">"),p.state=l.CloseTag,this.stream.write("</"+t.name+">")):(p.state=l.CloseTag,this.stream.write(p.spaceBeforeSlash+"/>"));else if(p.pretty&&A===1&&(E.type===v.Text||E.type===v.Raw)&&E.value!=null)this.stream.write(">"),p.state=l.InsideTag,p.suppressPrettyCount++,this.writeChildNode(E,p,x+1),p.suppressPrettyCount--,p.state=l.CloseTag,this.stream.write("</"+t.name+">");else{for(this.stream.write(">"+this.endline(t,p,x)),p.state=l.InsideTag,T=t.children,L=0,D=T.length;L<D;L++)w=T[L],this.writeChildNode(w,p,x+1);p.state=l.CloseTag,this.stream.write(this.indent(t,p,x)+"</"+t.name+">")}return this.stream.write(this.endline(t,p,x)),p.state=l.None,this.closeNode(t,p,x)},i.prototype.processingInstruction=function(t,p,x){return this.stream.write(i.__super__.processingInstruction.call(this,t,p,x))},i.prototype.raw=function(t,p,x){return this.stream.write(i.__super__.raw.call(this,t,p,x))},i.prototype.text=function(t,p,x){return this.stream.write(i.__super__.text.call(this,t,p,x))},i.prototype.dtdAttList=function(t,p,x){return this.stream.write(i.__super__.dtdAttList.call(this,t,p,x))},i.prototype.dtdElement=function(t,p,x){return this.stream.write(i.__super__.dtdElement.call(this,t,p,x))},i.prototype.dtdEntity=function(t,p,x){return this.stream.write(i.__super__.dtdEntity.call(this,t,p,x))},i.prototype.dtdNotation=function(t,p,x){return this.stream.write(i.__super__.dtdNotation.call(this,t,p,x))},i})(M)}).call(Go)),Rn.exports}var Qi;function jo(){return Qi||(Qi=1,(function(){var v,l,M,m,g,o,i,t,p,x;x=ct(),t=x.assign,p=x.isFunction,M=fr(),m=vr(),g=zo(),i=ai(),o=qo(),v=We(),l=Hn(),at.create=function(b,w,A,E){var L,D;if(b==null)throw new Error("Root element needs a name.");return E=t({},w,A,E),L=new m(E),D=L.element(b),E.headless||(L.declaration(E),(E.pubID!=null||E.sysID!=null)&&L.dtd(E)),D},at.begin=function(b,w,A){var E;return p(b)&&(E=[b,w],w=E[0],A=E[1],b={}),w?new g(b,w,A):new m(b)},at.stringWriter=function(b){return new i(b)},at.streamWriter=function(b,w){return new o(b,w)},at.implementation=new M,at.nodeType=v,at.writerState=l}).call(at)),at}var er;function $o(){return er||(er=1,(function(){var v,l,M,m,g,o={}.hasOwnProperty;v=jo(),l=jn().defaults,m=function(i){return typeof i=="string"&&(i.indexOf("&")>=0||i.indexOf(">")>=0||i.indexOf("<")>=0)},g=function(i){return"<![CDATA["+M(i)+"]]>"},M=function(i){return i.replace("]]>","]]]]><![CDATA[>")},en.Builder=(function(){function i(t){var p,x,b;this.options={},x=l["0.2"];for(p in x)o.call(x,p)&&(b=x[p],this.options[p]=b);for(p in t)o.call(t,p)&&(b=t[p],this.options[p]=b)}return i.prototype.buildObject=function(t){var p,x,b,w,A;return p=this.options.attrkey,x=this.options.charkey,Object.keys(t).length===1&&this.options.rootName===l["0.2"].rootName?(A=Object.keys(t)[0],t=t[A]):A=this.options.rootName,b=(function(E){return function(L,D){var F,I,T,u,h,f;if(typeof D!="object")E.options.cdata&&m(D)?L.raw(g(D)):L.txt(D);else if(Array.isArray(D)){for(u in D)if(o.call(D,u)){I=D[u];for(h in I)T=I[h],L=b(L.ele(h),T).up()}}else for(h in D)if(o.call(D,h))if(I=D[h],h===p){if(typeof I=="object")for(F in I)f=I[F],L=L.att(F,f)}else if(h===x)E.options.cdata&&m(I)?L=L.raw(g(I)):L=L.txt(I);else if(Array.isArray(I))for(u in I)o.call(I,u)&&(T=I[u],typeof T=="string"?E.options.cdata&&m(T)?L=L.ele(h).raw(g(T)).up():L=L.ele(h,T).up():L=b(L.ele(h),T).up());else typeof I=="object"?L=b(L.ele(h),I).up():typeof I=="string"&&E.options.cdata&&m(I)?L=L.ele(h).raw(g(I)).up():(I==null&&(I=""),L=L.ele(h,I.toString()).up());return L}})(this),w=v.create(A,this.options.xmldec,this.options.doctype,{headless:this.options.headless,allowSurrogateChars:this.options.allowSurrogateChars}),b(w,t).end(this.options.renderOpts)},i})()}).call(en)),en}var tn={},zn={};const Yo=new Proxy({},{get(v,l){throw new Error(`Module "stream" has been externalized for browser compatibility. Cannot access "stream.${l}" in client code.  See https://vite.dev/guide/troubleshooting.html#module-externalized-for-browser-compatibility for more details.`)}}),Zo=Object.freeze(Object.defineProperty({__proto__:null,default:Yo},Symbol.toStringTag,{value:"Module"})),Ko=dr(Zo);var Gn={},qn={},Ut={},tr;function Jo(){if(tr)return Ut;tr=1,Ut.byteLength=t,Ut.toByteArray=x,Ut.fromByteArray=A;for(var v=[],l=[],M=typeof Uint8Array<"u"?Uint8Array:Array,m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",g=0,o=m.length;g<o;++g)v[g]=m[g],l[m.charCodeAt(g)]=g;l[45]=62,l[95]=63;function i(E){var L=E.length;if(L%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var D=E.indexOf("=");D===-1&&(D=L);var F=D===L?0:4-D%4;return[D,F]}function t(E){var L=i(E),D=L[0],F=L[1];return(D+F)*3/4-F}function p(E,L,D){return(L+D)*3/4-D}function x(E){var L,D=i(E),F=D[0],I=D[1],T=new M(p(E,F,I)),u=0,h=I>0?F-4:F,f;for(f=0;f<h;f+=4)L=l[E.charCodeAt(f)]<<18|l[E.charCodeAt(f+1)]<<12|l[E.charCodeAt(f+2)]<<6|l[E.charCodeAt(f+3)],T[u++]=L>>16&255,T[u++]=L>>8&255,T[u++]=L&255;return I===2&&(L=l[E.charCodeAt(f)]<<2|l[E.charCodeAt(f+1)]>>4,T[u++]=L&255),I===1&&(L=l[E.charCodeAt(f)]<<10|l[E.charCodeAt(f+1)]<<4|l[E.charCodeAt(f+2)]>>2,T[u++]=L>>8&255,T[u++]=L&255),T}function b(E){return v[E>>18&63]+v[E>>12&63]+v[E>>6&63]+v[E&63]}function w(E,L,D){for(var F,I=[],T=L;T<D;T+=3)F=(E[T]<<16&16711680)+(E[T+1]<<8&65280)+(E[T+2]&255),I.push(b(F));return I.join("")}function A(E){for(var L,D=E.length,F=D%3,I=[],T=16383,u=0,h=D-F;u<h;u+=T)I.push(w(E,u,u+T>h?h:u+T));return F===1?(L=E[D-1],I.push(v[L>>2]+v[L<<4&63]+"==")):F===2&&(L=(E[D-2]<<8)+E[D-1],I.push(v[L>>10]+v[L>>4&63]+v[L<<2&63]+"=")),I.join("")}return Ut}var nn={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var nr;function Qo(){return nr||(nr=1,nn.read=function(v,l,M,m,g){var o,i,t=g*8-m-1,p=(1<<t)-1,x=p>>1,b=-7,w=M?g-1:0,A=M?-1:1,E=v[l+w];for(w+=A,o=E&(1<<-b)-1,E>>=-b,b+=t;b>0;o=o*256+v[l+w],w+=A,b-=8);for(i=o&(1<<-b)-1,o>>=-b,b+=m;b>0;i=i*256+v[l+w],w+=A,b-=8);if(o===0)o=1-x;else{if(o===p)return i?NaN:(E?-1:1)*(1/0);i=i+Math.pow(2,m),o=o-x}return(E?-1:1)*i*Math.pow(2,o-m)},nn.write=function(v,l,M,m,g,o){var i,t,p,x=o*8-g-1,b=(1<<x)-1,w=b>>1,A=g===23?Math.pow(2,-24)-Math.pow(2,-77):0,E=m?0:o-1,L=m?1:-1,D=l<0||l===0&&1/l<0?1:0;for(l=Math.abs(l),isNaN(l)||l===1/0?(t=isNaN(l)?1:0,i=b):(i=Math.floor(Math.log(l)/Math.LN2),l*(p=Math.pow(2,-i))<1&&(i--,p*=2),i+w>=1?l+=A/p:l+=A*Math.pow(2,1-w),l*p>=2&&(i++,p/=2),i+w>=b?(t=0,i=b):i+w>=1?(t=(l*p-1)*Math.pow(2,g),i=i+w):(t=l*Math.pow(2,w-1)*Math.pow(2,g),i=0));g>=8;v[M+E]=t&255,E+=L,t/=256,g-=8);for(i=i<<g|t,x+=g;x>0;v[M+E]=i&255,E+=L,i/=256,x-=8);v[M+E-L]|=D*128}),nn}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var ir;function es(){return ir||(ir=1,(function(v){var l=Jo(),M=Qo(),m=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;v.Buffer=t,v.SlowBuffer=T,v.INSPECT_MAX_BYTES=50;var g=2147483647;v.kMaxLength=g,t.TYPED_ARRAY_SUPPORT=o(),!t.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function o(){try{var d=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(d,e),d.foo()===42}catch{return!1}}Object.defineProperty(t.prototype,"parent",{enumerable:!0,get:function(){if(t.isBuffer(this))return this.buffer}}),Object.defineProperty(t.prototype,"offset",{enumerable:!0,get:function(){if(t.isBuffer(this))return this.byteOffset}});function i(d){if(d>g)throw new RangeError('The value "'+d+'" is invalid for option "size"');var e=new Uint8Array(d);return Object.setPrototypeOf(e,t.prototype),e}function t(d,e,n){if(typeof d=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return w(d)}return p(d,e,n)}t.poolSize=8192;function p(d,e,n){if(typeof d=="string")return A(d,e);if(ArrayBuffer.isView(d))return L(d);if(d==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof d);if(be(d,ArrayBuffer)||d&&be(d.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(be(d,SharedArrayBuffer)||d&&be(d.buffer,SharedArrayBuffer)))return D(d,e,n);if(typeof d=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var y=d.valueOf&&d.valueOf();if(y!=null&&y!==d)return t.from(y,e,n);var O=F(d);if(O)return O;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof d[Symbol.toPrimitive]=="function")return t.from(d[Symbol.toPrimitive]("string"),e,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof d)}t.from=function(d,e,n){return p(d,e,n)},Object.setPrototypeOf(t.prototype,Uint8Array.prototype),Object.setPrototypeOf(t,Uint8Array);function x(d){if(typeof d!="number")throw new TypeError('"size" argument must be of type number');if(d<0)throw new RangeError('The value "'+d+'" is invalid for option "size"')}function b(d,e,n){return x(d),d<=0?i(d):e!==void 0?typeof n=="string"?i(d).fill(e,n):i(d).fill(e):i(d)}t.alloc=function(d,e,n){return b(d,e,n)};function w(d){return x(d),i(d<0?0:I(d)|0)}t.allocUnsafe=function(d){return w(d)},t.allocUnsafeSlow=function(d){return w(d)};function A(d,e){if((typeof e!="string"||e==="")&&(e="utf8"),!t.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var n=u(d,e)|0,y=i(n),O=y.write(d,e);return O!==n&&(y=y.slice(0,O)),y}function E(d){for(var e=d.length<0?0:I(d.length)|0,n=i(e),y=0;y<e;y+=1)n[y]=d[y]&255;return n}function L(d){if(be(d,Uint8Array)){var e=new Uint8Array(d);return D(e.buffer,e.byteOffset,e.byteLength)}return E(d)}function D(d,e,n){if(e<0||d.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(d.byteLength<e+(n||0))throw new RangeError('"length" is outside of buffer bounds');var y;return e===void 0&&n===void 0?y=new Uint8Array(d):n===void 0?y=new Uint8Array(d,e):y=new Uint8Array(d,e,n),Object.setPrototypeOf(y,t.prototype),y}function F(d){if(t.isBuffer(d)){var e=I(d.length)|0,n=i(e);return n.length===0||d.copy(n,0,0,e),n}if(d.length!==void 0)return typeof d.length!="number"||Be(d.length)?i(0):E(d);if(d.type==="Buffer"&&Array.isArray(d.data))return E(d.data)}function I(d){if(d>=g)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+g.toString(16)+" bytes");return d|0}function T(d){return+d!=d&&(d=0),t.alloc(+d)}t.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==t.prototype},t.compare=function(e,n){if(be(e,Uint8Array)&&(e=t.from(e,e.offset,e.byteLength)),be(n,Uint8Array)&&(n=t.from(n,n.offset,n.byteLength)),!t.isBuffer(e)||!t.isBuffer(n))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===n)return 0;for(var y=e.length,O=n.length,G=0,j=Math.min(y,O);G<j;++G)if(e[G]!==n[G]){y=e[G],O=n[G];break}return y<O?-1:O<y?1:0},t.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},t.concat=function(e,n){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return t.alloc(0);var y;if(n===void 0)for(n=0,y=0;y<e.length;++y)n+=e[y].length;var O=t.allocUnsafe(n),G=0;for(y=0;y<e.length;++y){var j=e[y];if(be(j,Uint8Array))G+j.length>O.length?t.from(j).copy(O,G):Uint8Array.prototype.set.call(O,j,G);else if(t.isBuffer(j))j.copy(O,G);else throw new TypeError('"list" argument must be an Array of Buffers');G+=j.length}return O};function u(d,e){if(t.isBuffer(d))return d.length;if(ArrayBuffer.isView(d)||be(d,ArrayBuffer))return d.byteLength;if(typeof d!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof d);var n=d.length,y=arguments.length>2&&arguments[2]===!0;if(!y&&n===0)return 0;for(var O=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return a(d).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return n*2;case"hex":return n>>>1;case"base64":return ge(d).length;default:if(O)return y?-1:a(d).length;e=(""+e).toLowerCase(),O=!0}}t.byteLength=u;function h(d,e,n){var y=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((n===void 0||n>this.length)&&(n=this.length),n<=0)||(n>>>=0,e>>>=0,n<=e))return"";for(d||(d="utf8");;)switch(d){case"hex":return Te(this,e,n);case"utf8":case"utf-8":return de(this,e,n);case"ascii":return K(this,e,n);case"latin1":case"binary":return V(this,e,n);case"base64":return ce(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return re(this,e,n);default:if(y)throw new TypeError("Unknown encoding: "+d);d=(d+"").toLowerCase(),y=!0}}t.prototype._isBuffer=!0;function f(d,e,n){var y=d[e];d[e]=d[n],d[n]=y}t.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var n=0;n<e;n+=2)f(this,n,n+1);return this},t.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var n=0;n<e;n+=4)f(this,n,n+3),f(this,n+1,n+2);return this},t.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var n=0;n<e;n+=8)f(this,n,n+7),f(this,n+1,n+6),f(this,n+2,n+5),f(this,n+3,n+4);return this},t.prototype.toString=function(){var e=this.length;return e===0?"":arguments.length===0?de(this,0,e):h.apply(this,arguments)},t.prototype.toLocaleString=t.prototype.toString,t.prototype.equals=function(e){if(!t.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:t.compare(this,e)===0},t.prototype.inspect=function(){var e="",n=v.INSPECT_MAX_BYTES;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},m&&(t.prototype[m]=t.prototype.inspect),t.prototype.compare=function(e,n,y,O,G){if(be(e,Uint8Array)&&(e=t.from(e,e.offset,e.byteLength)),!t.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(n===void 0&&(n=0),y===void 0&&(y=e?e.length:0),O===void 0&&(O=0),G===void 0&&(G=this.length),n<0||y>e.length||O<0||G>this.length)throw new RangeError("out of range index");if(O>=G&&n>=y)return 0;if(O>=G)return-1;if(n>=y)return 1;if(n>>>=0,y>>>=0,O>>>=0,G>>>=0,this===e)return 0;for(var j=G-O,ve=y-n,Me=Math.min(j,ve),Pe=this.slice(O,G),Xe=e.slice(n,y),Ie=0;Ie<Me;++Ie)if(Pe[Ie]!==Xe[Ie]){j=Pe[Ie],ve=Xe[Ie];break}return j<ve?-1:ve<j?1:0};function N(d,e,n,y,O){if(d.length===0)return-1;if(typeof n=="string"?(y=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,Be(n)&&(n=O?0:d.length-1),n<0&&(n=d.length+n),n>=d.length){if(O)return-1;n=d.length-1}else if(n<0)if(O)n=0;else return-1;if(typeof e=="string"&&(e=t.from(e,y)),t.isBuffer(e))return e.length===0?-1:W(d,e,n,y,O);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?O?Uint8Array.prototype.indexOf.call(d,e,n):Uint8Array.prototype.lastIndexOf.call(d,e,n):W(d,[e],n,y,O);throw new TypeError("val must be string, number or Buffer")}function W(d,e,n,y,O){var G=1,j=d.length,ve=e.length;if(y!==void 0&&(y=String(y).toLowerCase(),y==="ucs2"||y==="ucs-2"||y==="utf16le"||y==="utf-16le")){if(d.length<2||e.length<2)return-1;G=2,j/=2,ve/=2,n/=2}function Me(_t,Wt){return G===1?_t[Wt]:_t.readUInt16BE(Wt*G)}var Pe;if(O){var Xe=-1;for(Pe=n;Pe<j;Pe++)if(Me(d,Pe)===Me(e,Xe===-1?0:Pe-Xe)){if(Xe===-1&&(Xe=Pe),Pe-Xe+1===ve)return Xe*G}else Xe!==-1&&(Pe-=Pe-Xe),Xe=-1}else for(n+ve>j&&(n=j-ve),Pe=n;Pe>=0;Pe--){for(var Ie=!0,bt=0;bt<ve;bt++)if(Me(d,Pe+bt)!==Me(e,bt)){Ie=!1;break}if(Ie)return Pe}return-1}t.prototype.includes=function(e,n,y){return this.indexOf(e,n,y)!==-1},t.prototype.indexOf=function(e,n,y){return N(this,e,n,y,!0)},t.prototype.lastIndexOf=function(e,n,y){return N(this,e,n,y,!1)};function B(d,e,n,y){n=Number(n)||0;var O=d.length-n;y?(y=Number(y),y>O&&(y=O)):y=O;var G=e.length;y>G/2&&(y=G/2);for(var j=0;j<y;++j){var ve=parseInt(e.substr(j*2,2),16);if(Be(ve))return j;d[n+j]=ve}return j}function s(d,e,n,y){return Se(a(e,d.length-n),d,n,y)}function C(d,e,n,y){return Se(U(e),d,n,y)}function z(d,e,n,y){return Se(ge(e),d,n,y)}function J(d,e,n,y){return Se(P(e,d.length-n),d,n,y)}t.prototype.write=function(e,n,y,O){if(n===void 0)O="utf8",y=this.length,n=0;else if(y===void 0&&typeof n=="string")O=n,y=this.length,n=0;else if(isFinite(n))n=n>>>0,isFinite(y)?(y=y>>>0,O===void 0&&(O="utf8")):(O=y,y=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var G=this.length-n;if((y===void 0||y>G)&&(y=G),e.length>0&&(y<0||n<0)||n>this.length)throw new RangeError("Attempt to write outside buffer bounds");O||(O="utf8");for(var j=!1;;)switch(O){case"hex":return B(this,e,n,y);case"utf8":case"utf-8":return s(this,e,n,y);case"ascii":case"latin1":case"binary":return C(this,e,n,y);case"base64":return z(this,e,n,y);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return J(this,e,n,y);default:if(j)throw new TypeError("Unknown encoding: "+O);O=(""+O).toLowerCase(),j=!0}},t.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function ce(d,e,n){return e===0&&n===d.length?l.fromByteArray(d):l.fromByteArray(d.slice(e,n))}function de(d,e,n){n=Math.min(d.length,n);for(var y=[],O=e;O<n;){var G=d[O],j=null,ve=G>239?4:G>223?3:G>191?2:1;if(O+ve<=n){var Me,Pe,Xe,Ie;switch(ve){case 1:G<128&&(j=G);break;case 2:Me=d[O+1],(Me&192)===128&&(Ie=(G&31)<<6|Me&63,Ie>127&&(j=Ie));break;case 3:Me=d[O+1],Pe=d[O+2],(Me&192)===128&&(Pe&192)===128&&(Ie=(G&15)<<12|(Me&63)<<6|Pe&63,Ie>2047&&(Ie<55296||Ie>57343)&&(j=Ie));break;case 4:Me=d[O+1],Pe=d[O+2],Xe=d[O+3],(Me&192)===128&&(Pe&192)===128&&(Xe&192)===128&&(Ie=(G&15)<<18|(Me&63)<<12|(Pe&63)<<6|Xe&63,Ie>65535&&Ie<1114112&&(j=Ie))}}j===null?(j=65533,ve=1):j>65535&&(j-=65536,y.push(j>>>10&1023|55296),j=56320|j&1023),y.push(j),O+=ve}return he(y)}var Le=4096;function he(d){var e=d.length;if(e<=Le)return String.fromCharCode.apply(String,d);for(var n="",y=0;y<e;)n+=String.fromCharCode.apply(String,d.slice(y,y+=Le));return n}function K(d,e,n){var y="";n=Math.min(d.length,n);for(var O=e;O<n;++O)y+=String.fromCharCode(d[O]&127);return y}function V(d,e,n){var y="";n=Math.min(d.length,n);for(var O=e;O<n;++O)y+=String.fromCharCode(d[O]);return y}function Te(d,e,n){var y=d.length;(!e||e<0)&&(e=0),(!n||n<0||n>y)&&(n=y);for(var O="",G=e;G<n;++G)O+=ze[d[G]];return O}function re(d,e,n){for(var y=d.slice(e,n),O="",G=0;G<y.length-1;G+=2)O+=String.fromCharCode(y[G]+y[G+1]*256);return O}t.prototype.slice=function(e,n){var y=this.length;e=~~e,n=n===void 0?y:~~n,e<0?(e+=y,e<0&&(e=0)):e>y&&(e=y),n<0?(n+=y,n<0&&(n=0)):n>y&&(n=y),n<e&&(n=e);var O=this.subarray(e,n);return Object.setPrototypeOf(O,t.prototype),O};function me(d,e,n){if(d%1!==0||d<0)throw new RangeError("offset is not uint");if(d+e>n)throw new RangeError("Trying to access beyond buffer length")}t.prototype.readUintLE=t.prototype.readUIntLE=function(e,n,y){e=e>>>0,n=n>>>0,y||me(e,n,this.length);for(var O=this[e],G=1,j=0;++j<n&&(G*=256);)O+=this[e+j]*G;return O},t.prototype.readUintBE=t.prototype.readUIntBE=function(e,n,y){e=e>>>0,n=n>>>0,y||me(e,n,this.length);for(var O=this[e+--n],G=1;n>0&&(G*=256);)O+=this[e+--n]*G;return O},t.prototype.readUint8=t.prototype.readUInt8=function(e,n){return e=e>>>0,n||me(e,1,this.length),this[e]},t.prototype.readUint16LE=t.prototype.readUInt16LE=function(e,n){return e=e>>>0,n||me(e,2,this.length),this[e]|this[e+1]<<8},t.prototype.readUint16BE=t.prototype.readUInt16BE=function(e,n){return e=e>>>0,n||me(e,2,this.length),this[e]<<8|this[e+1]},t.prototype.readUint32LE=t.prototype.readUInt32LE=function(e,n){return e=e>>>0,n||me(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216},t.prototype.readUint32BE=t.prototype.readUInt32BE=function(e,n){return e=e>>>0,n||me(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])},t.prototype.readIntLE=function(e,n,y){e=e>>>0,n=n>>>0,y||me(e,n,this.length);for(var O=this[e],G=1,j=0;++j<n&&(G*=256);)O+=this[e+j]*G;return G*=128,O>=G&&(O-=Math.pow(2,8*n)),O},t.prototype.readIntBE=function(e,n,y){e=e>>>0,n=n>>>0,y||me(e,n,this.length);for(var O=n,G=1,j=this[e+--O];O>0&&(G*=256);)j+=this[e+--O]*G;return G*=128,j>=G&&(j-=Math.pow(2,8*n)),j},t.prototype.readInt8=function(e,n){return e=e>>>0,n||me(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]},t.prototype.readInt16LE=function(e,n){e=e>>>0,n||me(e,2,this.length);var y=this[e]|this[e+1]<<8;return y&32768?y|4294901760:y},t.prototype.readInt16BE=function(e,n){e=e>>>0,n||me(e,2,this.length);var y=this[e+1]|this[e]<<8;return y&32768?y|4294901760:y},t.prototype.readInt32LE=function(e,n){return e=e>>>0,n||me(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},t.prototype.readInt32BE=function(e,n){return e=e>>>0,n||me(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},t.prototype.readFloatLE=function(e,n){return e=e>>>0,n||me(e,4,this.length),M.read(this,e,!0,23,4)},t.prototype.readFloatBE=function(e,n){return e=e>>>0,n||me(e,4,this.length),M.read(this,e,!1,23,4)},t.prototype.readDoubleLE=function(e,n){return e=e>>>0,n||me(e,8,this.length),M.read(this,e,!0,52,8)},t.prototype.readDoubleBE=function(e,n){return e=e>>>0,n||me(e,8,this.length),M.read(this,e,!1,52,8)};function Y(d,e,n,y,O,G){if(!t.isBuffer(d))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>O||e<G)throw new RangeError('"value" argument is out of bounds');if(n+y>d.length)throw new RangeError("Index out of range")}t.prototype.writeUintLE=t.prototype.writeUIntLE=function(e,n,y,O){if(e=+e,n=n>>>0,y=y>>>0,!O){var G=Math.pow(2,8*y)-1;Y(this,e,n,y,G,0)}var j=1,ve=0;for(this[n]=e&255;++ve<y&&(j*=256);)this[n+ve]=e/j&255;return n+y},t.prototype.writeUintBE=t.prototype.writeUIntBE=function(e,n,y,O){if(e=+e,n=n>>>0,y=y>>>0,!O){var G=Math.pow(2,8*y)-1;Y(this,e,n,y,G,0)}var j=y-1,ve=1;for(this[n+j]=e&255;--j>=0&&(ve*=256);)this[n+j]=e/ve&255;return n+y},t.prototype.writeUint8=t.prototype.writeUInt8=function(e,n,y){return e=+e,n=n>>>0,y||Y(this,e,n,1,255,0),this[n]=e&255,n+1},t.prototype.writeUint16LE=t.prototype.writeUInt16LE=function(e,n,y){return e=+e,n=n>>>0,y||Y(this,e,n,2,65535,0),this[n]=e&255,this[n+1]=e>>>8,n+2},t.prototype.writeUint16BE=t.prototype.writeUInt16BE=function(e,n,y){return e=+e,n=n>>>0,y||Y(this,e,n,2,65535,0),this[n]=e>>>8,this[n+1]=e&255,n+2},t.prototype.writeUint32LE=t.prototype.writeUInt32LE=function(e,n,y){return e=+e,n=n>>>0,y||Y(this,e,n,4,4294967295,0),this[n+3]=e>>>24,this[n+2]=e>>>16,this[n+1]=e>>>8,this[n]=e&255,n+4},t.prototype.writeUint32BE=t.prototype.writeUInt32BE=function(e,n,y){return e=+e,n=n>>>0,y||Y(this,e,n,4,4294967295,0),this[n]=e>>>24,this[n+1]=e>>>16,this[n+2]=e>>>8,this[n+3]=e&255,n+4},t.prototype.writeIntLE=function(e,n,y,O){if(e=+e,n=n>>>0,!O){var G=Math.pow(2,8*y-1);Y(this,e,n,y,G-1,-G)}var j=0,ve=1,Me=0;for(this[n]=e&255;++j<y&&(ve*=256);)e<0&&Me===0&&this[n+j-1]!==0&&(Me=1),this[n+j]=(e/ve>>0)-Me&255;return n+y},t.prototype.writeIntBE=function(e,n,y,O){if(e=+e,n=n>>>0,!O){var G=Math.pow(2,8*y-1);Y(this,e,n,y,G-1,-G)}var j=y-1,ve=1,Me=0;for(this[n+j]=e&255;--j>=0&&(ve*=256);)e<0&&Me===0&&this[n+j+1]!==0&&(Me=1),this[n+j]=(e/ve>>0)-Me&255;return n+y},t.prototype.writeInt8=function(e,n,y){return e=+e,n=n>>>0,y||Y(this,e,n,1,127,-128),e<0&&(e=255+e+1),this[n]=e&255,n+1},t.prototype.writeInt16LE=function(e,n,y){return e=+e,n=n>>>0,y||Y(this,e,n,2,32767,-32768),this[n]=e&255,this[n+1]=e>>>8,n+2},t.prototype.writeInt16BE=function(e,n,y){return e=+e,n=n>>>0,y||Y(this,e,n,2,32767,-32768),this[n]=e>>>8,this[n+1]=e&255,n+2},t.prototype.writeInt32LE=function(e,n,y){return e=+e,n=n>>>0,y||Y(this,e,n,4,2147483647,-2147483648),this[n]=e&255,this[n+1]=e>>>8,this[n+2]=e>>>16,this[n+3]=e>>>24,n+4},t.prototype.writeInt32BE=function(e,n,y){return e=+e,n=n>>>0,y||Y(this,e,n,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[n]=e>>>24,this[n+1]=e>>>16,this[n+2]=e>>>8,this[n+3]=e&255,n+4};function ie(d,e,n,y,O,G){if(n+y>d.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function it(d,e,n,y,O){return e=+e,n=n>>>0,O||ie(d,e,n,4),M.write(d,e,n,y,23,4),n+4}t.prototype.writeFloatLE=function(e,n,y){return it(this,e,n,!0,y)},t.prototype.writeFloatBE=function(e,n,y){return it(this,e,n,!1,y)};function k(d,e,n,y,O){return e=+e,n=n>>>0,O||ie(d,e,n,8),M.write(d,e,n,y,52,8),n+8}t.prototype.writeDoubleLE=function(e,n,y){return k(this,e,n,!0,y)},t.prototype.writeDoubleBE=function(e,n,y){return k(this,e,n,!1,y)},t.prototype.copy=function(e,n,y,O){if(!t.isBuffer(e))throw new TypeError("argument should be a Buffer");if(y||(y=0),!O&&O!==0&&(O=this.length),n>=e.length&&(n=e.length),n||(n=0),O>0&&O<y&&(O=y),O===y||e.length===0||this.length===0)return 0;if(n<0)throw new RangeError("targetStart out of bounds");if(y<0||y>=this.length)throw new RangeError("Index out of range");if(O<0)throw new RangeError("sourceEnd out of bounds");O>this.length&&(O=this.length),e.length-n<O-y&&(O=e.length-n+y);var G=O-y;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(n,y,O):Uint8Array.prototype.set.call(e,this.subarray(y,O),n),G},t.prototype.fill=function(e,n,y,O){if(typeof e=="string"){if(typeof n=="string"?(O=n,n=0,y=this.length):typeof y=="string"&&(O=y,y=this.length),O!==void 0&&typeof O!="string")throw new TypeError("encoding must be a string");if(typeof O=="string"&&!t.isEncoding(O))throw new TypeError("Unknown encoding: "+O);if(e.length===1){var G=e.charCodeAt(0);(O==="utf8"&&G<128||O==="latin1")&&(e=G)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(n<0||this.length<n||this.length<y)throw new RangeError("Out of range index");if(y<=n)return this;n=n>>>0,y=y===void 0?this.length:y>>>0,e||(e=0);var j;if(typeof e=="number")for(j=n;j<y;++j)this[j]=e;else{var ve=t.isBuffer(e)?e:t.from(e,O),Me=ve.length;if(Me===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(j=0;j<y-n;++j)this[j+n]=ve[j%Me]}return this};var Fe=/[^+/0-9A-Za-z-_]/g;function c(d){if(d=d.split("=")[0],d=d.trim().replace(Fe,""),d.length<2)return"";for(;d.length%4!==0;)d=d+"=";return d}function a(d,e){e=e||1/0;for(var n,y=d.length,O=null,G=[],j=0;j<y;++j){if(n=d.charCodeAt(j),n>55295&&n<57344){if(!O){if(n>56319){(e-=3)>-1&&G.push(239,191,189);continue}else if(j+1===y){(e-=3)>-1&&G.push(239,191,189);continue}O=n;continue}if(n<56320){(e-=3)>-1&&G.push(239,191,189),O=n;continue}n=(O-55296<<10|n-56320)+65536}else O&&(e-=3)>-1&&G.push(239,191,189);if(O=null,n<128){if((e-=1)<0)break;G.push(n)}else if(n<2048){if((e-=2)<0)break;G.push(n>>6|192,n&63|128)}else if(n<65536){if((e-=3)<0)break;G.push(n>>12|224,n>>6&63|128,n&63|128)}else if(n<1114112){if((e-=4)<0)break;G.push(n>>18|240,n>>12&63|128,n>>6&63|128,n&63|128)}else throw new Error("Invalid code point")}return G}function U(d){for(var e=[],n=0;n<d.length;++n)e.push(d.charCodeAt(n)&255);return e}function P(d,e){for(var n,y,O,G=[],j=0;j<d.length&&!((e-=2)<0);++j)n=d.charCodeAt(j),y=n>>8,O=n%256,G.push(O),G.push(y);return G}function ge(d){return l.toByteArray(c(d))}function Se(d,e,n,y){for(var O=0;O<y&&!(O+n>=e.length||O>=d.length);++O)e[O+n]=d[O];return O}function be(d,e){return d instanceof e||d!=null&&d.constructor!=null&&d.constructor.name!=null&&d.constructor.name===e.name}function Be(d){return d!==d}var ze=(function(){for(var d="0123456789abcdef",e=new Array(256),n=0;n<16;++n)for(var y=n*16,O=0;O<16;++O)e[y+O]=d[n]+d[O];return e})()})(qn)),qn}var rr;function ts(){if(rr)return Gn;rr=1;var v=es().Buffer,l=v.isEncoding||function(t){switch(t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function M(t){if(t&&!l(t))throw new Error("Unknown encoding: "+t)}var m=Gn.StringDecoder=function(t){switch(this.encoding=(t||"utf8").toLowerCase().replace(/[-_]/,""),M(t),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=o;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=i;break;default:this.write=g;return}this.charBuffer=new v(6),this.charReceived=0,this.charLength=0};m.prototype.write=function(t){for(var p="";this.charLength;){var x=t.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:t.length;if(t.copy(this.charBuffer,this.charReceived,0,x),this.charReceived+=x,this.charReceived<this.charLength)return"";t=t.slice(x,t.length),p=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var w=p.charCodeAt(p.length-1);if(w>=55296&&w<=56319){this.charLength+=this.surrogateSize,p="";continue}if(this.charReceived=this.charLength=0,t.length===0)return p;break}this.detectIncompleteChar(t);var b=t.length;this.charLength&&(t.copy(this.charBuffer,0,t.length-this.charReceived,b),b-=this.charReceived),p+=t.toString(this.encoding,0,b);var b=p.length-1,w=p.charCodeAt(b);if(w>=55296&&w<=56319){var A=this.surrogateSize;return this.charLength+=A,this.charReceived+=A,this.charBuffer.copy(this.charBuffer,A,0,A),t.copy(this.charBuffer,0,0,A),p.substring(0,b)}return p},m.prototype.detectIncompleteChar=function(t){for(var p=t.length>=3?3:t.length;p>0;p--){var x=t[t.length-p];if(p==1&&x>>5==6){this.charLength=2;break}if(p<=2&&x>>4==14){this.charLength=3;break}if(p<=3&&x>>3==30){this.charLength=4;break}}this.charReceived=p},m.prototype.end=function(t){var p="";if(t&&t.length&&(p=this.write(t)),this.charReceived){var x=this.charReceived,b=this.charBuffer,w=this.encoding;p+=b.slice(0,x).toString(w)}return p};function g(t){return t.toString(this.encoding)}function o(t){this.charReceived=t.length%2,this.charLength=this.charReceived?2:0}function i(t){this.charReceived=t.length%3,this.charLength=this.charReceived?3:0}return Gn}var or;function ns(){return or||(or=1,(function(v){(function(l){l.parser=function(c,a){return new m(c,a)},l.SAXParser=m,l.SAXStream=b,l.createStream=x,l.MAX_BUFFER_LENGTH=64*1024;var M=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];l.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function m(c,a){if(!(this instanceof m))return new m(c,a);var U=this;o(U),U.q=U.c="",U.bufferCheckPosition=l.MAX_BUFFER_LENGTH,U.opt=a||{},U.opt.lowercase=U.opt.lowercase||U.opt.lowercasetags,U.looseCase=U.opt.lowercase?"toLowerCase":"toUpperCase",U.tags=[],U.closed=U.closedRoot=U.sawRoot=!1,U.tag=U.error=null,U.strict=!!c,U.noscript=!!(c||U.opt.noscript),U.state=s.BEGIN,U.strictEntities=U.opt.strictEntities,U.ENTITIES=U.strictEntities?Object.create(l.XML_ENTITIES):Object.create(l.ENTITIES),U.attribList=[],U.opt.xmlns&&(U.ns=Object.create(D)),U.opt.unquotedAttributeValues===void 0&&(U.opt.unquotedAttributeValues=!c),U.trackPosition=U.opt.position!==!1,U.trackPosition&&(U.position=U.line=U.column=0),z(U,"onready")}Object.create||(Object.create=function(c){function a(){}a.prototype=c;var U=new a;return U}),Object.keys||(Object.keys=function(c){var a=[];for(var U in c)c.hasOwnProperty(U)&&a.push(U);return a});function g(c){for(var a=Math.max(l.MAX_BUFFER_LENGTH,10),U=0,P=0,ge=M.length;P<ge;P++){var Se=c[M[P]].length;if(Se>a)switch(M[P]){case"textNode":ce(c);break;case"cdata":J(c,"oncdata",c.cdata),c.cdata="";break;case"script":J(c,"onscript",c.script),c.script="";break;default:Le(c,"Max buffer length exceeded: "+M[P])}U=Math.max(U,Se)}var be=l.MAX_BUFFER_LENGTH-U;c.bufferCheckPosition=be+c.position}function o(c){for(var a=0,U=M.length;a<U;a++)c[M[a]]=""}function i(c){ce(c),c.cdata!==""&&(J(c,"oncdata",c.cdata),c.cdata=""),c.script!==""&&(J(c,"onscript",c.script),c.script="")}m.prototype={end:function(){he(this)},write:Fe,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){i(this)}};var t;try{t=Ko.Stream}catch{t=function(){}}t||(t=function(){});var p=l.EVENTS.filter(function(c){return c!=="error"&&c!=="end"});function x(c,a){return new b(c,a)}function b(c,a){if(!(this instanceof b))return new b(c,a);t.apply(this),this._parser=new m(c,a),this.writable=!0,this.readable=!0;var U=this;this._parser.onend=function(){U.emit("end")},this._parser.onerror=function(P){U.emit("error",P),U._parser.error=null},this._decoder=null,p.forEach(function(P){Object.defineProperty(U,"on"+P,{get:function(){return U._parser["on"+P]},set:function(ge){if(!ge)return U.removeAllListeners(P),U._parser["on"+P]=ge,ge;U.on(P,ge)},enumerable:!0,configurable:!1})})}b.prototype=Object.create(t.prototype,{constructor:{value:b}}),b.prototype.write=function(c){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(c)){if(!this._decoder){var a=ts().StringDecoder;this._decoder=new a("utf8")}c=this._decoder.write(c)}return this._parser.write(c.toString()),this.emit("data",c),!0},b.prototype.end=function(c){return c&&c.length&&this.write(c),this._parser.end(),!0},b.prototype.on=function(c,a){var U=this;return!U._parser["on"+c]&&p.indexOf(c)!==-1&&(U._parser["on"+c]=function(){var P=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);P.splice(0,0,c),U.emit.apply(U,P)}),t.prototype.on.call(U,c,a)};var w="[CDATA[",A="DOCTYPE",E="http://www.w3.org/XML/1998/namespace",L="http://www.w3.org/2000/xmlns/",D={xml:E,xmlns:L},F=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,I=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,T=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,u=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function h(c){return c===" "||c===`
`||c==="\r"||c==="	"}function f(c){return c==='"'||c==="'"}function N(c){return c===">"||h(c)}function W(c,a){return c.test(a)}function B(c,a){return!W(c,a)}var s=0;l.STATE={BEGIN:s++,BEGIN_WHITESPACE:s++,TEXT:s++,TEXT_ENTITY:s++,OPEN_WAKA:s++,SGML_DECL:s++,SGML_DECL_QUOTED:s++,DOCTYPE:s++,DOCTYPE_QUOTED:s++,DOCTYPE_DTD:s++,DOCTYPE_DTD_QUOTED:s++,COMMENT_STARTING:s++,COMMENT:s++,COMMENT_ENDING:s++,COMMENT_ENDED:s++,CDATA:s++,CDATA_ENDING:s++,CDATA_ENDING_2:s++,PROC_INST:s++,PROC_INST_BODY:s++,PROC_INST_ENDING:s++,OPEN_TAG:s++,OPEN_TAG_SLASH:s++,ATTRIB:s++,ATTRIB_NAME:s++,ATTRIB_NAME_SAW_WHITE:s++,ATTRIB_VALUE:s++,ATTRIB_VALUE_QUOTED:s++,ATTRIB_VALUE_CLOSED:s++,ATTRIB_VALUE_UNQUOTED:s++,ATTRIB_VALUE_ENTITY_Q:s++,ATTRIB_VALUE_ENTITY_U:s++,CLOSE_TAG:s++,CLOSE_TAG_SAW_WHITE:s++,SCRIPT:s++,SCRIPT_ENDING:s++},l.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},l.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(l.ENTITIES).forEach(function(c){var a=l.ENTITIES[c],U=typeof a=="number"?String.fromCharCode(a):a;l.ENTITIES[c]=U});for(var C in l.STATE)l.STATE[l.STATE[C]]=C;s=l.STATE;function z(c,a,U){c[a]&&c[a](U)}function J(c,a,U){c.textNode&&ce(c),z(c,a,U)}function ce(c){c.textNode=de(c.opt,c.textNode),c.textNode&&z(c,"ontext",c.textNode),c.textNode=""}function de(c,a){return c.trim&&(a=a.trim()),c.normalize&&(a=a.replace(/\s+/g," ")),a}function Le(c,a){return ce(c),c.trackPosition&&(a+=`
Line: `+c.line+`
Column: `+c.column+`
Char: `+c.c),a=new Error(a),c.error=a,z(c,"onerror",a),c}function he(c){return c.sawRoot&&!c.closedRoot&&K(c,"Unclosed root tag"),c.state!==s.BEGIN&&c.state!==s.BEGIN_WHITESPACE&&c.state!==s.TEXT&&Le(c,"Unexpected end"),ce(c),c.c="",c.closed=!0,z(c,"onend"),m.call(c,c.strict,c.opt),c}function K(c,a){if(typeof c!="object"||!(c instanceof m))throw new Error("bad call to strictFail");c.strict&&Le(c,a)}function V(c){c.strict||(c.tagName=c.tagName[c.looseCase]());var a=c.tags[c.tags.length-1]||c,U=c.tag={name:c.tagName,attributes:{}};c.opt.xmlns&&(U.ns=a.ns),c.attribList.length=0,J(c,"onopentagstart",U)}function Te(c,a){var U=c.indexOf(":"),P=U<0?["",c]:c.split(":"),ge=P[0],Se=P[1];return a&&c==="xmlns"&&(ge="xmlns",Se=""),{prefix:ge,local:Se}}function re(c){if(c.strict||(c.attribName=c.attribName[c.looseCase]()),c.attribList.indexOf(c.attribName)!==-1||c.tag.attributes.hasOwnProperty(c.attribName)){c.attribName=c.attribValue="";return}if(c.opt.xmlns){var a=Te(c.attribName,!0),U=a.prefix,P=a.local;if(U==="xmlns")if(P==="xml"&&c.attribValue!==E)K(c,"xml: prefix must be bound to "+E+`
Actual: `+c.attribValue);else if(P==="xmlns"&&c.attribValue!==L)K(c,"xmlns: prefix must be bound to "+L+`
Actual: `+c.attribValue);else{var ge=c.tag,Se=c.tags[c.tags.length-1]||c;ge.ns===Se.ns&&(ge.ns=Object.create(Se.ns)),ge.ns[P]=c.attribValue}c.attribList.push([c.attribName,c.attribValue])}else c.tag.attributes[c.attribName]=c.attribValue,J(c,"onattribute",{name:c.attribName,value:c.attribValue});c.attribName=c.attribValue=""}function me(c,a){if(c.opt.xmlns){var U=c.tag,P=Te(c.tagName);U.prefix=P.prefix,U.local=P.local,U.uri=U.ns[P.prefix]||"",U.prefix&&!U.uri&&(K(c,"Unbound namespace prefix: "+JSON.stringify(c.tagName)),U.uri=P.prefix);var ge=c.tags[c.tags.length-1]||c;U.ns&&ge.ns!==U.ns&&Object.keys(U.ns).forEach(function(j){J(c,"onopennamespace",{prefix:j,uri:U.ns[j]})});for(var Se=0,be=c.attribList.length;Se<be;Se++){var Be=c.attribList[Se],ze=Be[0],d=Be[1],e=Te(ze,!0),n=e.prefix,y=e.local,O=n===""?"":U.ns[n]||"",G={name:ze,value:d,prefix:n,local:y,uri:O};n&&n!=="xmlns"&&!O&&(K(c,"Unbound namespace prefix: "+JSON.stringify(n)),G.uri=n),c.tag.attributes[ze]=G,J(c,"onattribute",G)}c.attribList.length=0}c.tag.isSelfClosing=!!a,c.sawRoot=!0,c.tags.push(c.tag),J(c,"onopentag",c.tag),a||(!c.noscript&&c.tagName.toLowerCase()==="script"?c.state=s.SCRIPT:c.state=s.TEXT,c.tag=null,c.tagName=""),c.attribName=c.attribValue="",c.attribList.length=0}function Y(c){if(!c.tagName){K(c,"Weird empty close tag."),c.textNode+="</>",c.state=s.TEXT;return}if(c.script){if(c.tagName!=="script"){c.script+="</"+c.tagName+">",c.tagName="",c.state=s.SCRIPT;return}J(c,"onscript",c.script),c.script=""}var a=c.tags.length,U=c.tagName;c.strict||(U=U[c.looseCase]());for(var P=U;a--;){var ge=c.tags[a];if(ge.name!==P)K(c,"Unexpected close tag");else break}if(a<0){K(c,"Unmatched closing tag: "+c.tagName),c.textNode+="</"+c.tagName+">",c.state=s.TEXT;return}c.tagName=U;for(var Se=c.tags.length;Se-- >a;){var be=c.tag=c.tags.pop();c.tagName=c.tag.name,J(c,"onclosetag",c.tagName);var Be={};for(var ze in be.ns)Be[ze]=be.ns[ze];var d=c.tags[c.tags.length-1]||c;c.opt.xmlns&&be.ns!==d.ns&&Object.keys(be.ns).forEach(function(e){var n=be.ns[e];J(c,"onclosenamespace",{prefix:e,uri:n})})}a===0&&(c.closedRoot=!0),c.tagName=c.attribValue=c.attribName="",c.attribList.length=0,c.state=s.TEXT}function ie(c){var a=c.entity,U=a.toLowerCase(),P,ge="";return c.ENTITIES[a]?c.ENTITIES[a]:c.ENTITIES[U]?c.ENTITIES[U]:(a=U,a.charAt(0)==="#"&&(a.charAt(1)==="x"?(a=a.slice(2),P=parseInt(a,16),ge=P.toString(16)):(a=a.slice(1),P=parseInt(a,10),ge=P.toString(10))),a=a.replace(/^0+/,""),isNaN(P)||ge.toLowerCase()!==a?(K(c,"Invalid character entity"),"&"+c.entity+";"):String.fromCodePoint(P))}function it(c,a){a==="<"?(c.state=s.OPEN_WAKA,c.startTagPosition=c.position):h(a)||(K(c,"Non-whitespace before first tag."),c.textNode=a,c.state=s.TEXT)}function k(c,a){var U="";return a<c.length&&(U=c.charAt(a)),U}function Fe(c){var a=this;if(this.error)throw this.error;if(a.closed)return Le(a,"Cannot write after close. Assign an onready handler.");if(c===null)return he(a);typeof c=="object"&&(c=c.toString());for(var U=0,P="";P=k(c,U++),a.c=P,!!P;)switch(a.trackPosition&&(a.position++,P===`
`?(a.line++,a.column=0):a.column++),a.state){case s.BEGIN:if(a.state=s.BEGIN_WHITESPACE,P==="\uFEFF")continue;it(a,P);continue;case s.BEGIN_WHITESPACE:it(a,P);continue;case s.TEXT:if(a.sawRoot&&!a.closedRoot){for(var ge=U-1;P&&P!=="<"&&P!=="&";)P=k(c,U++),P&&a.trackPosition&&(a.position++,P===`
`?(a.line++,a.column=0):a.column++);a.textNode+=c.substring(ge,U-1)}P==="<"&&!(a.sawRoot&&a.closedRoot&&!a.strict)?(a.state=s.OPEN_WAKA,a.startTagPosition=a.position):(!h(P)&&(!a.sawRoot||a.closedRoot)&&K(a,"Text data outside of root node."),P==="&"?a.state=s.TEXT_ENTITY:a.textNode+=P);continue;case s.SCRIPT:P==="<"?a.state=s.SCRIPT_ENDING:a.script+=P;continue;case s.SCRIPT_ENDING:P==="/"?a.state=s.CLOSE_TAG:(a.script+="<"+P,a.state=s.SCRIPT);continue;case s.OPEN_WAKA:if(P==="!")a.state=s.SGML_DECL,a.sgmlDecl="";else if(!h(P))if(W(F,P))a.state=s.OPEN_TAG,a.tagName=P;else if(P==="/")a.state=s.CLOSE_TAG,a.tagName="";else if(P==="?")a.state=s.PROC_INST,a.procInstName=a.procInstBody="";else{if(K(a,"Unencoded <"),a.startTagPosition+1<a.position){var Se=a.position-a.startTagPosition;P=new Array(Se).join(" ")+P}a.textNode+="<"+P,a.state=s.TEXT}continue;case s.SGML_DECL:if(a.sgmlDecl+P==="--"){a.state=s.COMMENT,a.comment="",a.sgmlDecl="";continue}a.doctype&&a.doctype!==!0&&a.sgmlDecl?(a.state=s.DOCTYPE_DTD,a.doctype+="<!"+a.sgmlDecl+P,a.sgmlDecl=""):(a.sgmlDecl+P).toUpperCase()===w?(J(a,"onopencdata"),a.state=s.CDATA,a.sgmlDecl="",a.cdata=""):(a.sgmlDecl+P).toUpperCase()===A?(a.state=s.DOCTYPE,(a.doctype||a.sawRoot)&&K(a,"Inappropriately located doctype declaration"),a.doctype="",a.sgmlDecl=""):P===">"?(J(a,"onsgmldeclaration",a.sgmlDecl),a.sgmlDecl="",a.state=s.TEXT):(f(P)&&(a.state=s.SGML_DECL_QUOTED),a.sgmlDecl+=P);continue;case s.SGML_DECL_QUOTED:P===a.q&&(a.state=s.SGML_DECL,a.q=""),a.sgmlDecl+=P;continue;case s.DOCTYPE:P===">"?(a.state=s.TEXT,J(a,"ondoctype",a.doctype),a.doctype=!0):(a.doctype+=P,P==="["?a.state=s.DOCTYPE_DTD:f(P)&&(a.state=s.DOCTYPE_QUOTED,a.q=P));continue;case s.DOCTYPE_QUOTED:a.doctype+=P,P===a.q&&(a.q="",a.state=s.DOCTYPE);continue;case s.DOCTYPE_DTD:P==="]"?(a.doctype+=P,a.state=s.DOCTYPE):P==="<"?(a.state=s.OPEN_WAKA,a.startTagPosition=a.position):f(P)?(a.doctype+=P,a.state=s.DOCTYPE_DTD_QUOTED,a.q=P):a.doctype+=P;continue;case s.DOCTYPE_DTD_QUOTED:a.doctype+=P,P===a.q&&(a.state=s.DOCTYPE_DTD,a.q="");continue;case s.COMMENT:P==="-"?a.state=s.COMMENT_ENDING:a.comment+=P;continue;case s.COMMENT_ENDING:P==="-"?(a.state=s.COMMENT_ENDED,a.comment=de(a.opt,a.comment),a.comment&&J(a,"oncomment",a.comment),a.comment=""):(a.comment+="-"+P,a.state=s.COMMENT);continue;case s.COMMENT_ENDED:P!==">"?(K(a,"Malformed comment"),a.comment+="--"+P,a.state=s.COMMENT):a.doctype&&a.doctype!==!0?a.state=s.DOCTYPE_DTD:a.state=s.TEXT;continue;case s.CDATA:P==="]"?a.state=s.CDATA_ENDING:a.cdata+=P;continue;case s.CDATA_ENDING:P==="]"?a.state=s.CDATA_ENDING_2:(a.cdata+="]"+P,a.state=s.CDATA);continue;case s.CDATA_ENDING_2:P===">"?(a.cdata&&J(a,"oncdata",a.cdata),J(a,"onclosecdata"),a.cdata="",a.state=s.TEXT):P==="]"?a.cdata+="]":(a.cdata+="]]"+P,a.state=s.CDATA);continue;case s.PROC_INST:P==="?"?a.state=s.PROC_INST_ENDING:h(P)?a.state=s.PROC_INST_BODY:a.procInstName+=P;continue;case s.PROC_INST_BODY:if(!a.procInstBody&&h(P))continue;P==="?"?a.state=s.PROC_INST_ENDING:a.procInstBody+=P;continue;case s.PROC_INST_ENDING:P===">"?(J(a,"onprocessinginstruction",{name:a.procInstName,body:a.procInstBody}),a.procInstName=a.procInstBody="",a.state=s.TEXT):(a.procInstBody+="?"+P,a.state=s.PROC_INST_BODY);continue;case s.OPEN_TAG:W(I,P)?a.tagName+=P:(V(a),P===">"?me(a):P==="/"?a.state=s.OPEN_TAG_SLASH:(h(P)||K(a,"Invalid character in tag name"),a.state=s.ATTRIB));continue;case s.OPEN_TAG_SLASH:P===">"?(me(a,!0),Y(a)):(K(a,"Forward-slash in opening tag not followed by >"),a.state=s.ATTRIB);continue;case s.ATTRIB:if(h(P))continue;P===">"?me(a):P==="/"?a.state=s.OPEN_TAG_SLASH:W(F,P)?(a.attribName=P,a.attribValue="",a.state=s.ATTRIB_NAME):K(a,"Invalid attribute name");continue;case s.ATTRIB_NAME:P==="="?a.state=s.ATTRIB_VALUE:P===">"?(K(a,"Attribute without value"),a.attribValue=a.attribName,re(a),me(a)):h(P)?a.state=s.ATTRIB_NAME_SAW_WHITE:W(I,P)?a.attribName+=P:K(a,"Invalid attribute name");continue;case s.ATTRIB_NAME_SAW_WHITE:if(P==="=")a.state=s.ATTRIB_VALUE;else{if(h(P))continue;K(a,"Attribute without value"),a.tag.attributes[a.attribName]="",a.attribValue="",J(a,"onattribute",{name:a.attribName,value:""}),a.attribName="",P===">"?me(a):W(F,P)?(a.attribName=P,a.state=s.ATTRIB_NAME):(K(a,"Invalid attribute name"),a.state=s.ATTRIB)}continue;case s.ATTRIB_VALUE:if(h(P))continue;f(P)?(a.q=P,a.state=s.ATTRIB_VALUE_QUOTED):(a.opt.unquotedAttributeValues||Le(a,"Unquoted attribute value"),a.state=s.ATTRIB_VALUE_UNQUOTED,a.attribValue=P);continue;case s.ATTRIB_VALUE_QUOTED:if(P!==a.q){P==="&"?a.state=s.ATTRIB_VALUE_ENTITY_Q:a.attribValue+=P;continue}re(a),a.q="",a.state=s.ATTRIB_VALUE_CLOSED;continue;case s.ATTRIB_VALUE_CLOSED:h(P)?a.state=s.ATTRIB:P===">"?me(a):P==="/"?a.state=s.OPEN_TAG_SLASH:W(F,P)?(K(a,"No whitespace between attributes"),a.attribName=P,a.attribValue="",a.state=s.ATTRIB_NAME):K(a,"Invalid attribute name");continue;case s.ATTRIB_VALUE_UNQUOTED:if(!N(P)){P==="&"?a.state=s.ATTRIB_VALUE_ENTITY_U:a.attribValue+=P;continue}re(a),P===">"?me(a):a.state=s.ATTRIB;continue;case s.CLOSE_TAG:if(a.tagName)P===">"?Y(a):W(I,P)?a.tagName+=P:a.script?(a.script+="</"+a.tagName,a.tagName="",a.state=s.SCRIPT):(h(P)||K(a,"Invalid tagname in closing tag"),a.state=s.CLOSE_TAG_SAW_WHITE);else{if(h(P))continue;B(F,P)?a.script?(a.script+="</"+P,a.state=s.SCRIPT):K(a,"Invalid tagname in closing tag."):a.tagName=P}continue;case s.CLOSE_TAG_SAW_WHITE:if(h(P))continue;P===">"?Y(a):K(a,"Invalid characters in closing tag");continue;case s.TEXT_ENTITY:case s.ATTRIB_VALUE_ENTITY_Q:case s.ATTRIB_VALUE_ENTITY_U:var be,Be;switch(a.state){case s.TEXT_ENTITY:be=s.TEXT,Be="textNode";break;case s.ATTRIB_VALUE_ENTITY_Q:be=s.ATTRIB_VALUE_QUOTED,Be="attribValue";break;case s.ATTRIB_VALUE_ENTITY_U:be=s.ATTRIB_VALUE_UNQUOTED,Be="attribValue";break}if(P===";"){var ze=ie(a);a.opt.unparsedEntities&&!Object.values(l.XML_ENTITIES).includes(ze)?(a.entity="",a.state=be,a.write(ze)):(a[Be]+=ze,a.entity="",a.state=be)}else W(a.entity.length?u:T,P)?a.entity+=P:(K(a,"Invalid character in entity name"),a[Be]+="&"+a.entity+P,a.entity="",a.state=be);continue;default:throw new Error(a,"Unknown state: "+a.state)}return a.position>=a.bufferCheckPosition&&g(a),a}/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */String.fromCodePoint||(function(){var c=String.fromCharCode,a=Math.floor,U=function(){var P=16384,ge=[],Se,be,Be=-1,ze=arguments.length;if(!ze)return"";for(var d="";++Be<ze;){var e=Number(arguments[Be]);if(!isFinite(e)||e<0||e>1114111||a(e)!==e)throw RangeError("Invalid code point: "+e);e<=65535?ge.push(e):(e-=65536,Se=(e>>10)+55296,be=e%1024+56320,ge.push(Se,be)),(Be+1===ze||ge.length>P)&&(d+=c.apply(null,ge),ge.length=0)}return d};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:U,configurable:!0,writable:!0}):String.fromCodePoint=U})()})(v)})(zn)),zn}var rn={exports:{}},sr;function is(){if(sr)return rn.exports;sr=1;var v=typeof Reflect=="object"?Reflect:null,l=v&&typeof v.apply=="function"?v.apply:function(f,N,W){return Function.prototype.apply.call(f,N,W)},M;v&&typeof v.ownKeys=="function"?M=v.ownKeys:Object.getOwnPropertySymbols?M=function(f){return Object.getOwnPropertyNames(f).concat(Object.getOwnPropertySymbols(f))}:M=function(f){return Object.getOwnPropertyNames(f)};function m(h){console&&console.warn&&console.warn(h)}var g=Number.isNaN||function(f){return f!==f};function o(){o.init.call(this)}rn.exports=o,rn.exports.once=I,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var i=10;function t(h){if(typeof h!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof h)}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return i},set:function(h){if(typeof h!="number"||h<0||g(h))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+h+".");i=h}}),o.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(f){if(typeof f!="number"||f<0||g(f))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+f+".");return this._maxListeners=f,this};function p(h){return h._maxListeners===void 0?o.defaultMaxListeners:h._maxListeners}o.prototype.getMaxListeners=function(){return p(this)},o.prototype.emit=function(f){for(var N=[],W=1;W<arguments.length;W++)N.push(arguments[W]);var B=f==="error",s=this._events;if(s!==void 0)B=B&&s.error===void 0;else if(!B)return!1;if(B){var C;if(N.length>0&&(C=N[0]),C instanceof Error)throw C;var z=new Error("Unhandled error."+(C?" ("+C.message+")":""));throw z.context=C,z}var J=s[f];if(J===void 0)return!1;if(typeof J=="function")l(J,this,N);else for(var ce=J.length,de=L(J,ce),W=0;W<ce;++W)l(de[W],this,N);return!0};function x(h,f,N,W){var B,s,C;if(t(N),s=h._events,s===void 0?(s=h._events=Object.create(null),h._eventsCount=0):(s.newListener!==void 0&&(h.emit("newListener",f,N.listener?N.listener:N),s=h._events),C=s[f]),C===void 0)C=s[f]=N,++h._eventsCount;else if(typeof C=="function"?C=s[f]=W?[N,C]:[C,N]:W?C.unshift(N):C.push(N),B=p(h),B>0&&C.length>B&&!C.warned){C.warned=!0;var z=new Error("Possible EventEmitter memory leak detected. "+C.length+" "+String(f)+" listeners added. Use emitter.setMaxListeners() to increase limit");z.name="MaxListenersExceededWarning",z.emitter=h,z.type=f,z.count=C.length,m(z)}return h}o.prototype.addListener=function(f,N){return x(this,f,N,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(f,N){return x(this,f,N,!0)};function b(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function w(h,f,N){var W={fired:!1,wrapFn:void 0,target:h,type:f,listener:N},B=b.bind(W);return B.listener=N,W.wrapFn=B,B}o.prototype.once=function(f,N){return t(N),this.on(f,w(this,f,N)),this},o.prototype.prependOnceListener=function(f,N){return t(N),this.prependListener(f,w(this,f,N)),this},o.prototype.removeListener=function(f,N){var W,B,s,C,z;if(t(N),B=this._events,B===void 0)return this;if(W=B[f],W===void 0)return this;if(W===N||W.listener===N)--this._eventsCount===0?this._events=Object.create(null):(delete B[f],B.removeListener&&this.emit("removeListener",f,W.listener||N));else if(typeof W!="function"){for(s=-1,C=W.length-1;C>=0;C--)if(W[C]===N||W[C].listener===N){z=W[C].listener,s=C;break}if(s<0)return this;s===0?W.shift():D(W,s),W.length===1&&(B[f]=W[0]),B.removeListener!==void 0&&this.emit("removeListener",f,z||N)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(f){var N,W,B;if(W=this._events,W===void 0)return this;if(W.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):W[f]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete W[f]),this;if(arguments.length===0){var s=Object.keys(W),C;for(B=0;B<s.length;++B)C=s[B],C!=="removeListener"&&this.removeAllListeners(C);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(N=W[f],typeof N=="function")this.removeListener(f,N);else if(N!==void 0)for(B=N.length-1;B>=0;B--)this.removeListener(f,N[B]);return this};function A(h,f,N){var W=h._events;if(W===void 0)return[];var B=W[f];return B===void 0?[]:typeof B=="function"?N?[B.listener||B]:[B]:N?F(B):L(B,B.length)}o.prototype.listeners=function(f){return A(this,f,!0)},o.prototype.rawListeners=function(f){return A(this,f,!1)},o.listenerCount=function(h,f){return typeof h.listenerCount=="function"?h.listenerCount(f):E.call(h,f)},o.prototype.listenerCount=E;function E(h){var f=this._events;if(f!==void 0){var N=f[h];if(typeof N=="function")return 1;if(N!==void 0)return N.length}return 0}o.prototype.eventNames=function(){return this._eventsCount>0?M(this._events):[]};function L(h,f){for(var N=new Array(f),W=0;W<f;++W)N[W]=h[W];return N}function D(h,f){for(;f+1<h.length;f++)h[f]=h[f+1];h.pop()}function F(h){for(var f=new Array(h.length),N=0;N<f.length;++N)f[N]=h[N].listener||h[N];return f}function I(h,f){return new Promise(function(N,W){function B(C){h.removeListener(f,s),W(C)}function s(){typeof h.removeListener=="function"&&h.removeListener("error",B),N([].slice.call(arguments))}u(h,f,s,{once:!0}),f!=="error"&&T(h,B,{once:!0})})}function T(h,f,N){typeof h.on=="function"&&u(h,"error",f,N)}function u(h,f,N,W){if(typeof h.on=="function")W.once?h.once(f,N):h.on(f,N);else if(typeof h.addEventListener=="function")h.addEventListener(f,function B(s){W.once&&h.removeEventListener(f,B),N(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof h)}return rn.exports}var on={},ar;function rs(){return ar||(ar=1,(function(){on.stripBOM=function(v){return v[0]==="\uFEFF"?v.substring(1):v}}).call(on)),on}var yt={},lr;function wr(){return lr||(lr=1,(function(){var v;v=new RegExp(/(?!xmlns)^.*:/),yt.normalize=function(l){return l.toLowerCase()},yt.firstCharLowerCase=function(l){return l.charAt(0).toLowerCase()+l.slice(1)},yt.stripPrefix=function(l){return l.replace(v,"")},yt.parseNumbers=function(l){return isNaN(l)||(l=l%1===0?parseInt(l,10):parseFloat(l)),l},yt.parseBooleans=function(l){return/^(?:true|false)$/i.test(l)&&(l=l.toLowerCase()==="true"),l}}).call(yt)),yt}const os=new Proxy({},{get(v,l){throw new Error(`Module "timers" has been externalized for browser compatibility. Cannot access "timers.${l}" in client code.  See https://vite.dev/guide/troubleshooting.html#module-externalized-for-browser-compatibility for more details.`)}}),ss=Object.freeze(Object.defineProperty({__proto__:null,default:os},Symbol.toStringTag,{value:"Module"})),as=dr(ss);var ur;function ls(){return ur||(ur=1,(function(v){(function(){var l,M,m,g,o,i,t,p,x,b=function(E,L){return function(){return E.apply(L,arguments)}},w=function(E,L){for(var D in L)A.call(L,D)&&(E[D]=L[D]);function F(){this.constructor=E}return F.prototype=L.prototype,E.prototype=new F,E.__super__=L.prototype,E},A={}.hasOwnProperty;p=ns(),g=is(),l=rs(),t=wr(),x=as.setImmediate,M=jn().defaults,o=function(E){return typeof E=="object"&&E!=null&&Object.keys(E).length===0},i=function(E,L,D){var F,I,T;for(F=0,I=E.length;F<I;F++)T=E[F],L=T(L,D);return L},m=function(E,L,D){var F;return F=Object.create(null),F.value=D,F.writable=!0,F.enumerable=!0,F.configurable=!0,Object.defineProperty(E,L,F)},v.Parser=(function(E){w(L,E);function L(D){this.parseStringPromise=b(this.parseStringPromise,this),this.parseString=b(this.parseString,this),this.reset=b(this.reset,this),this.assignOrPush=b(this.assignOrPush,this),this.processAsync=b(this.processAsync,this);var F,I,T;if(!(this instanceof v.Parser))return new v.Parser(D);this.options={},I=M["0.2"];for(F in I)A.call(I,F)&&(T=I[F],this.options[F]=T);for(F in D)A.call(D,F)&&(T=D[F],this.options[F]=T);this.options.xmlns&&(this.options.xmlnskey=this.options.attrkey+"ns"),this.options.normalizeTags&&(this.options.tagNameProcessors||(this.options.tagNameProcessors=[]),this.options.tagNameProcessors.unshift(t.normalize)),this.reset()}return L.prototype.processAsync=function(){var D,F;try{return this.remaining.length<=this.options.chunkSize?(D=this.remaining,this.remaining="",this.saxParser=this.saxParser.write(D),this.saxParser.close()):(D=this.remaining.substr(0,this.options.chunkSize),this.remaining=this.remaining.substr(this.options.chunkSize,this.remaining.length),this.saxParser=this.saxParser.write(D),x(this.processAsync))}catch(I){if(F=I,!this.saxParser.errThrown)return this.saxParser.errThrown=!0,this.emit(F)}},L.prototype.assignOrPush=function(D,F,I){return F in D?(D[F]instanceof Array||m(D,F,[D[F]]),D[F].push(I)):this.options.explicitArray?m(D,F,[I]):m(D,F,I)},L.prototype.reset=function(){var D,F,I,T;return this.removeAllListeners(),this.saxParser=p.parser(this.options.strict,{trim:!1,normalize:!1,xmlns:this.options.xmlns}),this.saxParser.errThrown=!1,this.saxParser.onerror=(function(u){return function(h){if(u.saxParser.resume(),!u.saxParser.errThrown)return u.saxParser.errThrown=!0,u.emit("error",h)}})(this),this.saxParser.onend=(function(u){return function(){if(!u.saxParser.ended)return u.saxParser.ended=!0,u.emit("end",u.resultObject)}})(this),this.saxParser.ended=!1,this.EXPLICIT_CHARKEY=this.options.explicitCharkey,this.resultObject=null,T=[],D=this.options.attrkey,F=this.options.charkey,this.saxParser.onopentag=(function(u){return function(h){var f,N,W,B,s;if(W={},W[F]="",!u.options.ignoreAttrs){s=h.attributes;for(f in s)A.call(s,f)&&(!(D in W)&&!u.options.mergeAttrs&&(W[D]={}),N=u.options.attrValueProcessors?i(u.options.attrValueProcessors,h.attributes[f],f):h.attributes[f],B=u.options.attrNameProcessors?i(u.options.attrNameProcessors,f):f,u.options.mergeAttrs?u.assignOrPush(W,B,N):m(W[D],B,N))}return W["#name"]=u.options.tagNameProcessors?i(u.options.tagNameProcessors,h.name):h.name,u.options.xmlns&&(W[u.options.xmlnskey]={uri:h.uri,local:h.local}),T.push(W)}})(this),this.saxParser.onclosetag=(function(u){return function(){var h,f,N,W,B,s,C,z,J,ce;if(s=T.pop(),B=s["#name"],(!u.options.explicitChildren||!u.options.preserveChildrenOrder)&&delete s["#name"],s.cdata===!0&&(h=s.cdata,delete s.cdata),J=T[T.length-1],s[F].match(/^\s*$/)&&!h?(f=s[F],delete s[F]):(u.options.trim&&(s[F]=s[F].trim()),u.options.normalize&&(s[F]=s[F].replace(/\s{2,}/g," ").trim()),s[F]=u.options.valueProcessors?i(u.options.valueProcessors,s[F],B):s[F],Object.keys(s).length===1&&F in s&&!u.EXPLICIT_CHARKEY&&(s=s[F])),o(s)&&(typeof u.options.emptyTag=="function"?s=u.options.emptyTag():s=u.options.emptyTag!==""?u.options.emptyTag:f),u.options.validator!=null&&(ce="/"+(function(){var de,Le,he;for(he=[],de=0,Le=T.length;de<Le;de++)W=T[de],he.push(W["#name"]);return he})().concat(B).join("/"),(function(){var de;try{return s=u.options.validator(ce,J&&J[B],s)}catch(Le){return de=Le,u.emit("error",de)}})()),u.options.explicitChildren&&!u.options.mergeAttrs&&typeof s=="object"){if(!u.options.preserveChildrenOrder)W={},u.options.attrkey in s&&(W[u.options.attrkey]=s[u.options.attrkey],delete s[u.options.attrkey]),!u.options.charsAsChildren&&u.options.charkey in s&&(W[u.options.charkey]=s[u.options.charkey],delete s[u.options.charkey]),Object.getOwnPropertyNames(s).length>0&&(W[u.options.childkey]=s),s=W;else if(J){J[u.options.childkey]=J[u.options.childkey]||[],C={};for(N in s)A.call(s,N)&&m(C,N,s[N]);J[u.options.childkey].push(C),delete s["#name"],Object.keys(s).length===1&&F in s&&!u.EXPLICIT_CHARKEY&&(s=s[F])}}return T.length>0?u.assignOrPush(J,B,s):(u.options.explicitRoot&&(z=s,s={},m(s,B,z)),u.resultObject=s,u.saxParser.ended=!0,u.emit("end",u.resultObject))}})(this),I=(function(u){return function(h){var f,N;if(N=T[T.length-1],N)return N[F]+=h,u.options.explicitChildren&&u.options.preserveChildrenOrder&&u.options.charsAsChildren&&(u.options.includeWhiteChars||h.replace(/\\n/g,"").trim()!=="")&&(N[u.options.childkey]=N[u.options.childkey]||[],f={"#name":"__text__"},f[F]=h,u.options.normalize&&(f[F]=f[F].replace(/\s{2,}/g," ").trim()),N[u.options.childkey].push(f)),N}})(this),this.saxParser.ontext=I,this.saxParser.oncdata=(function(u){return function(h){var f;if(f=I(h),f)return f.cdata=!0}})()},L.prototype.parseString=function(D,F){var I;F!=null&&typeof F=="function"&&(this.on("end",function(T){return this.reset(),F(null,T)}),this.on("error",function(T){return this.reset(),F(T)}));try{return D=D.toString(),D.trim()===""?(this.emit("end",null),!0):(D=l.stripBOM(D),this.options.async?(this.remaining=D,x(this.processAsync),this.saxParser):this.saxParser.write(D).close())}catch(T){if(I=T,this.saxParser.errThrown||this.saxParser.ended){if(this.saxParser.ended)throw I}else return this.emit("error",I),this.saxParser.errThrown=!0}},L.prototype.parseStringPromise=function(D){return new Promise((function(F){return function(I,T){return F.parseString(D,function(u,h){return u?T(u):I(h)})}})(this))},L})(g),v.parseString=function(E,L,D){var F,I,T;return D!=null?(typeof D=="function"&&(F=D),typeof L=="object"&&(I=L)):(typeof L=="function"&&(F=L),I={}),T=new v.Parser(I),T.parseString(E,F)},v.parseStringPromise=function(E,L){var D,F;return typeof L=="object"&&(D=L),F=new v.Parser(D),F.parseStringPromise(E)}}).call(tn)})(tn)),tn}var cr;function us(){return cr||(cr=1,(function(){var v,l,M,m,g=function(i,t){for(var p in t)o.call(t,p)&&(i[p]=t[p]);function x(){this.constructor=i}return x.prototype=t.prototype,i.prototype=new x,i.__super__=t.prototype,i},o={}.hasOwnProperty;l=jn(),v=$o(),M=ls(),m=wr(),st.defaults=l.defaults,st.processors=m,st.ValidationError=(function(i){g(t,i);function t(p){this.message=p}return t})(Error),st.Builder=v.Builder,st.Parser=M.Parser,st.parseString=M.parseString,st.parseStringPromise=M.parseStringPromise}).call(st)),st}var cs=us();const pr=Vr(cs),ps=`<div class="tab-mission-control">\r
    <div style="padding-top: 20px;padding-left: 20px; padding-right: 20px;position: relative;">\r
        <div class="tab_title" data-i18n="tabMissionControl"></div>\r
    </div>\r
    <div class="content_wrapper">\r
        <div class="cf_column fourth" id="missionControls">\r
            <div class="spacer_right">\r
                <div id="missionPlannerAction" class="gui_box grey">\r
                    <div class="gui_box_titlebar">\r
                        <div class="spacer_box_title" data-i18n="missionActionMenuHead"></div>\r
                        <div class="btnMenu btnMenuIcon show_btn"  id="showHideActionButton">\r
                            <a class="ic_hide" href="#" i18n_title="missionTitleHide"></a>\r
                        </div>\r
                    </div>\r
                    <div class="spacer" id="ActionContent">\r
\r
                        <div class="btn save_btn">\r
                            <a id="loadFileMissionButton" class="btnicon ic_loadFromFile" href="#" i18n_title="missionTitleLoadMissionFile"></a>\r
                            <a id="saveFileMissionButton" class="btnicon ic_save2File" href="#" i18n_title="missionTitleSaveMissionFile"></a>\r
                        </div>\r
                        <div class="btn save_btn">\r
                            <a id="loadMissionButton" class="btnicon ic_loadFromFC" href="#" i18n_title="missionTitleLoadMissionFromFC"> </a>\r
                                <a id="saveMissionButton" class="btnicon ic_save2FC" href="#" i18n_title="missionTitleSaveMissionToFC"> </a>\r
                                    <a id="loadEepromMissionButton" class="btnicon ic_loadFromEprom" href="#" i18n_title="missionTitleLoadEepromMission"></a>\r
                                    <a id="saveEepromMissionButton" class="btnicon ic_save2Eprom" href="#" i18n_title="missionTitleSaveEepromMission"></a>\r
                        </div>\r
                        <hr>\r
                        <!-- <div class="btn">\r
                            <a id="playMissionButton" class="btnicon ic_play" href="#" title="Play mission"></a>\r
                            <div class="btn-danger">\r
                                <a id="stopMissionButton" class="btnicon ic_stop" href="#" title="Stop mission"></a>\r
                            </div>\r
                        </div>\r
                        <hr> -->\r
                        <div id="removeAllPoints" class="btn btn-danger" style="padding-top: 1px; display: inline-block">\r
                            <a class="btnicon ic_removeAll" href="#" i18n_title="missionTitleRemoveAll"></a>\r
                        </div>\r
                    </div>\r
                </div>\r
\r
                <div id="missionPlannerTotalInfo" class="gui_box grey">\r
                    <div class="gui_box_titlebar">\r
                        <div class="spacer_box_title" data-i18n="missionTotalInformationHead"></div>\r
                        <div class="btnMenu btnMenuIcon show_btn"  id="showHideInfoButton">\r
                            <a class="ic_hide" href="#" i18n_title="missionTitleHide"></a>\r
                        </div>\r
                    </div>\r
                    <div class="spacer"  id="InfoContent">\r
                        <div id="infoMissionFilename" style="padding-bottom: 2px;">\r
                            <span data-i18n="missionTotalInfoFilenameLoaded"></span>\r
                            <span id="missionFilename" style="color: #3394b5"></span>\r
                        </div>\r
                        <div id="infoMissionDistance" style="padding-bottom: 2px;">\r
                            <span data-i18n="missionTotalInfoDistance"></span>\r
                            <span id="missionDistance"></span>\r
                        </div>\r
                        <div id="infoAvailablePoints" style="padding-bottom: 2px;">\r
                            <span data-i18n="missionTotalInfoAvailablePoints"></span>\r
                            <span id="availablePoints">0/0</span>\r
                        </div>\r
                        <div id="infoMissionValid" style="padding-bottom: 2px;">\r
                            <span data-i18n="missionTotalInfoMissionValid"></span>\r
                            <div id="missionValid" style="display: inline-block"></div>\r
                        </div>\r
                        <div id="infoGeozoneMissionWarning" style="padding-bottom: 2px;">\r
                            <span style="color: red" i18n-replaced data-i18n="warning"></span>\r
                            <div id="geozoneMissionWarning" style="display: inline-block" data-i18n="missionGeozoneWarning"></div>\r
                        </div>\r
                        <div id="infoGeozoneInvalid" style="padding-bottom: 2px;">\r
                            <span style="color: red" i18n-replaced data-i18n="warning"></span>\r
                            <div style="display: inline-block" data-i18n="geozoneInvalidzone"></div>\r
                            <span id="geozoneInvalidContent"></span>\r
                        </div>\r
                    </div>\r
                </div>\r
\r
                <div id="missionPlannerSettings" class="gui_box grey" style="display: none">\r
                    <div class="gui_box_titlebar">\r
                        <div class="spacer_box_title" data-i18n="missionDefaultSettingsHead"></div>\r
                        <div class="btnMenu btnMenuIcon  save_btn">\r
                            <a id="cancelSettings" class="ic_cancel" href="#" i18n_title="missionTitleCancel"></a>\r
                            <a id="saveSettings" class="ic_save" href="#" i18n_title="missionTitleSave"></a>\r
                        </div>\r
                    </div>\r
                    <div class="spacer">\r
                        <div class="point">\r
                            <label class="point-label" for="MPdefaultPointAlt" data-i18n="missionDefaultPointAlt"></label>\r
                            <input id="MPdefaultPointAlt" type="text" value="0" required>\r
                        </div>\r
                        <div class="point">\r
                            <label class="point-label" for="MPdefaultPointSpeed" data-i18n="missionDefaultPointSpeed"></label>\r
                            <input id="MPdefaultPointSpeed" type="text" value="0" required>\r
                        </div>\r
                        <div class="point">\r
                            <label class="point-label" for="MPdefaultSafeRangeSH" data-i18n="missionDefaultSafeRangeSH"></label>\r
                            <input id="MPdefaultSafeRangeSH" type="text" value="0" required>\r
                        </div>\r
                        <div class="point">\r
                            <label class="point-label" for="MPdefaultFwApproachAlt">FW Approach Alt (m): </label>\r
                            <input id="MPdefaultFwApproachAlt" type="text" value="0" required>\r
                        </div>\r
                        <div class="point">\r
                            <label class="point-label" for="MPdefaultLandAlt">FW Land Alt (m): </label>\r
                            <input id="MPdefaultLandAlt" type="text" value="0" required>\r
                        </div>\r
                    </div>\r
                </div>\r
\r
                <div id="missionPlannerMultiMission" class="gui_box grey" style="display: none">\r
                    <div class="gui_box_titlebar">\r
                        <div class="spacer_box_title" data-i18n="missionMultiMissionHead"></div>\r
                        <div class="btnMenu btnMenuIcon save_btn">\r
                            <div id="showHideMultimissionButton">\r
                                <a class="ic_hide" href="#" i18n_title="missionTitleHide"></a>\r
                            </div>\r
                            <a id="cancelMultimission" class="ic_cancel" href="#" i18n_title="missionTitleCancel"></a>\r
                        </div>\r
                    </div>\r
                    <div class="spacer" id="multimissionContent">\r
                        <div class="btn btnTable btnTableIcon save_btn">\r
                            <div>\r
                                <span data-i18n="missionMultiMissionsInfo"></span>\r
                                <span id="multimissionInfo">None</span>\r
                            </div>\r
                            <div style="margin-top: 5px">\r
                                <span data-i18n="missionMultiActiveMission"></span>\r
                                <span id="activeNissionIndex">1</span>\r
                                <a class="ic_save disabled" id="setActiveMissionButton" href="#" i18n_title="missionTitleSetActive"></a>\r
                            </div>\r
                            <hr>\r
                            <div style="display: inline-block">\r
                                <label for="multimissionOptionList" data-i18n="missionMultiMissionNo."></label>\r
                                <select name="Number" id="multimissionOptionList" style="width: 50px">\r
                                    <option value="0">ALL</option>\r
                                </select>\r
                                <div style="float: right">\r
                                    <span data-i18n="missionMultiUpdateAll"></span>\r
                                    <a class="ic_save disabled" id="updateMultimissionButton" href="#" i18n_title="missionTitleUpdateAll"></a>\r
                                </div>\r
                                <div style="margin-bottom: 5px; margin-top: 5px">\r
                                    <label for="addMultimissionButton" data-i18n="missionMultiAddNewMission"></label>\r
                                    <a class="ic_add disabled" id="addMultimissionButton" href="#" i18n_title="missionTitleAdd"></a>\r
                                </div>\r
                            </div>\r
                        </div>\r
                    </div>\r
                </div>\r
\r
                <div id="missionPlannerHome" class="gui_box grey" style="display: none">\r
                    <div class="gui_box_titlebar">\r
                        <div class="spacer_box_title" data-i18n="missionHomeHead"></div>\r
                        <div class="btnMenu btnMenuIcon  save_btn">\r
                            <div id="showHideHomeButton">\r
                                <a class="ic_hide" href="#" i18n_title="missionTitleHide"></a>\r
                            </div>\r
                            <a id="cancelHome" class="ic_cancel" href="#" i18n_title="missionTitleCancel"></a>\r
                        </div>\r
                    </div>\r
                    <div class="spacer" id="HomeContent">\r
                        <div>\r
                            <table class="safehomesTable">\r
                                <thead>\r
                                    <tr>\r
                                        <th style="width: 40px" data-i18n="SafehomeSelected"></th>\r
                                        <th style="width: 140px" data-i18n="SafehomeLat"></th>\r
                                        <th style="width: 140px" data-i18n="SafehomeLon"></th>\r
                                        <th style="width: 100px" data-i18n="SafehomeAlt"></th>\r
                                    </tr>\r
                                </thead>\r
                                <tbody id="homeTableBody">\r
                                    <tr>\r
                                        <td>\r
                                            <div id="viewHomePoint" class="btnTable btnTableIcon">\r
                                                <a class="ic_center" data-role="home-center" href="#" i18n_title="missionTitleMoveToCenterView"></a>\r
                                            </div>\r
                                        </td>\r
                                        <td><input type="number" class="home-lat" /></td>\r
                                        <td><input type="number" class="home-lon" /></td>\r
                                        <td><span id="elevationValueAtHome">N/A</span></td>\r
                                    </tr>\r
                                </tbody>\r
                            </table>\r
                        </div>\r
                    </div>\r
                </div>\r
\r
                <div id="missionPlannerSafehome" class="gui_box grey" style="display: none">\r
                    <div class="gui_box_titlebar">\r
                        <div class="spacer_box_title" data-i18n="missionSafehomeHead"></div>\r
                        <div class="btnMenu btnMenuIcon  save_btn">\r
                            <div id="showHideSafehomeButton">\r
                                <a class="ic_hide" href="#" i18n_title="missionTitleHide"></a>\r
                            </div>\r
                            <a id="cancelSafehome" class="ic_cancel" href="#" title="Cancel"></a>\r
                            <a id="addSafehome" class="ic_add" href="#" i18n_title="missionTitleAdd"></a>\r
                            <a id="saveEepromSafehomeButton" class="ic_save2Eprom" href="#" i18n_title="missionTitleSaveEepromSafehome"></a>\r
                            <a id="loadEepromSafehomeButton" class="ic_loadFromEprom" href="#" i18n_title="missionTitleLoadEepromSafehome"></a>\r
                        </div>\r
                    </div>\r
                    <div class="spacer" id="SafehomeContent">\r
                            <div style="padding-bottom: 2px;">\r
                                <span data-i18n="missionSafehomeAvailableSafehomes"></span>\r
                                <span id="availableSafehomes"></span>\r
                            </div>\r
                            <div id="SafehomeContentBox" style="display: none;">\r
                                <div class="gui_box grey missionPlannerSafehomeBox">\r
                                    <div class="gui_box_titlebar">\r
                                        <div class="spacer_box_title" data-i18n="safehomeEdit"></div>\r
                                        <div class="btnMenu btnMenuIcon">\r
                                            <div class="btnMenu-danger">\r
                                                <a id="deleteSafehome" class="ic_removeAll" href="#" i18n_title="missionTitleDelete"></a>\r
                                            </div>\r
                                        </div>\r
                                    </div>\r
                                    <div class="spacer" id="safehomeSingelContent">\r
                                        <div class="point">\r
                                            <label class="point-label-safehome" for="safeHomeLatitude" data-i18n="gpsLat"></label>\r
                                            <input type="number" id="safehomeLatitude"></input>\r
                                        </div>\r
                                        <div class="point">\r
                                            <label class="point-label-safehome" for="safehomeLongitude" data-i18n="gpsLon"></label>\r
                                            <input type="number" id="safehomeLongitude"></input>\r
                                        </div>\r
                                        <div class="point">\r
                                            <span style="font-weight: bold" data-i18n="missionFwLandingSettings"></span>\r
                                        </div>\r
                                        <div class="point">\r
                                            <label class="point-label-safehome" for="safehomeSeaLevelRef" data-i18n="missionSeaLevelRef"></label>\r
                                            <input id="safehomeSeaLevelRef" type="checkbox" value="0" class="togglemedium" required>\r
                                        </div>\r
                                        <div class="point">\r
                                            <label class="point-label-safehome" for="safehomeApproachAlt" data-i18n="missionFwApproachAlt"></label>\r
                                            <input type="number" id="safehomeApproachAlt"></input>\r
                                            <span id="safehomeApproachAltM"></span>\r
                                        </div>\r
                                        <div class="point">\r
                                            <label class="point-label-safehome" for="safehomeLandAlt" data-i18n="missionFwLandAlt"></label>\r
                                            <input type="number" id="safehomeLandAlt"></input>\r
                                            <span id="safehomeLandAltM"></span>\r
                                        </div>\r
                                        <div class="point">\r
                                            <label class="point-label-safehome" for="safehomeElevation" data-i18n="missionElevation"></label>\r
                                            <span id="safehomeElevation"></span>\r
                                        </div>\r
                                        <div class="point">\r
                                            <label class="point-label-safehome" for="geozoneApproachDirection" data-i18n="missionFwApproachDir"></label>\r
                                            <select name="zoneAction" id="geozoneApproachDirection">\r
                                                <option value="0">Left</option>\r
                                                <option value="1">Right</option>\r
                                            </select>\r
                                        </div>\r
                                        <div class="point">\r
                                            <label class="point-label-safehome" for="safehomeLandHeading1" data-i18n="missionFwLandHeading1"></label>\r
                                            <input type="number" id="safehomeLandHeading1"></input>\r
                                            <input id="safehomeLandHeading1Excl" type="checkbox" value="0" class="togglemedium" required>\r
                                            <span data-i18n="missionExclusive"></span>\r
                                        </div>\r
                                        <div class="point">\r
                                            <label class="point-label-safehome" for="safehomeLandHeading2" data-i18n="missionFwLandHeading2"></label>\r
                                            <input type="number" id="safehomeLandHeading2"></input>\r
                                            <input id="safehomeLandHeading2Excl" type="checkbox" value="0" class="togglemedium" required>\r
                                            <span data-i18n="missionExclusive"></span>\r
                                        </div>\r
                                    </div>\r
                                </div>\r
                            </div>\r
                            <hr>\r
                            <div class="spacer"  id="safehomeLegend">\r
                                <span><b data-i18n="SafehomeLegend"></b></span>\r
                                <div class="legendItem">\r
                                    <span class="fill" style="border-bottom:5px dotted #900C3F;"></span>\r
                                    <span class="textLegend" data-i18n="SafehomeMaxDistance"></span>\r
                                    <span id="safeHomeMaxDistance"></span>\r
                                </div>\r
                                <div class="legendItem">\r
                                    <span class="fill" style="border-bottom:5px dotted #88CC3E;"></span>\r
                                    <span class="textLegend" data-i18n="SafehomeSafeRadius"></span>\r
                                    <span id="SafeHomeSafeDistance"></span>\r
                                </div>\r
                                <div class="legendItem">\r
                                    <span class="fill" style="border-bottom:5px solid #f78a05;border-top:5px solid #0025a1;"></span>\r
                                    <span class="textLegend" data-i18n="SafehomeFwAppraoch"></span>\r
                                    <span id="SafeHomeSafeDistance"></span>\r
                                </div>\r
                            </div>\r
                    </div>\r
                </div>\r
\r
                <div id="missionPlannerGeozones" class="gui_box grey" style="display: none">\r
                    <div class="gui_box_titlebar">\r
                        <div class="spacer_box_title" data-i18n="missionGeozoneHead"></div>\r
                        <div class="btnMenu btnMenuIcon save_btn">\r
                            <div id="showHideGeozonesButton">\r
                                <a class="ic_hide" href="#" title="Hide"></a>\r
                            </div>\r
                            <a id="cancelGeozone" class="ic_cancel" href="#" title="Cancel"></a>\r
                            <a id="addGeozone" class="ic_add" href="#" title="Add Geozone"></a>  \r
                            <a id="saveEepromGeozoneButton" class="ic_save2Eprom" href="#" i18n_title="missionGeozoneSaveAndReboot"></a>\r
                            <a id="loadEepromGeozoneButton" class="ic_loadFromEprom" href="#" i18n_title="missionGeozoneLoad"></a> \r
                        </div>\r
                    </div>\r
                    <div class="spacer" id="geozoneContent">\r
                        <div style="padding-bottom: 2px;">\r
                            <span data-i18n="missionGeozoneAvailableZones"></span>\r
                            <span id="availableGeozones"></span>\r
                        </div>\r
                        <div id="infoAvailableVeritces" style="padding-bottom: 2px;">\r
                            <span data-i18n="missionGeozoneAvailableVertices"></span>\r
                            <span id="availableVertices"></span>\r
                        </div>\r
                        <div id="geozoneContentBox" style="display: none;" >\r
                            <div class="gui_box grey missionPlannerGeozone">\r
                                <div class="gui_box_titlebar">\r
                                    <div class="spacer_box_title" data-i18n="geozoneEdit"></div>\r
                                    <div class="btnMenu btnMenuIcon">\r
                                        <div class="btnMenu-danger">\r
                                            <a id="deleteGeozone" class="ic_removeAll" href="#" title="Delete"></a>\r
                                        </div>\r
                                    </div>\r
                                </div>\r
                                <div class="spacer" id="geozoneSingelContent">\r
                                    <div class="point">\r
                                        <label class="point-label" for="zoneType" data-i18n="geozoneShape"></label>\r
                                        <select name="zoneShape" id="geozoneShape">\r
                                            <option value="1" data-i18n="missionGeozoneTypePolygon"></option>\r
                                            <option value="0" data-i18n="missionGeozoneTypeCircular"></option>\r
                                        </select>\r
                                    </div>\r
                                    <div class="point">\r
                                        <label class="point-label" for="zoneType" data-i18n="missionGezoneType"></label>\r
                                        <select name="zoneType" id="geozoneType">\r
                                            <option value="1" data-i18n="geozoneInclusive"></option>\r
                                            <option value="0" data-i18n="geozoneExcusive"></option>\r
                                        </select>\r
                                    </div>\r
                                    <div class="point">\r
                                        <label class="point-label" for="zoneMinAlt" data-i18n="geozoneMinAlt"></label>\r
                                        <input type="number" id="geozoneMinAlt"></input>\r
                                        <span id="geozoneMinAltM"></span>\r
                                    </div>\r
                                    <div class="point">\r
                                        <label class="point-label" for="zoneMaxAlt" data-i18n="geozoneMaxAlt"></label>\r
                                        <input type="number" id="geozoneMaxAlt"></input>\r
                                        <span id="geozoneMaxAltM"></span><br/>\r
                                        <span data-i18n="geozoneInfiniteAlt"></span>\r
                                    </div>\r
                                    <div class="point">\r
                                        <label class="point-label" for="geozoneSeaLevelRef" data-i18n="missionSeaLevelRef"></label>\r
                                        <input id="geozoneSeaLevelRef" type="checkbox" value="0" class="togglemedium" required>\r
                                    </div>\r
                                    <div class="point">\r
                                        <label class="point-label" for="zoneAction" data-i18n="geozoneAction">Action:</label>\r
                                        <select name="zoneAction" id="geozoneAction">\r
                                            <option value="0" data-i18n="geozoneActionNone"></option>\r
                                            <option value="1" data-i18n="geozoneActionAvoid"></option>\r
                                            <option value="2" data-i18n="geozoneActionPosHold"></option>\r
                                            <option value="3" data-i18n="geozoneActionRTH"></option>\r
                                        </select>\r
                                    </div>\r
                                    <div class="point">\r
                                        <label class="point-label" for="raduis" data-i18n="geozoneRadius"></label>\r
                                        <input type="number" id="geozoneRadius"></input>\r
                                    </div>\r
                                    <div class="point">\r
                                        <label class="point-label" for="verticesTable" data-i18n="geozoneVerices"></label>\r
                                        <table class="geozoneVerticesTable" id="verticesTable">\r
                                            <thead>\r
                                                <tr>\r
                                                    <th style="width: 20px">&nbsp;</th>\r
                                                    <th style="width: 40px">#</th>\r
                                                    <th style="width: 120px" data-i18n="gpsLat"></th>\r
                                                    <th style="width: 120px" data-i18n="gpsLon"></th>\r
                                                </tr>\r
                                            </thead>\r
                                            <tbody id="geozoneVerticesTableBody">\r
                                            </tbody>\r
                                        </table>\r
                                    </div>\r
                                </div>\r
                            </div>\r
                        </div>\r
                    </div>\r
                </div>\r
\r
                <div class="gui_box grey" id="MPeditPoint" style="display: none">\r
                    <div class="gui_box_titlebar">\r
                        <div class="spacer_box_title" data-i18n="editPointHead" id="EditPointNumber"></div>\r
                        <div class="btnMenu btnMenuIcon">\r
                            <div id="showHideWPeditButton"   class="save_btn">\r
                                <a class="ic_hide" href="#" i18n_title="missionTitleHide"></a>\r
                            </div>\r
                            <div id="removePoint" class="btn btnMenu-danger">\r
                                <a id="removePointButton" class="ic_removeAll" href="#" i18n_title="missionTitlRemove"></a>\r
                            </div>\r
                            <div id="editMission" class="save_btn" style="display: none">\r
                                <a id="editMissionButton" class="ic_setup" href="#" i18n_title="missionTitlEditMission"></a>\r
                            </div>\r
                        </div>\r
                    </div>\r
                    <div class="spacer" id="WPeditContent">\r
                        <input type="hidden" name="pointNumber" value="">\r
                        <div class="point">\r
                            <label class="point-label" for="pointType" data-i18n="missionWpType"></label>\r
                            <select name="type" id="pointType">\r
                                <!--<option value="1">Home</option>-->\r
                                <option value="1">Waypoint</option>\r
								<!-- <option value="2">PH_UNLIM</option> -->\r
								<option value="3">PH_TIME</option>\r
								<!--<option value="4">RTH</option>-->\r
								<option value="5">POI</option>\r
								<!--<option value="6">Jump</option>\r
								<option value="7">Heading lock</option>-->\r
								<option value="8">Land</option>\r
                            </select>\r
                        </div>\r
                        <div class="point">\r
                            <label class="point-label" for="pointLat" data-i18n="missionWpLat"></label>\r
                            <input id="pointLat" type="text" value="0.0" required>\r
                        </div>\r
                        <div class="point">\r
                            <label class="point-label" for="pointLon" data-i18n="missionWpLon"></label>\r
                            <input id="pointLon" type="text" value="0.0" required>\r
                        </div>\r
                        <div class="point">\r
                            <label class="point-label" for="pointAlt" data-i18n="missionDefaultPointAlt"></label>\r
                            <input id="pointAlt" type="text" value="0" required><span id="altitudeInMeters"></span>\r
                        </div>\r
                        <div class="point" id="pointP3class" style="display: none">\r
                            <label class="point-label" for="pointP3Alt" data-i18n="missionSeaLevelRef"></label>\r
                            <input id="pointP3Alt" type="checkbox" value="0" class="togglemedium" checked required>\r
                        </div>\r
                        <div class="point" id="elevationAtWP" style="display: none">\r
                            <label class="point-label" data-i18n="missionElevation"></label>\r
                            <span id="elevationValueAtWP" data-i18n="missionNA"></span>\r
                        </div>\r
                        <div class="point" id="groundClearanceAtWP" style="display: none">\r
                            <label class="point-label" data-i18n="missionGroundDist"></label>\r
                            <span id="groundClearanceValueAtWP" data-i18n="missionNA"></span>\r
                        </div>\r
                        <div class="point" id="pointP1class" style="display: none">\r
                            <label class="point-label" for="pointP1" data-i18n="missionParameter1"></label>\r
                            <input id="pointP1" type="text" value="0" required>\r
                        </div>\r
                        <div class="point" id="pointP2class" style="display: none">\r
                            <label class="point-label" for="pointP2" data-i18n="missionParameter1"></label>\r
                            <input id="pointP2" type="text" value="0" required>\r
                        </div>\r
                        <div class="point" id="pointP3UserActionClass" style="display: none">\r
                            <label class="point-label" for="pointP3UserAction" data-i18n="missionUserActions"></label>\r
                            <div class="userActionContainer">1 <input id="pointP3UserAction1" type="checkbox" value="0" class="togglemedium" checked required></div>\r
                            <div class="userActionContainer">2 <input id="pointP3UserAction2" type="checkbox" value="0" class="togglemedium" checked required></div>\r
                            <div class="userActionContainer">3 <input id="pointP3UserAction3" type="checkbox" value="0" class="togglemedium" checked required></div>\r
                            <div class="userActionContainer">4 <input id="pointP3UserAction4" type="checkbox" value="0" class="togglemedium" checked required></div>\r
                        </div>\r
                        <div>\r
                            <table class="waypointOptionsTable">\r
                                <thead>\r
                                    <tr>\r
                                        <th style="width: 30px">\r
                                            <div id="addOptionsPoint" class="btn btnTable btnTableIcon btnTable-success">\r
                                                <a id="addOptionsPointButton" class="ic_add" data-role="waypointOptions-add" href="#" style="float: center" title="Add"></a>\r
                                            </div>\r
                                        </th>\r
                                        <th style="width: 50px" data-i18n="WaypointOptionId"></th>\r
                                        <th style="width: 80px" data-i18n="WaypointOptionAction"></th>\r
                                        <th style="width: 120px" data-i18n="WaypointOptionP1"></th>\r
                                        <th style="width: 120px" data-i18n="WaypointOptionP2"></th>\r
                                    </tr>\r
                                </thead>\r
                                <tbody id="waypointOptionsTableBody">\r
                                </tbody>\r
                            </table>\r
                        </div>\r
                        <div id="wpFwLanding" style="display: none;">\r
                            <div class="point">\r
                                <span style="font-weight: bold" data-i18n="missionFwLandingSettings"></span>\r
                            </div>\r
                            <div class="point">\r
                                <label class="point-label-safehome" for="wpApproachAlt" data-i18n="missionFwApproachAlt"></label>\r
                                <input type="number" id="wpApproachAlt"></input>\r
                                <span id="wpApproachAltM"></span>\r
                            </div>\r
                            <div class="point">\r
                                <label class="point-label-safehome" for="wpLandAlt" data-i18n="missionFwLandAlt"></label>\r
                                <input type="number" id="wpLandAlt"></input>\r
                                <span id="wpLandAltM"></span>\r
                            </div>\r
                            <div class="point">\r
                                <label class="point-label-safehome" for="wpApproachDirection" data-i18n="missionFwApproachDir"></label>\r
                                <select name="wpApproachDirection" id="wpApproachDirection">\r
                                    <option value="0">Left</option>\r
                                    <option value="1">Right</option>\r
                                </select>\r
                            </div> \r
                            <div class="point">\r
                                <label class="point-label-safehome" for="wpLandHeading1" data-i18n="missionFwLandHeading1"></label>\r
                                <input type="number" id="wpLandHeading1"></input>\r
                                <input id="wpLandHeading1Excl" type="checkbox" value="0" class="togglemedium" checked required>\r
                                <span data-i18n="missionExclusive"></span>\r
                            </div>\r
                            <div class="point">\r
                                <label class="point-label-safehome" for="wpLandHeading2" data-i18n="missionFwLandHeading1"></label>\r
                                <input type="number" id="wpLandHeading2"></input>\r
                                <input id="wpLandHeading2Excl" type="checkbox" value="0" class="togglemedium" checked required>\r
                                <span data-i18n="missionExclusive"></span>\r
                            </div>\r
                        </div>\r
                        <div id="wpFwLanding" style="display: none;">\r
                            <div class="point">\r
                                <span style="font-weight: bold" data-i18n="missionFwLandingSettings"></span>\r
                            </div>\r
                            <div class="point">\r
                                <label class="point-label-safehome" for="wpApproachAlt" data-i18n="missionFwApproachAlt"></label>\r
                                <input type="number" id="wpApproachAlt"></input>\r
                                <span id="wpApproachAltM"></span>\r
                            </div>\r
                            <div class="point">\r
                                <label class="point-label-safehome" for="wpLandAlt" data-i18n="missionFwLandAlt"></label>\r
                                <input type="number" id="wpLandAlt"></input>\r
                                <span id="wpLandAltM"></span>\r
                            </div>\r
                            <div class="point">\r
                                <label class="point-label-safehome" for="wpApproachDirection" data-i18n="missionFwApproachDir"></label>\r
                                <select name="wpApproachDirection" id="wpApproachDirection">\r
                                    <option value="0">Left</option>\r
                                    <option value="1">Right</option>\r
                                </select>\r
                            </div> \r
                            <div class="point">\r
                                <label class="point-label-safehome" for="wpLandHeading1" data-i18n="missionFwLandHeading1"></label>\r
                                <input type="number" id="wpLandHeading1"></input>\r
                                <input id="wpLandHeading1Excl" type="checkbox" value="0" class="togglemedium" checked required>\r
                                <span data-i18n="missionExclusive"></span>\r
                            </div>\r
                            <div class="point">\r
                                <label class="point-label-safehome" for="wpLandHeading2" data-i18n="missionFwLandHeading1"></label>\r
                                <input type="number" id="wpLandHeading2"></input>\r
                                <input id="wpLandHeading2Excl" type="checkbox" value="0" class="togglemedium" checked required>\r
                                <span data-i18n="missionExclusive"></span>\r
                            </div>\r
                        </div>\r
                        <!-- <div class="point-radio" id="pointOptionclass" style="display: none">\r
							<div class="radio-line">\r
								<input type="radio" id="Options_None" name="Options" value="None" checked>\r
								<label class="radio-options" for="Options_None">None</label><br>\r
							</div>\r
							<div class="radio-line">\r
								<input type="radio" id="Options_RTH" name="Options" value="RTH">\r
								<label class="radio-options" for="Options_RTH">RTH</label>\r
								<input type="checkbox" id="Options_LandRTH">\r
								<label for="Options_LandRTH">Land after RTH</label><br>\r
							</div>\r
							<div class="radio-line">\r
								<input type="radio" id="Options_JUMP" name="Options" value="JUMP">\r
								<label class="radio-options" for="Options_JUMP">JUMP</label>\r
								<label for="Options_TargetJUMP">Target WP: </label>\r
								<input id="Options_TargetJUMP" type="text" value="0" required>\r
								<label for="Options_NumberJUMP">Repeat: </label>\r
								<input id="Options_NumberJUMP" type="text" value="0" required><br>\r
							</div>\r
							<div class="radio-line">\r
								<input type="radio" id="Options_HEAD" name="Options" value="SET_HEAD">\r
								<label class="radio-options" for="Options_HEAD">HEAD</label>\r
								<label for="Options_HeadingHead">Heading: </label>\r
								<input id="Options_HeadingHead" type="text" value="-1" required><br>\r
							</div>\r
                        </div> -->\r
                    </div>\r
                </div>\r
            </div>\r
        </div>\r
        <div class="cf_column threefourth_left" style="height: 100%;">\r
            <div id="missionMap"></div>\r
            <div id="missionPlannerElevation" class="gui_box grey" style="display: none">\r
                <div class="gui_box_titlebar">\r
                    <div class="spacer_box_title" data-i18n="missionDefaultElevationHead"></div>\r
                    <div class="btnMenu btnMenuIcon  save_btn">\r
                        <a id="cancelPlot" class="ic_cancel" href="#" i18n_title="missionTitleCancel"></a>\r
                    </div>\r
                </div>\r
                <div class="spacer">\r
                    <div id="elevationDiv">\r
                        <canvas id="elevationChart"></canvas>\r
                    </div>\r
                </div>\r
            </div>\r
            <div id="notLoadMap" data-i18n="useOnlyStandalone" style="display: none;"></div>\r
        </div>\r
    </div>\r
</div>\r
`;var ds=-2e3,ut={1:{parameter1:"Speed (cm/s)",parameter2:"",parameter3:"Sea level Ref"},2:{parameter1:"",parameter2:"",parameter3:""},3:{parameter1:"Wait time (s)",parameter2:"Speed (cm/s)",parameter3:"Sea level Ref"},4:{parameter1:"Force land (non zero)",parameter2:"",parameter3:""},5:{parameter1:"",parameter2:"",parameter3:""},6:{parameter1:"Target WP number",parameter2:"Number of repeat (-1: infinite)",parameter3:""},7:{parameter1:"Heading (deg)",parameter2:"",parameter3:""},8:{parameter1:"",parameter2:"",parameter3:"Sea level Ref"}},Nt=["JUMP","SET_HEAD","RTH"];const hs=["icon_mission_airplane.png","icon_RTH.png","icon_safehome.png","icon_safehome_used.png","icon_geozone_excl.png","icon_geozone_incl.png","icon_home.png","icon_position_edit.png","icon_position_head.png","icon_position_LDG_edit.png","icon_position_LDG.png","icon_position_PH_edit.png","icon_position_PH.png","icon_position_POI.png","icon_position_POI_edit.png","icon_position_WP_edit.png","icon_position_WP.png","icon_position_edit.png","icon_arrow.png","settings_white.svg","icon_safehome_white.svg","icon_geozone_white.svg","icon_elevation_white.svg","icon_multimission_white.svg"],je=Object.create(null);Re.mission_control={};Re.mission_control.isYmapLoad=!1;Re.mission_control.initialize=function(v){let l=!1,M,m,g,o,i,t,p,x,b,w;var A;let E=!1,L,D,F,I,T,u=!1,h=!1,f={speed:0,alt:5e3,safeRadiusSH:50,fwApproachAlt:60,fwLandAlt:5,maxDistSH:0,fwApproachLength:0,fwLoiterRadius:0};if(Ee.active_tab!="mission_control"&&(Ee.active_tab="mission_control"),$.isFeatureEnabled("GEOZONE")&&(h=!0),jt.connectionValid){var N=new Rt;N.setChain([ke.getMissionInfo,ke.loadSafehomes,ke.loadFwApproach,function(_){h?ke.loadGeozones(_):_()},function(_){ke.getSetting("nav_fw_land_approach_length").then(H=>{f.fwApproachLength=parseInt(H.value)}).then(_)},function(_){ke.getSetting("safehome_max_distance").then(H=>{f.maxDistSH=parseInt(H.value)/100}).then(_)},function(_){ke.getSetting("nav_fw_loiter_radius").then(H=>{f.fwLoiterRadius=parseInt(H.value)}).then(_)}]),N.setExitPoint(s),N.execute()}else{s(),$.FW_APPROACH||($.FW_APPROACH=new zr),$.SAFEHOMES||($.SAFEHOMES=new Gr);for(let _=0;_<$.FW_APPROACH.getMaxFwApproachCount();_++)$.FW_APPROACH.put(new gi(_))}function W(_){return _.replace(/\.(png|svg)$/i,"")}async function B(){for(const _ of hs){const H=W(_),q=_.split(".").pop();let Z;if(q==="png"?Z=(await vi(Object.assign({"../images/icons/map/cf_icon_RTH.png":()=>Ce(()=>import("./cf_icon_RTH-D1f7VFzb.js"),[],import.meta.url),"../images/icons/map/cf_icon_arrow.png":()=>Ce(()=>import("./cf_icon_arrow-DyQaNVUk.js"),[],import.meta.url),"../images/icons/map/cf_icon_geozone_excl.png":()=>Ce(()=>import("./cf_icon_geozone_excl-Bs3eZLoE.js"),[],import.meta.url),"../images/icons/map/cf_icon_geozone_incl.png":()=>Ce(()=>import("./cf_icon_geozone_incl-Dc3KGbAp.js"),[],import.meta.url),"../images/icons/map/cf_icon_home.png":()=>Ce(()=>import("./cf_icon_home-kZxozzk1.js"),[],import.meta.url),"../images/icons/map/cf_icon_mission_airplane.png":()=>Ce(()=>import("./cf_icon_mission_airplane-DFRx-6-Z.js"),[],import.meta.url),"../images/icons/map/cf_icon_position.png":()=>Ce(()=>import("./cf_icon_position-DkF2qv43.js"),[],import.meta.url),"../images/icons/map/cf_icon_position_LDG.png":()=>Ce(()=>import("./cf_icon_position_LDG-DFTRXzOa.js"),[],import.meta.url),"../images/icons/map/cf_icon_position_LDG_edit.png":()=>Ce(()=>import("./cf_icon_position_LDG_edit-O4ZcHBmU.js"),[],import.meta.url),"../images/icons/map/cf_icon_position_PH.png":()=>Ce(()=>import("./cf_icon_position_PH-DD5GC0zq.js"),[],import.meta.url),"../images/icons/map/cf_icon_position_PH_edit.png":()=>Ce(()=>import("./cf_icon_position_PH_edit-BynejQiB.js"),[],import.meta.url),"../images/icons/map/cf_icon_position_POI.png":()=>Ce(()=>import("./cf_icon_position_POI-5Ffr9j84.js"),[],import.meta.url),"../images/icons/map/cf_icon_position_POI_edit.png":()=>Ce(()=>import("./cf_icon_position_POI_edit-B7Lg-C_i.js"),[],import.meta.url),"../images/icons/map/cf_icon_position_WP.png":()=>Ce(()=>import("./cf_icon_position_WP-DwtkOBPn.js"),[],import.meta.url),"../images/icons/map/cf_icon_position_WP_edit.png":()=>Ce(()=>import("./cf_icon_position_WP_edit-SHjsaxsh.js"),[],import.meta.url),"../images/icons/map/cf_icon_position_edit.png":()=>Ce(()=>import("./cf_icon_position_edit-CeHtHS_c.js"),[],import.meta.url),"../images/icons/map/cf_icon_position_head.png":()=>Ce(()=>import("./cf_icon_position_head-DgCYYWqH.js"),[],import.meta.url),"../images/icons/map/cf_icon_safehome.png":()=>Ce(()=>import("./cf_icon_safehome-FbDTojEL.js"),[],import.meta.url),"../images/icons/map/cf_icon_safehome_used.png":()=>Ce(()=>import("./cf_icon_safehome_used-SzPL9WSY.js"),[],import.meta.url)}),`../images/icons/map/cf_${H}.png`,5)).default:q==="svg"&&(Z=(await vi(Object.assign({"../images/icons/map/cf_icon_elevation_white.svg":()=>Ce(()=>import("./cf_icon_elevation_white-BW7O6haM.js"),[],import.meta.url),"../images/icons/map/cf_icon_geozone_white.svg":()=>Ce(()=>import("./cf_icon_geozone_white-BqAjbOd3.js"),[],import.meta.url),"../images/icons/map/cf_icon_multimission_white.svg":()=>Ce(()=>import("./cf_icon_multimission_white-Did5B9ms.js"),[],import.meta.url),"../images/icons/map/cf_icon_safehome_white.svg":()=>Ce(()=>import("./cf_icon_safehome_white-CgifqAXY.js"),[],import.meta.url),"../images/icons/map/cf_settings_white.svg":()=>Ce(()=>import("./cf_settings_white-BbCbi9qy.js"),[],import.meta.url)}),`../images/icons/map/cf_${H}.svg`,5)).default),!Z)throw new Error(`Missing icon URL for ${_}`);je[H]=Z}}function s(){Ee.load(ps,()=>B().then(C))}function C(){jt.connectionValid||(r("#infoAvailablePoints").hide(),r("#infoMissionValid").hide(),r("#loadMissionButton").hide(),r("#saveMissionButton").hide(),r("#loadEepromMissionButton").hide(),r("#saveEepromMissionButton").hide(),E=!0),r("#infoGeozoneMissionWarning").hide(),r("#infoGeozoneInvalid").hide(),D=r("#SafehomeContentBox"),F=r("#waypointOptionsTableBody"),T=r("#geozoneContent"),be(),setTimeout(Cr,200),E||(setTimeout(()=>{$.SAFEHOMES.safehomeCount()>=1?Lt(0):(L=null,ie=null),G(),O()},500),h&&setTimeout(()=>{I=$.GEOZONES.last(),Je(),rt()},500)),oe.localize();function _(){mt.send_message(gt.MSP_RAW_GPS,!1,!1,H)}function H(){mt.send_message(gt.MSP_COMP_GPS,!1,!1,q)}function q(){mt.send_message(gt.MSP_ALTITUDE,!1,!1,Z)}function Z(){mt.send_message(gt.MSP_ATTITUDE,!1,!1,ne)}function ne(){let X=$.GPS_DATA.lat/1e7,ue=$.GPS_DATA.lon/1e7;if($.GPS_DATA.fix>=2){if(!l){l=!0,M=new Ge({image:new Et({anchor:[.5,.5],opacity:1,scale:.6,src:je.icon_mission_airplane})});let De;m=new ot(He([ue,X]));let Ae=new Ye({geometry:m});Ae.setStyle(M);let S=new Ze({features:[Ae]});De=new tt({source:S});let R=new Ge({image:new Et({anchor:[.5,1],opacity:1,scale:.5,src:je.icon_RTH})});g=new ot(He([90,0]));let te=new Ye({geometry:g});te.setStyle(R);let ee=new Ze({features:[te]}),xe=new tt({source:ee});o=new Kt([He([ue,X]),He([ue,X])]),t=new Ge({stroke:new et({color:"#ffcc33",width:6})}),i=new Ye({geometry:o}),i.setStyle(t),p=new Ze({features:[i]}),x=new tt({source:p}),A=new ot([0,0]),b=new Ge({text:new Pt({font:"bold 35px Calibri,sans-serif",fill:new St({color:"#fff"}),offsetX:K.getSize()[0]-260,offsetY:80,textAlign:"left",backgroundFill:new St({color:"#000"}),stroke:new et({color:"#fff",width:2}),text:`H: XXX
Alt: XXXm
Speed: XXXcm/s`})}),w=new Ye({geometry:A}),w.setStyle(b);var we=new Ze({features:[w]}),se=new tt({source:we});K.addLayer(xe),K.addLayer(x),K.addLayer(De),K.addControl(se)}let Q=He([ue,X]);m.setCoordinates(Q),o.appendCoordinate(Q);var pe=o.getCoordinates();pe.length>100&&(pe.shift(),o.setCoordinates(pe)),M.getImage().setRotation($.SENSOR_DATA.kinematics[2]/360*6.28318),A.setCoordinates(K.getCoordinateFromPixel([0,0])),b.getText().setText(`                                
H: `+$.SENSOR_DATA.kinematics[2]+`
Alt: `+$.SENSOR_DATA.altitude+`m
Speed: `+$.GPS_DATA.speed+`cm/s
Dist: `+$.GPS_DATA.distanceToHome+"m")}}E||qr.add("gps_pull",function(){if(!jr.have_sensor($.CONFIG.activeSensors,"gps")){ne();return}_()},200),Ee.content_ready(v)}var z=[],J=[],ce=[],ce=[],de=[],ce=[],de=[],Le=[],he=[],K,V=null,Te=null,re=null,me=!1,Y=null,ie=null,it=!1,k=new yi,Fe=new yi,c=0,a=9,U=new $t(0,0,0,0),P=[];function ge(){r("#pointLat").val(""),r("#pointLon").val(""),r("#pointAlt").val(""),r("#pointP1").val(""),r("#pointP2").val(""),r("#pointP3Alt").val(""),r("#missionDistance").text(0),r("#MPeditPoint").fadeOut(300)}function Se(){r("#missionFilename").text("")}function be(){const _=Yt.storeGet("missionPlannerSettings",!1);_&&(!_.fwApproachLength&&f.fwApproachLength&&(_.fwApproachLength=f.fwApproachLength,_.maxDistSH=f.maxDistSH,_.fwLoiterRadius=f.fwLoiterRadius),Be(),f=_),ze()}function Be(){Yt.storeSet("missionPlannerSettings",f)}function ze(){r("#MPdefaultPointAlt").val(String(f.alt)),r("#MPdefaultPointSpeed").val(String(f.speed)),r("#MPdefaultSafeRangeSH").val(String(f.safeRadiusSH)),r("#MPdefaultFwApproachAlt").val(String(f.fwApproachAlt)),r("#MPdefaultLandAlt").val(String(f.fwLandAlt))}function d(){r("#missionPlannerSettings").hide()}function e(){r("#missionPlannerSafehome").hide(),j()}async function n(_,H,q){return _-(H?q*100:0)<0?(_e.alert(oe.getMessage("MissionPlannerAltitudeChangeReset")),!1):!0}function y(_,H,q){return _-(H?q*100:0)<ds?(_e.alert(oe.getMessage("MissionPlannerFwLAndingAltitudeChangeReset")),!1):!0}function O(){let _=$.SAFEHOMES.getMaxSafehomeCount()-$.SAFEHOMES.safehomeCount();r("#availableSafehomes").text(_+"/"+$.SAFEHOMES.getMaxSafehomeCount())}function G(){$.SAFEHOMES.get().forEach(_=>{Xe(_.getLonMap(),_.getLatMap(),$.FW_APPROACH.get()[_.getNumber()],ce)}),$.SAFEHOMES.get().forEach(_=>{Ie(_),bt(_)})}function j(){for(var _ in ce)K.removeLayer(ce[_]);ce=[]}function ve(_){return new Ge({image:new Et({anchor:[.5,1],opacity:1,scale:.5,src:_.isUsed()?je.icon_safehome_used:je.icon_safehome}),text:new Pt({text:String(Number(_.getNumber())+1),font:"12px sans-serif",offsetY:-15,offsetX:-2,fill:new St({color:"#FFFFFF"}),stroke:new et({color:"#FFFFFF"})})})}function Me(_,H,q,Z){var ne=new Kt([He([_.lon,_.lat]),He([H.lon,H.lat])]),X=new Ye({geometry:ne}),ue=[new Ge({stroke:new et({color:q,width:3})})],we=X.getGeometry();we.forEachSegment(function(Q,ye){var De=ye[0]-Q[0],Ae=ye[1]-Q[1],S=Math.atan2(Ae,De);ue.push(new Ge({geometry:new ot(so(Q,ye,-8)),image:new oo({fill:new St({color:q}),points:3,radius:8,rotation:-S,angle:Math.PI/2})}))}),X.setStyle(ue);var se=new Ze({features:[X]}),pe=new tt({source:se});return pe.kind="approachline",pe.selection=!1,de.push(pe),de.push(pe),K.addLayer(pe),Z.push(pe),pe}function Pe(_,H,q,Z,ne){var X=wi(_,q,H);let ue;Z==At.LEFT?ue=Zt(q+90):ue=Zt(q-90);var we=wi(X,ue,Math.max(f.fwLoiterRadius*4,f.fwApproachLength/2));Me(_,we,"#0025a1",ne),Me(we,X,"#0025a1",ne),Me(X,_,"#f78a05",ne)}function Xe(_,H,q,Z){if(q.getLandHeading1()!=0){let ne=Zt(Math.abs(q.getLandHeading1())+180);Pe({lat:H,lon:_},f.fwApproachLength,ne,q.getApproachDirection(),Z)}if(q.getLandHeading1()>0){let ne=q.getApproachDirection()==At.LEFT?At.RIGHT:At.LEFT;Pe({lat:H,lon:_},f.fwApproachLength,q.getLandHeading1(),ne,Z)}if(q.getLandHeading2()!=0){let ne=Zt(Math.abs(q.getLandHeading2())+180);Pe({lat:H,lon:_},f.fwApproachLength,ne,q.getApproachDirection(),Z)}if(q.getLandHeading2()>0){let ne=q.getApproachDirection()==At.LEFT?At.RIGHT:At.LEFT;Pe({lat:H,lon:_},f.fwApproachLength,q.getLandHeading2(),ne,Z)}}function Ie(_){let H=He([_.getLonMap(),_.getLatMap()]);var q=new Ye({geometry:new ot(H),name:"safehome"});let Z=new Ge({stroke:new et({color:"rgba(144, 12, 63, 0.5)",width:3,lineDash:[10]})}),ne=new Ge({stroke:new et({color:"rgba(136, 204, 62, 1)",width:3,lineDash:[10]})});var X=new tt({source:new Ze({features:[q]}),style:function(ue){let we=[ve(_)];return _.isUsed()&&(Z.setGeometry(new kt(ue.getGeometry().getCoordinates(),_t(f.maxDistSH))),ne.setGeometry(new kt(ue.getGeometry().getCoordinates(),_t(Number(f.safeRadiusSH)))),we.push(ne),we.push(Z)),we}});X.kind="safehome",X.number=_.getNumber(),X.selection=!1,ce.push(X),K.addLayer(X)}function bt(_){let H=He([_.getLonMap(),_.getLatMap()]);var q=new Ye({geometry:new ot(H),name:"safehome"}),Z=new tt({source:new Ze({features:[q]}),style:function(ne){return[ve(_)]}});Z.kind="safehome",Z.number=_.getNumber(),Z.selection=!0,ce.push(Z),K.addLayer(Z)}function _t(_){let H=K.getView().getProjection(),q=K.getView().getResolution(),Z=q/$r(H,q,K.getView().getCenter());return _/no.m*Z}function Wt(_,H){return new Ge({image:new Et({anchor:[.5,1],opacity:1,scale:.5,src:_.getType()==Jt.EXCULSIVE?je.icon_geozone_excl:je.icon_geozone_incl}),text:new Pt({text:String(H+1),font:"12px sans-serif",offsetY:-15,offsetX:-2,fill:new St({color:"#FFFFFF"}),stroke:new et({color:"#FFFFFF"})})})}function Ar(_,H){let q=He([H.getLonMap(),H.getLatMap()]);var Z=new Ye({geometry:new ot(q),name:"geozone"}),ne=new tt({source:new Ze({features:[Z]}),style:function(X){return[Wt(_,_.getShape()==Tt.POLYGON?H.getNumber():_.getNumber())]}});return ne.kind="geozone",ne.number=H.getNumber(),ne.layerNumber=_.getNumber(),ne.selection=!0,Le.push(ne),ne}function Er(_,H,q,Z,ne){var X=new Kt([_,H]),ue=new Ye({geometry:X});ue.setStyle(new Ge({stroke:new et({color:q,width:3}),text:new Pt({text:String(ne+1),font:"14px sans-serif",placement:"line",textBaseline:"ideographic",stroke:new et({color:q})})}));var we=new Ze({features:[ue]}),se=new tt({source:we});se.kind="geozoneline",se.selection=!0,se.number=Z,se.layerNumber=ne,he.push(se),K.addLayer(se)}function br(){Un(),$.GEOZONES.get().forEach(_=>{if(_.getVerticesCount()!=0){if(_.getShape()==Tt.CIRCULAR){var H=new Ye({geometry:new kt(He([_.getFirstVertex().getLonMap(),_.getFirstVertex().getLatMap()]),_t(_.getRadius()/100)),name:"geozoneCircle"}),q=new Ze;q.addFeatures([H]);var Z=new tt({source:q,style:[new Ge({stroke:new et({color:_.getType()==Jt.EXCULSIVE?"#E62121":"#1DBE0A",width:3})})]});Z.kind="geozonecircle",Z.selection=!0,he.push(Z),K.addLayer(Z)}else if(_.getShape()==Tt.POLYGON){var ne=_.getVerticesCount(),X=_.getLastVertex(),ue;for(let we=0;we<ne;we++){ue=_.getVertex(we);let se=He([X.getLonMap(),X.getLatMap()]),pe=He([ue.getLonMap(),ue.getLatMap()]);Er(se,pe,_.getType()==Jt.EXCULSIVE?"#E62121":"#1DBE0A",X.getNumber(),_.getNumber()),X=ue}}}})}function Je(){if(li(),!I){Un(),Xt();return}br(),$.GEOZONES.get().forEach(_=>{_.getVerticesCount()>0&&_.getVertices().forEach(H=>{K.addLayer(Ar(_,H))})}),Xt()}function Un(){he.forEach(_=>{K.removeLayer(_)}),he=[]}function li(){Le.forEach(_=>{K.removeLayer(_)}),Le=[]}function Xt(){if(h){z.length>=1&&Le.length>=1?r("#infoGeozoneMissionWarning").show():r("#infoGeozoneMissionWarning").hide(),r("#geozoneInvalidContent").empty(),u=!1;for(var _=0;_<$.GEOZONES.geozoneCount();_++){const q=$.GEOZONES.at(_);var H=[];q.isCounterClockwise()||H.push(oe.getMessage("gezoneInvalidReasonNotCC")),q.isComplex()&&H.push(oe.getMessage("gezoneInvalidReasonComplex")),q.getMaxAltitude()<=q.getMinAltitude()&&H.push(oe.getMessage("gezoneInvalidReasonMinMaxAlt")),H.length>0&&(r("#geozoneInvalidContent").append(`<div style="display: inline-block">${oe.getMessage("geozone")} ${q.getNumber()+1}: ${H.join(", ")}</div><br/>`),u=!0)}u?r("#infoGeozoneInvalid").show():r("#infoGeozoneInvalid").hide()}}function rt(){r("#availableGeozones").text($.GEOZONES.getMaxZones()-$.GEOZONES.geozoneCount()+"/"+$.GEOZONES.getMaxZones()),r("#availableVertices").text($.GEOZONES.getMaxVertices()-$.GEOZONES.getUsedVerticesCount()+"/"+$.GEOZONES.getMaxVertices())}function _r(){if($.GEOZONES.geozoneCount()+1>$.GEOZONES.getMaxZones()){_e.alert(oe.getMessage("missionGeozoneMaxZonesReached"));return}if($.GEOZONES.getUsedVerticesCount()+2>$.GEOZONES.getMaxVertices()){_e.alert(oe.getMessage("missionGeozoneMaxVerticesReached"));return}let _=K.getView().getCenter(),H=Math.round(Ke(_)[0]*1e7),q=Math.round(Ke(_)[1]*1e7);$.GEOZONES.put(new io(Jt.INCLUSIVE,Tt.CIRCULAR,0,1e4,!1,2e4,ro.NONE,[new xt(0,q,H)])),I=$.GEOZONES.last(),$e(),Je(),rt()}function ui(){r("#missionPlannerHome").hide(),r("#missionPlannerElevation").hide(),Ot()}function Ot(){for(var _ in P)K.removeLayer(P[_]);P=[]}function Vt(){r(".home-lat").val(U.getLatMap()).on("change",function(){U.setLat(Math.round(Number(r(this).val())*1e7)),Ot(),zt()}),r(".home-lon").val(U.getLonMap()).on("change",function(){U.setLon(Math.round(Number(r(this).val())*1e7)),Ot(),zt()}),U.getLatMap()==0&&U.getLonMap()==0?U.setAlt("N/A"):(async()=>{const _=await U.getElevation(qe);r("#elevationValueAtHome").text(_+" m"),U.setAlt(_)})()}function zt(){K.addLayer(Lr(U))}function Lr(_){let H=He([_.getLonMap(),_.getLatMap()]);var q=new Ye({geometry:new ot(H),name:"home"}),Z=new tt({source:new Ze({features:[q]}),style:function(ne){return[Mr()]}});return Z.kind="home",Z.number=_.getNumber(),Z.selection=!1,P.push(Z),Z}function Mr(_){return new Ge({image:new Et({anchor:[.5,1],opacity:1,scale:.5,src:je.icon_home})})}function ci(){Vt(),Ot(),zt()}var vt=0;function wt(){r("#multimissionOptionList").prop("options").length=1;for(var _=1;_<=c;_++)r("#multimissionOptionList").append(r("<option>",{value:_,text:_}));pt(),r("#activeNissionIndex").text(1)}function pt(){if(pi(!1),!k.isEmpty()||c)if((!c||c&&!k.isEmpty())&&c<a?r("#addMultimissionButton").removeClass("disabled"):r("#addMultimissionButton").addClass("disabled"),c){let _;Ne()?(_=Fe.get().length+k.get().length,r("#updateMultimissionButton").removeClass("disabled"),r("#setActiveMissionButton").removeClass("disabled"),r("#missionPlannerElevation").show()):(r("#missionDistance").text("N/A"),_=k.get().length,r("#editMission").show(),r("#updateMultimissionButton").addClass("disabled"),r("#setActiveMissionButton").addClass("disabled"),r("#missionPlannerElevation").hide(),pi(!0)),r("#multimissionInfo").text(c+" missions ("+_+"/"+k.getMaxWaypoints()+" WPs)"),document.getElementById("multimissionInfo").style.color=_>k.getMaxWaypoints()?"#FF0000":"#303030"}else r("#cancelMultimission").trigger("click"),r("#multimissionInfo").text("No multi missions loaded"),r("#updateMultimissionButton").addClass("disabled"),r("#setActiveMissionButton").addClass("disabled");else r("#addMultimissionButton").addClass("disabled"),r("#setActiveMissionButton").addClass("disabled");ht()}function Ne(){return!c||Number(r("#multimissionOptionList").val())}function It(_=!1,H=!1){let q=!!k.isEmpty();var Z=vt;_||k.get().forEach(function(ne){Fe.get().splice(Z,0,ne),Z++}),Z=0,Fe.get().forEach(function(ne){ne.setNumber(Z),Z++}),Fe.update(!1),!H&&(k.reinit(),k.copy(Fe),k.update(!1),q&&(c-=c==2?2:1,c||(c=0,Fe.flush()),wt()),V=null,ge(),qt(14),Ve(),ht())}function xr(){var _=0,H=0,q=!1;vt=0,k.get().forEach(function(X){X.getEndMission()==165&&!q&&(_++,H=X.getNumber(),_==Number(r("#multimissionOptionList").val())?q=!0:vt=H+1)}),k.reinit();var Z=Fe.get().slice(vt,H+1);let ne=0;Z.forEach(function(X){k.put(X),k.get()[ne].setNumber(ne),ne++}),k.setMaxWaypoints(Fe.getMaxWaypoints()),Fe.get().splice(vt,H-vt+1),k.update(),pt(),V=null,ge(),qt(14),Ve(),ht()}function Tr(_){let H=1;k.get().forEach(function(q){q.getEndMission()==165&&q.getNumber()<_&&H++}),r("#multimissionOptionList").val(H).trigger("change")}function Pr(){It(!0),c-=c==2?2:1,c||Fe.flush(),wt()}function Sr(){(Ne()||!c)&&It(!1,!0),c+=c?1:2,wt(),r("#multimissionOptionList").val(c),Dt(),vt=Fe.get().length,pt()}function Nr(){if(c){if(Ne())return Pr(),!1}else return!0;return c=0,Fe.flush(),wt(),!0}function Or(){if(Ne())return!0;if(_e.confirm(oe.getMessage("confirm_overwrite_multimission_file_load_option"))){var _={filters:[{name:"Mission file",extensions:["mission"]}]};_e.showOpenDialog(_).then(H=>{if(H.canceled){console.log("No file selected");return}H.filePaths.length==1&&(di(H.filePaths[0]),c=0,Fe.flush(),wt())})}return!1}function pi(_=!0){me=_,r("*","#MPeditPoint").prop("disabled",_),_?(r("#addOptionsPointButton").addClass("disabled"),r("#removePointButton").addClass("disabled"),r("#waypointOptionsTableBody").fadeOut()):(r("#addOptionsPointButton").removeClass("disabled"),r("#removePointButton").removeClass("disabled"),r("#waypointOptionsTableBody").fadeIn())}function Dt(){k.reinit(),Ve(),ge(),ht(),Se()}function Ir(_,H=!1){let q=He([_.getLonMap(),_.getLatMap()]);var Z=new Ye({geometry:new ot(q),name:"Null Island",population:4e3,rainfall:500});Z.setStyle(dt(_,H));var ne=new Ze({features:[Z]}),X=new tt({source:ne});return X.kind="waypoint",X.number=_.getNumber(),X.layerNumber=_.getLayerNumber(),z.push(X),X}function dt(_,H){var q={1:"WP",2:"PH",3:"PH",5:"POI",8:"LDG"};return new Ge({image:new Et({anchor:[.5,1],opacity:1,scale:.5,src:je["icon_position"+(q[_.getAction()]!=""?"_"+q[_.getAction()]:"")+(H?"_edit":"")]}),text:new Pt({text:String(Number(_.getLayerNumber()+1)),font:"12px sans-serif",offsetY:-15,offsetX:-2,fill:new St({color:"#FFFFFF"}),stroke:new et({color:"#FFFFFF"})})})}function kn(_){let H,q=[],Z,ne=0,X=!1,ue=!1;r("#missionDistance").text(0),Gt(),_.get().forEach(function(se){if(se.isAttached()){if(se.isAttached()){if(se.getAction()==le.WPTYPE.JUMP){let pe=ne+se.getP1(),Q=He([_.getWaypoint(pe).getLonMap(),_.getWaypoint(pe).getLatMap()]);Ct(H,Q,se.getNumber(),"#e935d6",5,"Repeat x"+(se.getP2()==-1?" infinite":String(se.getP2())),!1,!0)}else se.getAction()==le.WPTYPE.SET_HEAD&&(se.getP1()==-1?(X=!1,ue=!1,Z="undefined"):typeof se.getP1()<"u"&&se.getP1()!=-1&&(X=!1,ue=!0,Z=String(se.getP1())));se.getEndMission()==165&&(H="undefined",X=!1,ue=!1,ne=se.getNumber()+1)}}else{let pe=He([se.getLonMap(),se.getLatMap()]);se.getAction()==5?(q.push(se.getNumber()),X=!0,ue=!1):(typeof H<"u"&&X!=!0&&ue!=!0?Ct(H,pe,se.getNumber()):typeof H<"u"&&X==!0&&ue!=!0?q.length%2==0?Ct(H,pe,se.getNumber(),"#ffb725",5):Ct(H,pe,se.getNumber(),"#ffb725"):typeof H<"u"&&X!=!0&&ue==!0&&Ct(H,pe,se.getNumber(),"#1497f1",0,String(Z)+""),se.getEndMission()==165?(H="undefined",X=!1,ue=!1,ne=se.getNumber()+1):H=pe)}se.getAction()==le.WPTYPE.LAND&&Xe(se.getLonMap(),se.getLatMap(),$.FW_APPROACH.get()[$.SAFEHOMES.getMaxSafehomeCount()+se.getMultiMissionIdx()],J)}),A&&A.setCoordinates(K.getCoordinateFromPixel([0,0]));let we=_.getDistance(!0);me?r("#missionDistance").text("N/A"):we.length>=1?r("#missionDistance").text(we[we.length-1].toFixed(1)):r("#missionDistance").text("infinite")}function Ct(_,H,q,Z="#1497f1",ne=0,X="",ue=!0,we=!1){var se=new Kt([_,H]),pe=new Ye({geometry:se});if(pe.setStyle(new Ge({stroke:new et({color:Z,width:3,lineDash:[ne]}),text:new Pt({text:X,font:"14px sans-serif",placement:"line",textBaseline:"ideographic",stroke:new et({color:Z})})})),we){let Ae=H[0]-_[0],S=H[1]-_[1],R=Math.atan2(Ae,S);var Q=new Ye({geometry:new ot([_[0]+Ae/2,_[1]+S/2])});Q.setStyle(new Ge({image:new Et({src:je.icon_arrow,scale:.3,anchor:[.5,.5],rotateWithView:!0,rotation:R})}))}if(we)var ye=new Ze({features:[pe,Q]});else var ye=new Ze({features:[pe]});var De=new tt({source:ye});De.kind="line",De.selection=ue,De.number=q,J.push(De),K.addLayer(De)}function Ve(){Dr(),Wn()}function Dr(){for(var _ in J)K.removeLayer(J[_]);J=[];for(var _ in z)K.removeLayer(z[_]);z=[]}function Gt(){for(var _ in J)K.removeLayer(J[_]);J=[]}function Wn(){k.isEmpty()||(kn(k),k.get().forEach(function(_){_.isAttached()||K.addLayer(Ir(_))})),E||Xt()}function Qe(){kn(k),Te&&V&&Te.setStyle(dt(V,!0))}function ft(){L&&ie?(it=!0,r("#missionPlannerSafehome").is(":visible")||r("#missionPlannerSafehome").fadeIn(300),r("#SafehomeContentBox").show(),ie.getLandHeading1()==0&&ie.getLandHeading1()==0&&ie.getApproachAltAsl()==0&&ie.getLandAltAsl()==0&&(ie.setApproachAltAsl(f.fwApproachAlt*100),ie.setLandAltAsl(f.fwLandAlt*100)),ie.getElevation()==0&&(async()=>{const H=await ie.getElevationFromServer(L.getLonMap(),L.getLatMap(),qe)*100;ie.setElevation(H),r("#safehomeElevation").text(ie.getElevation()/100+" m")})(),D.find(".missionPlannerSafehomeBox:last-child").find(".spacer_box_title").text(oe.getMessage("safehomeEdit")+" "+(L.getNumber()+1)),r("#safehomeLatitude").val(L.getLatMap()),r("#safehomeLongitude").val(L.getLonMap()),Ue(r("#safehomeSeaLevelRef"),ie.getIsSeaLevelRef()),r("#safehomeApproachAlt").val(ie.getApproachAltAsl()),r("#safehomeLandAlt").val(ie.getLandAltAsl()),r("#geozoneApproachDirection").val(ie.getApproachDirection()),r("#safehomeLandHeading1").val(Math.abs(ie.getLandHeading1())),Ue(r("#safehomeLandHeading1Excl"),ie.getLandHeading1()<0),r("#safehomeLandHeading2").val(Math.abs(ie.getLandHeading2())),Ue(r("#safehomeLandHeading2Excl"),ie.getLandHeading2()<0),r("#safehomeLandAltM").text(ie.getLandAltAsl()/100+" m"),r("#safehomeApproachAltM").text(ie.getApproachAltAsl()/100+" m"),it=!1):r("#SafehomeContentBox").hide()}function $e(){if(I){r("#missionPlannerGeozones").is(":visible")||r("#missionPlannerGeozones").fadeIn(300),r("#geozoneContentBox").show(),T.find(".missionPlannerGeozone:last-child").find(".spacer_box_title").text(oe.getMessage("missionGeozoneEdit",I.getNumber()+1)),r("#geozoneShape").val(I.getShape()),r("#geozoneType").val(I.getType()),r("#geozoneMinAlt").val(I.getMinAltitude()),r("#geozoneMaxAlt").val(I.getMaxAltitude()),r("#geozoneMinAltM").text(I.getMinAltitude()/100+" m"),r("#geozoneMaxAltM").text(I.getMaxAltitude()/100+" m"),Ue(r("#geozoneSeaLevelRef"),I.getSealevelRef()),r("#geozoneAction").val(I.getFenceAction()),r("#geozoneRadius").val(I.getRadius),I.getShape()==Tt.CIRCULAR?r("#geozoneRadius").prop("disabled",!1):r("#geozoneRadius").prop("disabled",!0);let H=r("#geozoneVerticesTableBody");H.empty(),I.getVertices().forEach(q=>{H.append('                    <tr>                         <td>                             <div class="btnTable btnTableIcon">                                 <a class="ic_removeAll" id="removeVertex" href="#"  title="Remove"></a>                             </div>                        </td>                         <td>                             <span class="vertexNumber"></span>                         </td>                         <td>                             <input type="number" step="0.0000001" class="vertexLat"/>                         </td>                         <td>                             <input type="number" step="0.0000001" class="vertexLon"/>                         </td>                     </tr>                 ');const Z=H.find("tr:last");Z.find(".vertexNumber").text(q.getNumber()+1),Z.find(".vertexLat").val(q.getLatMap().toLocaleString(["en-US"],{minimumFractionDigits:7})).on("change",ne=>{const X=r(ne.currentTarget).val();if(isNaN(X)||X<-90||X>90){_e.alert(oe.getMessage("geozoneInvalidLat")),r(ne.currentTarget).val(q.getLatMap());return}q.setLat(X*1e7),$e(),Je(),rt()}),Z.find(".vertexLon").val(q.getLonMap().toLocaleString(["en-US"],{minimumFractionDigits:7})).on("change",ne=>{const X=r(ne.currentTarget).val();if(isNaN(X)||X<-180||X>180){_e.alert(oe.getMessage("geozoneInvalidLon")),r(ne.currentTarget).val(q.getLonMap());return}q.setLon(X*1e7),$e(),Je(),rt()}),Z.find("#removeVertex").on("click",ne=>{I.getVerticesCount()>3&&(I.dropVertex(q.getNumber()),$e(),Je(),rt())})}),Xt()}else r("#geozoneContentBox").hide()}function Xn(_){return F.empty(),k.getAttachedFromWaypoint(_).forEach(function(H){F.append('                <tr>                <td><div id="deleteOptionsPoint" class="btnTable btnTableIcon btnTable-danger">                         <a class="ic_cancel" data-role="waypointOptions-delete" href="#" style="float: center" title="Delete"></a>                     </div>                </td>                 <td><span class="waypointOptions-number"/></td>                <td><select class="waypointOptions-action"></select></td>                <td><input type="number" class="waypointOptions-p1" /></td>                <td><input type="number" class="waypointOptions-p2" /></td>                </tr>            ');const q=F.find("tr:last");for(var Z=1;Z<=3;Z++)ut[H.getAction()]["parameter"+String(Z)]!=""?(q.find(".waypointOptions-p"+String(Z)).prop("disabled",!1),q.find(".waypointOptions-p"+String(Z)).prop("title",ut[H.getAction()]["parameter"+String(Z)])):(q.find(".waypointOptions-p"+String(Z)).prop("disabled",!0),q.find(".waypointOptions-p"+String(Z)).prop("title",""));Ee.fillSelect(q.find(".waypointOptions-action"),Nt,Nt.indexOf(le.WPTYPE.REV[H.getAction()])),q.find(".waypointOptions-action").val(Nt.indexOf(le.WPTYPE.REV[H.getAction()])).on("change",function(){H.setAction(le.WPTYPE[Nt[r(this).val()]]);let ne=0;(Nt[r(this).val()]=="JUMP"||Nt[r(this).val()]=="RTH"&&!E&&$.isMultirotor())&&(ne=1),q.find(".waypointOptions-p1").val(ne),H.setP1(ne);for(var X=1;X<=3;X++)ut[H.getAction()]["parameter"+String(X)]!=""?(q.find(".waypointOptions-p"+String(X)).prop("disabled",!1),q.find(".waypointOptions-p"+String(X)).prop("title",ut[H.getAction()]["parameter"+String(X)])):(q.find(".waypointOptions-p"+String(X)).prop("disabled",!0),q.find(".waypointOptions-p"+String(X)).prop("title",""));k.updateWaypoint(H),Gt(),Qe()}),q.find(".waypointOptions-number").text(H.getAttachedNumber()+1),q.find(".waypointOptions-p1").val(le.WPTYPE.REV[H.getAction()]=="JUMP"?k.convertWaypointToJumpNumber(H.getP1())+1:H.getP1()).on("change",function(){le.WPTYPE.REV[H.getAction()]=="SET_HEAD"?(r(this).val()>=360||r(this).val()<0&&r(this).val()!=-1)&&(r(this).val(-1),_e.alert(oe.getMessage("MissionPlannerHeadSettingsCheck"))):le.WPTYPE.REV[H.getAction()]=="RTH"?r(this).val()!=0&&r(this).val()!=1&&(r(this).val(0),_e.alert(oe.getMessage("MissionPlannerRTHSettingsCheck"))):le.WPTYPE.REV[H.getAction()]=="JUMP"&&(r(this).val()>k.getNonAttachedList().length||r(this).val()<1?(r(this).val(1),Ee.alert(oe.getMessage("MissionPlannerJumpSettingsCheck"))):k.getPoiList().length!=0&&k.getPoiList()&&k.getPoiList().includes(k.convertJumpNumberToWaypoint(Number(r(this).val())-1))&&(r(this).val(1),_e.alert(oe.getMessage("MissionPlannerJump3SettingsCheck")))),H.setP1(le.WPTYPE.REV[H.getAction()]=="JUMP"?k.convertJumpNumberToWaypoint(Number(r(this).val())-1):Number(r(this).val())),k.updateWaypoint(H),Gt(),Qe()}),q.find(".waypointOptions-p2").val(H.getP2()).on("change",function(){le.WPTYPE.REV[H.getAction()]=="JUMP"&&(r(this).val()>10||r(this).val()<0&&r(this).val()!=-1)&&(r(this).val(0),_e.alert(oe.getMessage("MissionPlannerJump2SettingsCheck"))),H.setP2(Number(r(this).val())),k.updateWaypoint(H),Gt(),Qe()}),q.find("[data-role='waypointOptions-delete']").attr("data-index",H.getAttachedNumber()+1)}),Ee.switchery(),oe.localize(),_}function qt(_){var H=He([k.getWaypoint(0).getLonMap(),k.getWaypoint(0).getLatMap()]);K.getView().setCenter(H),K.getView().setZoom(_)}function Cr(){var _={};class H extends to{constructor(){super({handleDownEvent:R=>_.handleDownEvent(R),handleDragEvent:R=>_.handleDragEvent(R),handleMoveEvent:R=>_.handleMoveEvent(R),handleUpEvent:R=>_.handleUpEvent(R)}),this.coordinate_=null,this.cursor_="pointer",this.feature_=null,this.previousCursor_=void 0}}_.ConvertCentimetersToMeters=function(S){return parseInt(S)/100};class q extends Ht{constructor(R){var te=R||{},ee=document.createElement("button");ee.innerHTML=" ",ee.style=`background: url("${je.settings_white}") no-repeat 1px -1px;background-color: rgba(0,60,136,.5);`;var xe=function(){r("#missionPlannerSettings").fadeIn(300)};ee.addEventListener("click",xe,!1),ee.addEventListener("touchstart",xe,!1);var ae=document.createElement("div");ae.className="mission-control-settings ol-unselectable ol-control",ae.appendChild(ee),ae.title="MP Settings",super({element:ae,target:te.target})}}class Z extends Ht{constructor(R){var te=R||{},ee=document.createElement("button");ee.innerHTML=" ",ee.style=`background: url("${je.icon_safehome_white}") no-repeat 1px -1px;background-color: rgba(0,60,136,.5);`;var xe=function(){r("#missionPlannerSafehome").fadeIn(300),j(),G(),r("#safeHomeMaxDistance").text(f.maxDistSH),r("#SafeHomeSafeDistance").text(f.safeRadiusSH)};ee.addEventListener("click",xe,!1),ee.addEventListener("touchstart",xe,!1);var ae=document.createElement("div");ae.className="mission-control-safehome ol-unselectable ol-control",ae.appendChild(ee),ae.title="MP Safehome",super({element:ae,target:te.target})}}class ne extends Ht{constructor(R){var te=R||{},ee=document.createElement("button");ee.innerHTML=" ",ee.style=`background: url("${je.icon_geozone_white}") no-repeat 1px -1px;background-color: rgba(0,60,136,.5);`;var xe=function(){r("#missionPlannerGeozones").fadeIn(300),I||(I=$.GEOZONES.first()),$e(),Je()};ee.addEventListener("click",xe,!1),ee.addEventListener("touchstart",xe,!1);var ae=document.createElement("div");ae.className="geozone-settings ol-unselectable ol-control",ae.appendChild(ee),ae.title="Geozone",super({element:ae,target:te.target})}}class X extends Ht{constructor(R){var te=R||{},ee=document.createElement("button");ee.innerHTML=" ",ee.style=`background: url("${je.icon_elevation_white}") no-repeat 1px -1px;background-color: rgba(0,60,136,.5);`;var xe=function(){r("#missionPlannerHome").fadeIn(300),Ot(),Vt(),zt(),r("#missionPlannerElevation").fadeIn(300)};ee.addEventListener("click",xe,!1),ee.addEventListener("touchstart",xe,!1);var ae=document.createElement("div");ae.className="mission-control-elevation ol-unselectable ol-control",ae.appendChild(ee),ae.title="MP Elevation",super({element:ae,target:te.target})}}class ue extends Ht{constructor(R){var te=R||{},ee=document.createElement("button");ee.innerHTML=" ",ee.style=`background: url("${je.icon_multimission_white}") no-repeat 1px -1px;background-color: rgba(0,60,136,.5);`;var xe=function(){r("#missionPlannerMultiMission").fadeIn(300)};ee.addEventListener("click",xe,!1),ee.addEventListener("touchstart",xe,!1);var ae=document.createElement("div");ae.className="mission-control-multimission ol-unselectable ol-control",ae.appendChild(ee),ae.title="MP MultiMission",super({element:ae,target:te.target})}}_.handleDownEvent=function(S){if(me)return!1;var R=S.map,te=R.forEachFeatureAtPixel(S.pixel,function(ee,xe){return ee});return re=R.forEachFeatureAtPixel(S.pixel,function(ee,xe){return xe}),te&&(this.coordinate_=S.coordinate,this.feature_=te,this.layer_=re),!!te},_.handleDragEvent=function(S){if(re.kind=="safehomecircle"||re.kind=="geozonecircle")return;var R=S.map;R.forEachFeatureAtPixel(S.pixel,function(fe,Oe){return fe});var te=S.coordinate[0]-this.coordinate_[0],ee=S.coordinate[1]-this.coordinate_[1],xe=this.feature_.getGeometry();(re.kind=="waypoint"||re.kind=="safehome"||re.kind=="home"||re.kind=="geozone")&&(xe.translate(te,ee),this.coordinate_[0]=S.coordinate[0],this.coordinate_[1]=S.coordinate[1]);let ae=Ke(xe.getCoordinates());if(re.kind=="waypoint"){let fe=k.getWaypoint(re.number);fe.setLon(Math.round(ae[0]*1e7)),fe.setLat(Math.round(ae[1]*1e7)),V!=null&&re.number==V.getLayerNumber()&&(r("#pointLon").val(Math.round(ae[0]*1e7)/1e7),r("#pointLat").val(Math.round(ae[1]*1e7)/1e7)),k.updateWaypoint(fe),kn(k)}else if(re.kind=="safehome"){let fe=$.SAFEHOMES.get()[re.number];fe.setLon(Math.round(ae[0]*1e7)),fe.setLat(Math.round(ae[1]*1e7)),r("#safeHomeLongitude").val(Math.round(ae[0]*1e7)),r("#safeHomeLatitude").val(Math.round(ae[1]*1e7)),Lt(re.number),ft(),j(),G()}else if(re.kind=="home")U.setLon(Math.round(ae[0]*1e7)),U.setLat(Math.round(ae[1]*1e7)),r(".home-lon").val(Math.round(ae[0]*1e7)/1e7),r(".home-lat").val(Math.round(ae[1]*1e7)/1e7);else if(re.kind=="geozone"){let fe=$.GEOZONES.at(re.layerNumber).getVertex(re.number);fe.setLon(Math.round(ae[0]*1e7)),fe.setLat(Math.round(ae[1]*1e7));let Oe=r(T.find(".missionPlannerGeozone").get(re.layerNumber)).find("#geozoneVerticesTableBody");Oe.find("tr:nth-child("+String(re.number+1)+") > td > .vertexLon").val(Math.round(ae[0]*1e7)/1e7),Oe.find("tr:nth-child("+String(re.number+1)+") > td > .vertexLat").val(Math.round(ae[1]*1e7)/1e7),I=$.GEOZONES.at(re.layerNumber),$e(),Je(),rt()}},_.handleMoveEvent=function(S){if(this.cursor_){var R=S.map,te=R.forEachFeatureAtPixel(S.pixel,function(xe,ae){return xe}),ee=S.map.getTargetElement();te&&te.name!="circleFeature"&&te.name!="circleSafeFeature"?ee.style.cursor!=this.cursor_&&(this.previousCursor_=ee.style.cursor,ee.style.cursor=this.cursor_):this.previousCursor_!==void 0&&(ee.style.cursor=this.previousCursor_,this.previousCursor_=void 0)}},_.handleUpEvent=function(S){return re.kind=="waypoint"?V!=null&&re.number==V.getLayerNumber()&&(async()=>{const R=await k.getWaypoint(re.number).getElevation(qe);r("#elevationValueAtWP").text(R);const te=Mt(!1,k.getWaypoint(re.number).getAlt(),R,k.getWaypoint(re.number).getP3());if(k.getWaypoint(re.number).setAlt(te),k.getWaypoint(re.number).getAction()==le.WPTYPE.LAND){let ee=$.FW_APPROACH.get()[$.SAFEHOMES.getMaxSafehomeCount()+k.getWaypoint(re.number).getMultiMissionIdx()];ee.getIsSeaLevelRef()&&(ee.getElevation()!=0&&(ee.setApproachAltAsl(ee.getApproachAltAsl()-ee.getElevation()+R*100),ee.setLandAltAsl(ee.getLandAltAsl()-ee.getElevation()+R*100)),ee.setElevation(R*100),r("#wpApproachAlt").val(ee.getApproachAltAsl()),r("#wpLandAlt").val(ee.getLandAltAsl),r("#wpLandAltM").text(ee.getLandAltAsl()/100+" m"),r("#wpApproachAltM").text(ee.getApproachAltAsl()/100+" m"))}})():re.kind=="home"?(async()=>{const R=await U.getElevation(qe);r("#elevationValueAtHome").text(R+" m"),U.setAlt(R)})():re.kind=="safehome"&&(async()=>{let R=$.FW_APPROACH.get()[re.number],te=$.SAFEHOMES.get()[re.number];const ee=await R.getElevationFromServer(te.getLonMap(),te.getLatMap(),qe)*100;r("#safehomeElevation").text(ee/100+" m"),R.getIsSeaLevelRef()&&(R.getElevation()!=0&&(R.setApproachAltAsl(R.getApproachAltAsl()-R.getElevation()+ee),R.setLandAltAsl(R.getLandAltAsl()-R.getElevation()+ee)),R.setElevation(ee)),ft()})(),this.coordinate_=null,this.feature_=null,!1};var we=$.GPS_DATA?$.GPS_DATA.lat/1e7:0,se=$.GPS_DATA?$.GPS_DATA.lon/1e7:0;let pe=[],Q;qe.mapProviderType=="esri"?(pe.push(new Bt({source:new Vn({url:"https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",attributions:'Source: <a href="https://www.esri.com/" target="_blank">Esri</a>, Maxar, Earthstar Geographics, and the GIS User Community',maxZoom:19})})),pe.push(new Bt({source:new Vn({url:"https://services.arcgisonline.com/arcgis/rest/services/Reference/World_Transportation/MapServer/tile/{z}/{y}/{x}",maxZoom:19})})),pe.push(new Bt({source:new Vn({url:"https://services.arcgisonline.com/arcgis/rest/services/Reference/World_Boundaries_and_Places/MapServer/tile/{z}/{y}/{x}",maxZoom:19})}))):qe.mapProviderType=="mapproxy"?pe.push(new Bt({source:new ao({url:qe.proxyURL,params:{LAYERS:qe.proxyLayer}})})):pe.push(new Bt({source:new Yr})),jt.connectionValid?(Q=[new q,new ue,new Z,new X],h&&Q.push(new ne)):Q=[new q,new ue,new X],K=new Zr({controls:Qr({attributionOptions:{collapsible:!1}}).extend(Q),interactions:Jr().extend([new H]),layers:pe,target:"missionMap",view:new Kr({center:He([se,we]),zoom:2})}),setTimeout(function(){r(".ol-attribution a").attr("target","_blank")},100),K.on("moveend",function(S){Yt.storeSet("missionPlannerLastValues",{center:Ke(K.getView().getCenter()),zoom:K.getView().getZoom()})});const ye=Yt.storeGet("missionPlannerLastValues",!1);ye&&ye.zoom&&ye.center&&(K.getView().setCenter(He(ye.center)),K.getView().setZoom(ye.zoom)),K.on("click",function(S){var R=null;if(V!=null&&Te!=null){R=V.getLayerNumber();try{Te.setStyle(dt(V,!1)),V=null,Te=null,re=null,ge()}catch(fe){console.log(fe),Ee.log(oe.getMessage("notAWAYPOINT"))}}if(Te=K.forEachFeatureAtPixel(S.pixel,function(fe,Oe){return fe}),re=K.forEachFeatureAtPixel(S.pixel,function(fe,Oe){return Oe}),Te&&re.kind=="waypoint"){r("#editMission").hide(),V=k.getWaypoint(re.number),Y=$.FW_APPROACH.get()[$.SAFEHOMES.getMaxSafehomeCount()+V.getMultiMissionIdx()],Y.getLandHeading1()==0&&Y.getLandHeading1()==0&&Y.getApproachAltAsl()==0&&Y.getLandAltAsl()==0&&(Y.setApproachAltAsl(f.fwApproachAlt*100),Y.setLandAltAsl(f.fwLandAlt*100));var te=Te.getGeometry(),ee=Ke(te.getCoordinates());Te.setStyle(dt(V,!0));let fe=V.getP3();Ue(r("#pointP3Alt"),Re.mission_control.isBitSet(fe,le.P3.ALT_TYPE)),Ue(r("#pointP3UserAction1"),Re.mission_control.isBitSet(fe,le.P3.USER_ACTION_1)),Ue(r("#pointP3UserAction2"),Re.mission_control.isBitSet(fe,le.P3.USER_ACTION_2)),Ue(r("#pointP3UserAction3"),Re.mission_control.isBitSet(fe,le.P3.USER_ACTION_3)),Ue(r("#pointP3UserAction4"),Re.mission_control.isBitSet(fe,le.P3.USER_ACTION_4));var xe=_.ConvertCentimetersToMeters(V.getAlt());V.getAction()==le.WPTYPE.LAND?r("#wpFwLanding").fadeIn(300):r("#wpFwLanding").fadeOut(300),(R==null||R!=V.getLayerNumber())&&(async()=>{const Oe=await V.getElevation(qe);r("#elevationValueAtWP").text(Oe);const Ft=Mt(!1,V.getAlt(),Oe,fe);V.setAlt(Ft),Y.setIsSeaLevelRef(Re.mission_control.isBitSet(fe,le.P3.ALT_TYPE)?1:0),r("#wpApproachAlt").val(Y.getApproachAltAsl()),r("#wpLandAlt").val(Y.getLandAltAsl),r("#wpLandAltM").text(Y.getLandAltAsl()/100+" m"),r("#wpApproachAltM").text(Y.getApproachAltAsl()/100+" m")})(),r("#elevationAtWP").fadeIn(),r("#groundClearanceAtWP").fadeIn(),r("#altitudeInMeters").text(` ${xe}m`),r("#pointLon").val(Math.round(ee[0]*1e7)/1e7),r("#pointLat").val(Math.round(ee[1]*1e7)/1e7),r("#pointAlt").val(V.getAlt()),r("#pointType").val(V.getAction()),r("#pointP1").val(V.getP1()),r("#pointP2").val(V.getP2()),r("#wpApproachDirection").val(Y.getApproachDirection()),r("#wpLandHeading1").val(Math.abs(Y.getLandHeading1())),Ue(r("#wpLandHeading1Excl"),Y.getLandHeading1()<0),r("#wpLandHeading2").val(Math.abs(Y.getLandHeading2())),Ue(r("#wpLandHeading2Excl"),Y.getLandHeading2()<0),r("#wpApproachDirection").val(Y.getApproachDirection()),r("#wpLandHeading1").val(Math.abs(Y.getLandHeading1())),Ue(r("#wpLandHeading1Excl"),Y.getLandHeading1()<0),r("#wpLandHeading2").val(Math.abs(Y.getLandHeading2())),Ue(r("#wpLandHeading2Excl"),Y.getLandHeading2()<0);for(var ae in ut[V.getAction()])ut[V.getAction()][ae]!=""?(r("#pointP"+String(ae).slice(-1)+"class").fadeIn(300),r("label[for=pointP"+String(ae).slice(-1)+"]").html(ut[V.getAction()][ae])):r("#pointP"+String(ae).slice(-1)+"class").fadeOut(300);V=Xn(V),r("#EditPointNumber").text("Edit point "+String(V.getLayerNumber()+1)),r("#MPeditPoint").fadeIn(300),r("#pointP3UserActionClass").fadeIn(),Qe()}else if(Te&&re.kind=="line"&&re.selection&&!me){let fe=Ke(S.coordinate),Oe=new $t(re.number,le.WPTYPE.WAYPOINT,Math.round(fe[1]*1e7),Math.round(fe[0]*1e7),Number(f.alt),Number(f.speed));Oe.setMultiMissionIdx(k.getWaypoint(0).getMultiMissionIdx()),P.length&&U.getAlt()!="N/A"?(async()=>{const Ft=await Oe.getElevation(qe);Oe.setAlt(Mt(!1,f.alt,Ft,!1)),k.insertWaypoint(Oe,re.number),k.update(Ne()),Ve()})():(k.insertWaypoint(Oe,re.number),k.update(Ne()),Ve())}else if(Te&&re.kind=="safehome"&&re.selection)Lt(re.number);else if(Te&&re.kind=="home"&&re.selection){V=U;var te=Te.getGeometry(),ee=Ke(te.getCoordinates());r(".home-lon").val(Math.round(ee[0]*1e7)/1e7),r(".home-lat").val(Math.round(ee[1]*1e7)/1e7)}else if(Te&&re.kind=="geozone"&&re.selection)I=$.GEOZONES.at(re.layerNumber),$e();else if(Te&&re.kind=="geozoneline"&&re.selection){if($.GEOZONES.getUsedVerticesCount()+1>$.GEOZONES.getMaxVertices()){_e.alert(oe.getMessage("missionGeozoneMaxVerticesReached"));return}let fe=Ke(S.coordinate),Oe=new xt(re.number+1,Math.round(fe[1]*1e7),Math.round(fe[0]*1e7));$.GEOZONES.at(re.layerNumber).insertVertex(re.number+1,Oe),I=$.GEOZONES.at(re.layerNumber),$e(),Je(),rt()}else if(!me){let fe=Ke(S.coordinate),Oe=new $t(k.get().length,le.WPTYPE.WAYPOINT,Math.round(fe[1]*1e7),Math.round(fe[0]*1e7),Number(f.alt),Number(f.speed));k.get().length==0?(Oe.setMultiMissionIdx(c==0?0:c-1),$.FW_APPROACH.clean($.SAFEHOMES.getMaxSafehomeCount()+Oe.getMultiMissionIdx())):Oe.setMultiMissionIdx(k.getWaypoint(k.get().length-1).getMultiMissionIdx()),P.length&&U.getAlt()!="N/A"?(async()=>{const Ft=await Oe.getElevation(qe);Oe.setAlt(Mt(!1,f.alt,Ft,!1)),k.put(Oe),k.update(Ne()),Ve()})():(k.put(Oe),k.update(Ne()),Ve())}pt()}),r(K.getViewport()).on("mousemove",function(S){var R=K.getEventPixel(S.originalEvent),te="",ee=K.forEachFeatureAtPixel(R,function(xe,ae){return xe&&(te=xe.getProperties().name),!0});ee&&te!="safehomeDist"&&te!="safehomeSafe"&&te!="geozoneCircle"?K.getTargetElement().style.cursor="pointer":K.getTargetElement().style.cursor=""}),setInterval(function(){let S=r("#missionMap canvas").width(),R=r("#missionMap canvas").height();(K.width_!=S||K.height_!=R)&&K.updateSize(),K.width_=S,K.height_=R},200),r("#pointAlt").on("keyup",()=>{let S=_.ConvertCentimetersToMeters(r("#pointAlt").val());r("#altitudeInMeters").text(` ${S}m`)}),r("#showHideActionButton").on("click",function(){var S=r(this).children().attr("class")==="ic_hide"?"ic_show":"ic_hide";r(this).children().attr("class",S),r(this).children().attr("class")==="ic_hide"?r("#ActionContent").fadeIn(300):r("#ActionContent").fadeOut(300)}),r("#showHideInfoButton").on("click",function(){var S=r(this).children().attr("class")==="ic_hide"?"ic_show":"ic_hide";r(this).children().attr("class",S),r(this).children().attr("class")==="ic_hide"?r("#InfoContent").fadeIn(300):r("#InfoContent").fadeOut(300)}),r("#showHideSafehomeButton").on("click",function(){var S=r(this).children().attr("class")==="ic_hide"?"ic_show":"ic_hide";r(this).children().attr("class",S),r(this).children().attr("class")==="ic_hide"?r("#SafehomeContent").fadeIn(300):r("#SafehomeContent").fadeOut(300)}),r("#showHideHomeButton").on("click",function(){var S=r(this).children().attr("class")==="ic_hide"?"ic_show":"ic_hide";r(this).children().attr("class",S),r(this).children().attr("class")==="ic_hide"?r("#HomeContent").fadeIn(300):r("#HomeContent").fadeOut(300)}),r("#showHideWPeditButton").on("click",function(){var S=r(this).children().attr("class")==="ic_hide"?"ic_show":"ic_hide";r(this).children().attr("class",S),r(this).children().attr("class")==="ic_hide"?r("#WPeditContent").fadeIn(300):r("#WPeditContent").fadeOut(300)}),r("#showHideMultimissionButton").on("click",function(){var S=r(this).children().attr("class")==="ic_hide"?"ic_show":"ic_hide";r(this).children().attr("class",S),r(this).children().attr("class")==="ic_hide"?r("#multimissionContent").fadeIn(300):r("#multimissionContent").fadeOut(300)}),r("#showHideGeozonesButton").on("click",function(){var S=r(this).children().attr("class")==="ic_hide"?"ic_show":"ic_hide";r(this).children().attr("class",S),r(this).children().attr("class")==="ic_hide"?r("#geozoneContent").fadeIn(300):r("#geozoneContent").fadeOut(300)}),r("#pointType").on("change",async S=>{if(V){if(Number(r("#pointType").val())==le.WPTYPE.LAND){let te=!1;k.get().forEach(ee=>{ee.getAction()==le.WPTYPE.LAND&&(_e.alert(oe.getMessage("MissionPlannerOnlyOneLandWp")),te=!0,r(S.currentTarget).val(V.getAction()))}),te||r("#wpFwLanding").fadeIn(300)}else r("#wpFwLanding").fadeOut(300);V.setAction(Number(r("#pointType").val())),[le.WPTYPE.SET_POI,le.WPTYPE.POSHOLD_TIME,le.WPTYPE.LAND].includes(V.getAction())&&(V.setP1(0),V.setP2(0));for(var R in ut[V.getAction()])ut[V.getAction()][R]!=""?(r("#pointP"+String(R).slice(-1)+"class").fadeIn(300),r("label[for=pointP"+String(R).slice(-1)+"]").html(ut[V.getAction()][R])):r("#pointP"+String(R).slice(-1)+"class").fadeOut(300);k.updateWaypoint(V),k.update(Ne()),Qe()}}),r("#pointLat").on("change",function(S){V&&(V.setLat(Math.round(Number(r("#pointLat").val())*1e7)),k.updateWaypoint(V),k.update(Ne()),Ve(),Te=z[V.getLayerNumber()].getSource().getFeatures()[0],Te.setStyle(dt(V,!0)))}),r("#pointLon").on("change",function(S){V&&(V.setLon(Math.round(Number(r("#pointLon").val())*1e7)),k.updateWaypoint(V),k.update(Ne()),Ve(),Te=z[V.getLayerNumber()].getSource().getFeatures()[0],Te.setStyle(dt(V,!0)))}),r("#pointAlt").on("change",function(S){if(V){const R=Number(r("#elevationValueAtWP").text()),te=Mt(!0,Number(r("#pointAlt").val()),R,V.getP3());V.setAlt(te),k.updateWaypoint(V),k.update(Ne()),Qe()}}),r("#pointP1").on("change",function(S){V&&(V.setP1(Number(r("#pointP1").val())),k.updateWaypoint(V),k.update(Ne()),Qe())}),r("#pointP2").on("change",function(S){V&&(V.setP2(Number(r("#pointP2").val())),k.updateWaypoint(V),k.update(Ne()),Qe())}),r("#pointP3Alt").on("change",function(S){if(V){var R=V.getP3();me&&Ue(r("#pointP3Alt"),Re.mission_control.isBitSet(R,le.P3.ALT_TYPE)),R=Re.mission_control.setBit(R,le.P3.ALT_TYPE,r("#pointP3Alt").prop("checked")),(async()=>{const te=await V.getElevation(qe);if(r("#elevationValueAtWP").text(te),Number(r("#pointAlt").val()),R!=V.getP3()){V.setP3(R);let ae=100*Number(r("#groundClearanceValueAtWP").text());if(isNaN(ae)&&(ae=f.alt),r("#pointP3Alt").prop("checked"))V.setAlt(ae+te*100);else{let fe=U.getAlt();isNaN(fe)&&(fe=te),V.setAlt(ae+100*(te-fe))}if(V.getAction()==le.WPTYPE.LAND&&Y&&Y.getIsSeaLevelRef()!=r("#pointP3Alt").prop("checked")){let fe=0;Y.getIsSeaLevelRef()&&(fe=Y.getElevation()),r("#pointP3Alt").prop("checked")?(Y.setApproachAltAsl(Y.getApproachAltAsl()-fe+te*100),Y.setLandAltAsl(Y.getLandAltAsl()-fe+te*100)):(Y.setApproachAltAsl(Y.getApproachAltAsl()-te*100),Y.setLandAltAsl(Y.getLandAltAsl()-te*100)),Y.setElevation(te*100),Y.setIsSeaLevelRef(r("#pointP3Alt").prop("checked")?1:0),r("#wpApproachAlt").val(Y.getApproachAltAsl()),r("#wpLandAlt").val(Y.getLandAltAsl())}}const ee=Mt(!1,V.getAlt(),te,V.getP3());V.setAlt(ee),r("#pointAlt").val(V.getAlt());let xe=_.ConvertCentimetersToMeters(V.getAlt());r("#altitudeInMeters").text(` ${xe}m`),r("#wpLandAltM").text(Y.getLandAltAsl()/100+" m"),r("#wpApproachAltM").text(Y.getApproachAltAsl()/100+" m"),Y&&Y.getIsSeaLevelRef()!=r("#pointP3Alt").prop("checked")&&(Y.setIsSeaLevelRef(r("#pointP3Alt").prop("checked")),Y.setElevation(te*100),r("#pointP3Alt").prop("checked")?(Y.setApproachAltAsl(Y.getApproachAltAsl()+te*100),Y.setLandAltAsl(Y.getLandAltAsl()+te*100)):(Y.setApproachAltAsl(Y.getApproachAltAsl()-te*100),Y.setLandAltAsl(Y.getLandAltAsl()-te*100)),r("#wpApproachAlt").val(Y.getApproachAltAsl()),r("#wpLandAlt").val(Y.getLandAltAsl())),r("#wpLandAltM").text(Y.getLandAltAsl()/100+" m"),r("#wpApproachAltM").text(Y.getApproachAltAsl()/100+" m"),k.updateWaypoint(V),k.update(Ne()),Qe()})()}}),r("#pointP3UserAction1").on("change",function(S){if(V){me&&Ue(r("#pointP3UserAction1"),Re.mission_control.isBitSet(V.getP3(),le.P3.USER_ACTION_1));var R=Re.mission_control.setBit(V.getP3(),le.P3.USER_ACTION_1,r("#pointP3UserAction1").prop("checked"));V.setP3(R),k.updateWaypoint(V),k.update(Ne()),Qe()}}),r("#pointP3UserAction2").on("change",function(S){if(V){me&&Ue(r("#pointP3UserAction2"),Re.mission_control.isBitSet(V.getP3(),le.P3.USER_ACTION_2));var R=Re.mission_control.setBit(V.getP3(),le.P3.USER_ACTION_2,r("#pointP3UserAction2").prop("checked"));V.setP3(R),k.updateWaypoint(V),k.update(Ne()),Qe()}}),r("#pointP3UserAction3").on("change",function(S){if(V){me&&Ue(r("#pointP3UserAction3"),Re.mission_control.isBitSet(V.getP3(),le.P3.USER_ACTION_3));var R=Re.mission_control.setBit(V.getP3(),le.P3.USER_ACTION_3,r("#pointP3UserAction3").prop("checked"));V.setP3(R),k.updateWaypoint(V),k.update(Ne()),Qe()}}),r("#pointP3UserAction4").on("change",function(S){if(V){me&&Ue(r("#pointP3UserAction4"),Re.mission_control.isBitSet(V.getP3(),le.P3.USER_ACTION_4));var R=Re.mission_control.setBit(V.getP3(),le.P3.USER_ACTION_4,r("#pointP3UserAction4").prop("checked"));V.setP3(R),k.updateWaypoint(V),k.update(Ne()),Qe()}}),r("#wpApproachAlt").on("change",S=>{if(V&&Y){let R=Number(r(S.currentTarget).val());n(R,r("#pointP3Alt").prop("checked"),Number(r("#elevationValueAtWP").text()))&&(Y.setApproachAltAsl(Number(r(S.currentTarget).val())),r("#wpApproachAltM").text(Y.getApproachAltAsl()/100+" m"))}}),r("#wpLandAlt").on("change",S=>{if(V&&Y){let R=Number(r(S.currentTarget).val());y(R,r("#pointP3Alt").prop("checked"),Number(r("#elevationValueAtWP").text()))&&(Y.setLandAltAsl(Number(r(S.currentTarget).val())),r("#wpLandAltM").text(Y.getLandAltAsl()/100+" m"))}}),r("#wpApproachDirection").on("change",S=>{V&&Y&&(Y.setApproachDirection(r(S.currentTarget).val()),Ve())}),r("#wpLandHeading1").on("change",S=>{if(V&&Y){let R=Number(r(S.currentTarget).val());R<0&&(R=360,r("#wpLandHeading1").val(360)),R>360&&(R=0,r("#wpLandHeading1").val(0)),r("#wpLandHeading1Excl").prop("checked")&&(R*=-1),Y.setLandHeading1(R),Ve()}}),r("#wpLandHeading1Excl").on("change",S=>{if(V&&Y){if(me){Ue(r("#wpLandHeading1Excl"),Y.getLandHeading1()<0);return}r("#wpLandHeading1Excl").prop("checked")?Y.setLandHeading1(-Math.abs(Y.getLandHeading1())):Y.setLandHeading1(Math.abs(Y.getLandHeading1())),Ve()}}),r("#wpLandHeading2").on("change",S=>{if(V&&Y){let R=Number(r(S.currentTarget).val());R<0&&(R=360,r("#wpLandHeading2").val(360)),R>360&&(R=0,r("#wpLandHeading2").val(0)),r("#wpLandHeading2Excl").prop("checked")&&(R*=-1),Y.setLandHeading2(R),Ve()}}),r("#wpLandHeading2Excl").on("change",S=>{if(V&&Y){if(me){Ue(r("#wpLandHeading2Excl"),Y.getLandHeading2()<0);return}r("#wpLandHeading2Excl").prop("checked")?Y.setLandHeading2(-Math.abs(Y.getLandHeading2())):Y.setLandHeading2(Math.abs(Y.getLandHeading2())),Ve()}}),F.on("click","[data-role='waypointOptions-delete']",function(S){V&&(k.dropAttachedFromWaypoint(V,r(S.currentTarget).attr("data-index")-1),Xn(V),Ve(),Te=z[V.getLayerNumber()].getSource().getFeatures()[0],Te.setStyle(dt(V,!0)))}),r("[data-role='waypointOptions-add']").on("click",function(){V&&(k.addAttachedFromWaypoint(V),Xn(V),Ve(),Te=z[V.getLayerNumber()].getSource().getFeatures()[0],Te.setStyle(dt(V,!0)))}),r("#editMission").on("click",function(){Tr(V.getNumber())}),r("#addSafehome").on("click",()=>{if($.SAFEHOMES.safehomeCount()+1>$.SAFEHOMES.getMaxSafehomeCount()){_e.alert(oe.getMessage("missionSafehomeMaxSafehomesReached"));return}let S=K.getView().getCenter(),R=Math.round(Ke(S)[0]*1e7),te=Math.round(Ke(S)[1]*1e7);$.SAFEHOMES.put(new eo($.SAFEHOMES.safehomeCount(),1,te,R)),Lt($.SAFEHOMES.safehomeCount()-1),ft(),j(),G(),O()}),r("#cancelSafehome").on("click",function(){e()}),r("#loadEepromSafehomeButton").on("click",function(){r(this).addClass("disabled"),Ee.log("Start of getting Safehome points");var S=new Rt;S.setChain([ke.loadSafehomes,ke.loadFwApproach,function(){$.SAFEHOMES.safehomeCount()>=1?Lt(0):(L=null,ie=null),ft(),j(),G(),O(),Ee.log(oe.getMessage("endGettingSafehomePoints")),r("#loadEepromSafehomeButton").removeClass("disabled")}]),S.execute()}),r("#saveEepromSafehomeButton").on("click",function(){r(this).addClass("disabled"),Ee.log(oe.getMessage("startSendingSafehomePoints"));var S=new Rt;S.setChain([ke.saveSafehomes,ke.saveFwApproach,function(){ke.saveToEeprom(),Ee.log(oe.getMessage("endSendingSafehomePoints")),r("#saveEepromSafehomeButton").removeClass("disabled")}]),S.execute()}),r("#deleteSafehome").on("click",()=>{if(L&&ie){var S=L.getNumber();$.SAFEHOMES.drop(S),$.FW_APPROACH.clean(S),$.SAFEHOMES.safehomeCount()>0?Lt($.SAFEHOMES.safehomeCount()-1):(L=null,ie=null),ft(),j(),G(),O()}}),r("#safehomeLatitude").on("change",S=>{L&&ie&&(L.setLat(Math.round(Number(r(S.currentTarget).val())*1e7)),ft(),j(),G())}),r("#safehomeLongitude").on("change",S=>{L&&ie&&(L.setLon(Math.round(Number(r(S.currentTarget).val())*1e7)),ft(),j(),G())}),r("#safehomeSeaLevelRef").on("change",S=>{let R=r(S.currentTarget).prop("checked")?1:0;L&&ie&&R!=ie.getIsSeaLevelRef()&&(ie.setIsSeaLevelRef(R),(async()=>{const te=await ie.getElevationFromServer(L.getLonMap(),L.getLatMap(),qe)*100;ie.setElevation(te),R?(ie.setApproachAltAsl(ie.getApproachAltAsl()+te),ie.setLandAltAsl(ie.getLandAltAsl()+te)):(ie.setApproachAltAsl(ie.getApproachAltAsl()-te),ie.setLandAltAsl(ie.getLandAltAsl()-te)),r("#safehomeElevation").text(te/100),r("#safehomeApproachAlt").val(ie.getApproachAltAsl()),r("#safehomeLandAlt").val(ie.getLandAltAsl()),r("#safehomeLandAltM").text(ie.getLandAltAsl()/100+" m"),r("#safehomeApproachAltM").text(ie.getApproachAltAsl()/100+" m"),ft()})())}),r("#safehomeApproachAlt").on("change",S=>{if(ie){let R=Number(r(S.currentTarget).val());n(R,r("#safehomeSeaLevelRef").prop("checked"),Number(r("#safehomeElevation").text()))&&(ie.setApproachAltAsl(Number(r(S.currentTarget).val())),r("#safehomeApproachAltM").text(ie.getApproachAltAsl()/100+" m"),j(),G(),Vt()),r("#safehomeApproachAlt").val(ie.getApproachAltAsl())}}),r("#safehomeLandAlt").on("change",S=>{if(ie){let R=Number(r(S.currentTarget).val());y(R,r("#safehomeSeaLevelRef").prop("checked"),Number(r("#safehomeElevation").text()))?(ie.setLandAltAsl(R),r("#safehomeLandAltM").text(ie.getLandAltAsl()/100+" m"),j(),G(),Vt()):r("#safehomeLandAlt").val(ie.getLandAltAsl())}}),r("#geozoneApproachDirection").on("change",S=>{ie&&(ie.setApproachDirection(r(S.currentTarget).val()),j(),G())}),r("#safehomeLandHeading1Excl").on("change",S=>{ie&&!it&&(ie.setLandHeading1(ie.getLandHeading1()*-1),j(),G())}),r("#safehomeLandHeading1").on("change",S=>{if(ie){let R=Number(r(S.currentTarget).val());R<0&&(R=360,r("#safehomeLandHeading1").val(360)),R>360&&(R=0,r("#safehomeLandHeading1").val(0)),r("#safehomeLandHeading1Excl").prop("checked")&&(R*=-1),ie.setLandHeading1(R),j(),G()}}),r("#safehomeLandHeading2Excl").on("change",S=>{ie&&!it&&(ie.setLandHeading2(ie.getLandHeading2()*-1),j(),G())}),r("#safehomeLandHeading2").on("change",S=>{if(ie){let R=Number(r(S.currentTarget).val());R<0&&(R=360,r("#safehomeLandHeading2").val(360)),R>360&&(R=0,r("#safehomeLandHeading2").val(0)),r("#safehomeLandHeading2Excl").prop("checked")&&(R*=-1),ie.setLandHeading2(R),j(),G()}});function De(){Ee.log(oe.getMessage("configurationEepromSaved")),Ee.tab_switch_cleanup(function(){mt.send_message(gt.MSP_SET_REBOOT,!1,!1,Ae)})}function Ae(){Ee.log(oe.getMessage("deviceRebooting")),Ee.handleReconnect(r(".tab_mission_control a"))}r("#cancelGeozone").on("click",function(){r("#missionPlannerGeozones").hide(),li(),Un(),I=null}),r("#addGeozone").on("click",function(){_r()}),r("#deleteGeozone").on("click",S=>{$.GEOZONES.drop(I.getNumber()),I=$.GEOZONES.last(),$e(),Je(),rt()}),r("#loadEepromGeozoneButton").on("click",S=>{r(S.currentTarget).addClass("disabled"),Ee.log("Start of getting Geozones"),ke.loadGeozones(()=>{$.GEOZONES.geozoneCount()>=1?I=$.GEOZONES.first():I=null,$e(),Je(),rt(),Ee.log("End of getting Geozones"),r(S.currentTarget).removeClass("disabled")},1e3)}),r("#saveEepromGeozoneButton").on("click",S=>{if(u){_e.alert(oe.getMessage("geozoneUnableToSave"));return}_e.confirm(oe.getMessage("missionGeozoneReboot"))&&(r(S.currentTarget).addClass("disabled"),Ee.log("Start of sending Geozones"),ke.saveGeozones(()=>{ke.saveToEeprom(),Ee.log("End of sending Geozones"),De()}))}),r("#geozoneShape").on("change",S=>{if(I){if(r(S.currentTarget).val()==Tt.CIRCULAR){r("#geozoneRadius").prop("disabled",!1);let R=I.getFirstVertex();I.resetVertices(),I.setVertices([R])}else{if($.GEOZONES.getUsedVerticesCount()+2>$.GEOZONES.getMaxVertices()){_e.alert(oe.getMessage("missionGeozoneMaxVerticesReached")),$e();return}if(r("#geozoneRadius").prop("disabled",!0),I.getVerticesCount()<3){let R=I.getFirstVertex().getLat(),te=I.getFirstVertex().getLon(),ee=[new xt(0,R-25e3,te-25e3),new xt(1,R-25e3,te+25e3),new xt(2,R+25e3,te+25e3),new xt(3,R+25e3,te-25e3)];I.setVertices(ee)}}I.setShape(r(S.currentTarget).val()),Je(),rt()}}),r("#geozoneType").on("change",S=>{I&&(I.setType(r(S.currentTarget).val()),Je())}),r("#geozoneMinAlt").on("change",S=>{I&&(I.setMinAltitude(r(S.currentTarget).val()),$e())}),r("#geozoneMaxAlt").on("change",S=>{I&&(I.setMaxAltitude(r(S.currentTarget).val()),$e())}),r("#geozoneSeaLevelRef").on("change",S=>{const R=r(S.currentTarget).prop("checked")?1:0;I&&R!=I.getSealevelRef()&&(I.setSealevelRef(R),(async()=>{const te=I.getVertex(0),ee=await I.getElevationFromServer(te.getLonMap(),te.getLatMap(),qe);R?(I.setMinAltitude(Number(I.getMinAltitude())+ee*100),I.setMaxAltitude(Number(I.getMaxAltitude())+ee*100)):(I.setMinAltitude(Number(I.getMinAltitude())-ee*100),I.setMaxAltitude(Number(I.getMaxAltitude())-ee*100)),$e()})())}),r("#geozoneAction").on("change",S=>{I&&I.setFenceAction(r(S.currentTarget).val())}),r("#geozoneRadius").on("change",S=>{I&&(I.setRadius(r(S.currentTarget).val()),Je())}),r("#homeTableBody").on("click","[data-role='home-center']",function(S){let R=K.getView().getCenter();U.setLon(Math.round(Ke(R)[0]*1e7)),U.setLat(Math.round(Ke(R)[1]*1e7)),ci()}),r("#cancelHome").on("click",function(){ui()}),r("#cancelPlot").on("click",function(){ui()}),r("#multimissionOptionList").on("change",function(){if(Ne()){if(k.isEmpty()){It();return}let S=0;k.get().forEach(function(R){S+=R.getEndMission()==165?1:0}),S==1&&It(),xr()}else It(),pt()}),r("#addMultimissionButton").on("click",function(){Sr()}),r("#updateMultimissionButton").on("click",function(){r("#multimissionOptionList").val("0").trigger("change")}),r("#cancelMultimission").on("click",function(){r("#missionPlannerMultiMission").fadeOut(300)}),r("#setActiveMissionButton").on("click",function(){r("#activeNissionIndex").text(Number(r("#multimissionOptionList").val()))}),r("#removeAllPoints").on("click",function(){if(z.length&&_e.confirm(oe.getMessage("confirm_delete_all_points"))){Nr()&&(Dt(),pt());for(let S=$.SAFEHOMES.getMaxSafehomeCount();S<$.FW_APPROACH.getMaxFwApproachCount();S++)$.FW_APPROACH.clean(S)}}),r("#removePoint").on("click",function(){V&&(k.isJumpTargetAttached(V)?_e.alert(oe.getMessage("MissionPlannerJumpTargetRemoval")):k.getAttachedFromWaypoint(V)&&k.getAttachedFromWaypoint(V).length!=0?_e.confirm(oe.getMessage("confirm_delete_point_with_options"))&&(k.getAttachedFromWaypoint(V).forEach(function(S){S.getAction()==le.WPTYPE.LAND&&$.FW_APPROACH.clean(S.getNumber()),k.dropWaypoint(S),k.update(Ne())}),k.dropWaypoint(V),V=null,k.update(Ne()),ge(),Ve()):(k.dropWaypoint(V),V.getAction()==le.WPTYPE.LAND&&$.FW_APPROACH.clean(Y.getNumber()),V=null,k.update(Ne()),ge(),Ve()),pt())}),r("#loadFileMissionButton").on("click",function(){if(Or()&&!(z.length&&!_e.confirm(oe.getMessage("confirm_delete_all_points")))){var S={filters:[{name:"Mission file",extensions:["mission"]}]};_e.showOpenDialog(S).then(R=>{if(R.canceled){console.log("No file selected");return}R.filePaths.length==1&&di(R.filePaths[0])})}}),r("#saveFileMissionButton").on("click",function(){var S={filters:[{name:"Mission file",extensions:["mission"]}]};_e.showSaveDialog(S).then(R=>{R.canceled||Fr(R.filePath)})}),r("#loadMissionButton").on("click",function(){let S=c?"confirm_overwrite_multimission_file_load_option":"confirm_delete_all_points";(z.length||c)&&!_e.confirm(oe.getMessage(S))||(Dt(),r(this).addClass("disabled"),Ee.log(oe.getMessage("startGetPoint")),fi(!1))}),r("#saveMissionButton").on("click",function(){if(k.isEmpty()){_e.alert(oe.getMessage("no_waypoints_to_save"));return}r(this).addClass("disabled"),Ee.log(oe.getMessage("startSendPoint")),hi(!1)}),r("#loadEepromMissionButton").on("click",function(){let S=c?"confirm_overwrite_multimission_file_load_option":"confirm_delete_all_points";(z.length||c)&&!_e.confirm(oe.getMessage(S))||(Dt(),r(this).addClass("disabled"),Ee.log(oe.getMessage("startGetPoint")),fi(!0))}),r("#saveEepromMissionButton").on("click",function(){if(k.isEmpty()){_e.alert(oe.getMessage("no_waypoints_to_save"));return}r(this).addClass("disabled"),Ee.log(oe.getMessage("startSendPoint")),hi(!0)}),r("#saveSettings").on("click",function(){let S=f.safeRadiusSH;f.alt=Number(r("#MPdefaultPointAlt").val()),f.speed=Number(r("#MPdefaultPointSpeed").val()),f.safeRadiusSH=Number(r("#MPdefaultSafeRangeSH").val()),f.fwApproachAlt=Number(r("#MPdefaultFwApproachAlt").val()),f.fwLandAlt=Number(r("#MPdefaultLandAlt").val()),Be(),f.safeRadiusSH!=S&&r("#showHideSafehomeButton").is(":visible")&&(j(),G(),r("#SafeHomeSafeDistance").text(f.safeRadiusSH)),d()}),r("#cancelSettings").on("click",function(){be(),d()}),ht()}function di(_){for(let H=$.SAFEHOMES.getMaxSafehomeCount();H<$.FW_APPROACH.getMaxFwApproachCount();H++)$.FW_APPROACH.clean(H);window.electronAPI.readFile(_).then(H=>{if(H.error){Ee.log(oe.getMessage("errorReadingFile")),console.error(H.error);return}pr.Parser({explicitChildren:!0,preserveChildrenOrder:!0}).parseString(H.data,(q,Z)=>{if(q)return Ee.log(oe.getMessage("errorParsingFile")),console.error(q);Dt();let ne=0;var X=null,ue=null;for(var we in Z)if(!ue&&we.match(/mission/i)){ue=Z[we];var se=-1;if(ue.$$&&ue.$$.length){for(var pe=0;pe<ue.$$.length;pe++)if(X=ue.$$[pe],X["#name"].match(/version/i)&&X.$)for(var Q in X.$)Q.match(/value/i)&&k.setVersion(X.$[Q]);else if(X["#name"].match(/meta/i)||X["#name"].match(/mwp/i)&&X.$)for(var Q in X.$)Q.match(/mission/i)?se=parseInt(X.$[Q])-1:Q.match(/zoom/i)?k.setCenterZoom(parseInt(X.$[Q])):Q.match(/cx/i)?k.setCenterLon(parseFloat(X.$[Q])*1e7):Q.match(/cy/i)?k.setCenterLat(parseFloat(X.$[Q])*1e7):Q.match(/home\-x/i)?U.setLon(Math.round(parseFloat(X.$[Q])*1e7)):Q.match(/home\-y/i)&&U.setLat(Math.round(parseFloat(X.$[Q])*1e7));else if(X["#name"].match(/missionitem/i)&&X.$){var ye=new $t(0,0,0,0);for(var Q in X.$)Q.match(/no/i)?ye.setNumber(parseInt(X.$[Q])):Q.match(/action/i)?X.$[Q].match(/WAYPOINT/i)?ye.setAction(le.WPTYPE.WAYPOINT):X.$[Q].match(/PH_UNLIM/i)||X.$[Q].match(/POSHOLD_UNLIM/i)?ye.setAction(le.WPTYPE.POSHOLD_UNLIM):X.$[Q].match(/PH_TIME/i)||X.$[Q].match(/POSHOLD_TIME/i)?ye.setAction(le.WPTYPE.POSHOLD_TIME):X.$[Q].match(/RTH/i)?ye.setAction(le.WPTYPE.RTH):X.$[Q].match(/SET_POI/i)?ye.setAction(le.WPTYPE.SET_POI):X.$[Q].match(/JUMP/i)?ye.setAction(le.WPTYPE.JUMP):X.$[Q].match(/SET_HEAD/i)?ye.setAction(le.WPTYPE.SET_HEAD):X.$[Q].match(/LAND/i)?ye.setAction(le.WPTYPE.LAND):ye.setAction(0):Q.match(/lat/i)?ye.setLat(Math.round(parseFloat(X.$[Q])*1e7)):Q.match(/lon/i)?ye.setLon(Math.round(parseFloat(X.$[Q])*1e7)):Q.match(/alt/i)?ye.setAlt(parseInt(X.$[Q])*100):Q.match(/parameter1/i)?ye.setP1(parseInt(X.$[Q])):Q.match(/parameter2/i)?ye.setP2(parseInt(X.$[Q])):Q.match(/parameter3/i)?ye.setP3(parseInt(X.$[Q])):Q.match(/flag/i)&&(ye.setEndMission(parseInt(X.$[Q])),parseInt(X.$[Q])==165&&ne++);se>=0&&ye.setMultiMissionIdx(se),k.put(ye)}else if(X["#name"].match(/fwapproach/i)&&X.$){var De=new gi(0),Ae=-1;for(var Q in X.$)Q.match(/index/i)?Ae=parseInt(X.$[Q]):Q.match(/no/i)?De.setNumber(parseInt(X.$[Q])):Q.match(/approach-alt/i)?De.setApproachAltAsl(parseInt(X.$[Q])):Q.match(/land-alt/i)?De.setLandAltAsl(parseInt(X.$[Q])):Q.match(/approach-direction/i)?De.setApproachDirection(X.$[Q]=="left"?0:1):Q.match(/landheading1/i)?De.setLandHeading1(parseInt(X.$[Q])):Q.match(/landheading2/i)?De.setLandHeading2(parseInt(X.$[Q])):Q.match(/sealevel-ref/i)&&De.setIsSeaLevelRef(Rr(X.$[Q])?1:0);$.FW_APPROACH.insert(De,$.SAFEHOMES.getMaxSafehomeCount()+Ae)}}}if(ne>1)if(c&&!_e.confirm(oe.getMessage("confirm_multimission_file_load"))){k.flush();return}else pe=1,k.get().forEach(function(te){te.setNumber(pe),pe++}),k.update(!1,!0),c=ne,Fe.reinit(),Fe.copy(k),wt(),r("#missionPlannerMultiMission").fadeIn(300);else k.update(!0,!0);if(pt(),Object.keys(k.getCenter()).length!==0){var S=He([k.getCenter().lon/1e7,k.getCenter().lat/1e7]);K.getView().setCenter(S),k.getCenter().zoom?K.getView().setZoom(k.getCenter().zoom):K.getView().setZoom(16)}else qt(16);Wn(),U.getLatMap()==0&&U.getLonMap()==0||ci(),ht();let R=String(_.split("\\").pop().split("/").pop());Ee.log(R+oe.getMessage("loadedSuccessfully")),mi(R)})})}function Fr(_){var H=Ke(K.getView().getCenter()),q=K.getView().getZoom();let Z=c&&!Ne();var X={version:{$:{value:Z?"4.0.0":"2.3-pre8"}},mwp:{$:{cx:Math.round(H[0]*1e7)/1e7,cy:Math.round(H[1]*1e7)/1e7,"home-x":U.getLonMap(),"home-y":U.getLatMap(),zoom:q}},missionitem:[],fwapproach:[]};let ue=0,we=1;k.get().forEach(function(Ae){if(Ae.getNumber()-ue==0&&Z){let R={$:{mission:we}};X.missionitem.push(R)}var S={$:{no:Ae.getNumber()-ue+1,action:le.WPTYPE.REV[Ae.getAction()],lat:Ae.getLatMap(),lon:Ae.getLonMap(),alt:Ae.getAlt()/100,parameter1:le.WPTYPE.REV[Ae.getAction()]=="JUMP"?Ae.getP1()+1:Ae.getP1(),parameter2:Ae.getP2(),parameter3:Ae.getP3(),flag:Ae.getEndMission()}};X.missionitem.push(S),Ae.getEndMission()==165&&(ue=Ae.getNumber()+1,we++)});let se=0;for(let Ae=$.SAFEHOMES.getMaxSafehomeCount();Ae<$.FW_APPROACH.getMaxFwApproachCount();Ae++){let S=$.FW_APPROACH.get()[Ae];if(S.getLandHeading1()!=0||S.getLandHeading2()!=0){var pe={$:{index:se,no:S.getNumber(),"approach-alt":S.getApproachAltAsl(),"land-alt":S.getLandAltAsl(),"approach-direction":S.getApproachDirection()==0?"left":"right",landheading1:S.getLandHeading1(),landheading2:S.getLandHeading2(),"sealevel-ref":S.getIsSeaLevelRef()?"true":"false"}};X.fwapproach.push(pe)}se++}var Q=new pr.Builder({rootName:"mission",renderOpts:{pretty:!0,indent:"	",newline:`
`}}),ye=Q.buildObject(X);ye=ye.replace(/missionitem mission/g,"meta mission"),fs.writeFile(_,ye,Ae=>{if(Ae)return Ee.log(oe.getMessage("ErrorWritingFile")),console.error(Ae)});let De=String(_.split("\\").pop().split("/").pop());Ee.log(De+oe.getMessage("savedSuccessfully")),mi(De)}function fi(_){var H=new Rt,q=[ke.loadFwApproach];_&&q.push(function(Z){mt.send_message(gt.MSP_WP_MISSION_LOAD,[0],Z)}),q.push(ke.loadWaypoints),q.push(function(){if(Ee.log(oe.getMessage("endGetPoint")),_?(Ee.log(oe.getMessage("eeprom_load_ok")),r("#loadEepromMissionButton").removeClass("disabled")):r("#loadMissionButton").removeClass("disabled"),!$.MISSION_PLANNER.getCountBusyPoints()){_e.alert(oe.getMessage("no_waypoints_to_load"));return}k.reinit(),k.copy($.MISSION_PLANNER),k.update(!1,!0),c=0,k.get().forEach(function(Z){Z.getEndMission()==165&&(Z.setMultiMissionIdx(c),c++)}),c=c>1?c:0,Fe.reinit(),c>1&&(Fe.copy(k),r("#missionPlannerMultiMission").fadeIn(300)),wt(),qt(16),Wn(),ht()}),H.setChain(q),H.execute()}function hi(_){$.MISSION_PLANNER.reinit(),$.MISSION_PLANNER.copy(k),$.MISSION_PLANNER.update(!1,!0,!0);let H=new Rt;H.setChain([ke.saveWaypoints,ke.saveFwApproach,function(){Ee.log(oe.getMessage("endSendPoint")),_?(r("#saveEepromMissionButton").removeClass("disabled"),Ee.log(oe.getMessage("eeprom_saved_ok")),mt.send_message(gt.MSP_WP_MISSION_SAVE,[0],!1,q)):r("#saveMissionButton").removeClass("disabled"),k.setMaxWaypoints($.MISSION_PLANNER.getMaxWaypoints()),k.setValidMission($.MISSION_PLANNER.getValidMission()),k.setCountBusyPoints($.MISSION_PLANNER.getCountBusyPoints()),Fe.setMaxWaypoints(k.getMaxWaypoints()),ht(),k.reinit(),k.copy($.MISSION_PLANNER),k.update(!1,!0),Ve(),r("#MPeditPoint").fadeOut(300)}]),H.execute();function q(){let Z=Ne()?1:r("#activeNissionIndex").text();ke.setSetting("nav_wp_multi_mission_index",Z,function(){mt.send_message(gt.MSP_EEPROM_WRITE,!1,!1,function(){Ee.log(oe.getMessage("multimission_active_index_saved_eeprom"))})})}}function ht(){if(jt.connectionValid){let _=k.getMaxWaypoints()-k.get().length;c&&Ne()&&(_=_-Fe.get().length),r("#availablePoints").text(_+"/"+k.getMaxWaypoints()),r("#missionValid").html(k.getValidMission()?oe.getMessage("armingCheckPass"):oe.getMessage("armingCheckFail"))}}function mi(_){r("#missionFilename").text(_),r("#infoMissionFilename").show()}function Ue(_,H){_.prop("checked",H)}function Lt(_){L=$.SAFEHOMES.get()[_],ie=$.FW_APPROACH.get()[_]}function Mt(_,H,q,Z){let ne="NO HOME",X=H;if(Z=typeof Z=="boolean"?Z:Re.mission_control.isBitSet(Z,le.P3.ALT_TYPE),Z)H<100*q&&(_?(_e.alert(oe.getMessage("MissionPlannerAltitudeChangeReset")),X=V.getAlt()):X=f.alt+100*q),ne=X/100-q;else if(P.length&&U.getAlt()!="N/A"){let we=U.getAlt();if(H/100+we<q)if(_)_e.alert(oe.getMessage("MissionPlannerAltitudeChangeReset")),X=V.getAlt();else{let se=100*Number(r("#groundClearanceValueAtWP").text());(isNaN(se)||V==null)&&(se=f.alt),X=se+100*(q-we)}ne=X/100+(we-q)}r("#pointAlt").val(X);let ue=parseInt(X)/100;return r("#altitudeInMeters").text(` ${ue}m`),document.getElementById("groundClearanceAtWP").style.color=ne<f.alt/100?"#FF0000":"#303030",r("#groundClearanceValueAtWP").text(` ${ne}`),X}function Rr(_){return/^(?:true|false)$/i.test(_)&&(_=_.toLowerCase()==="true"),_}};Re.mission_control.isBitSet=function(v,l){return(v&1<<l)!=0};Re.mission_control.setBit=function(v,l,M){return M?v|=1<<l:v&=~(1<<l)};Re.mission_control.cleanup=function(v){v&&v()};
