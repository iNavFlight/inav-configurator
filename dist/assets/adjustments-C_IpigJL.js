import{T,G as m,M as _,d as S,_ as I,F as r,$ as e,i as j,m as J,b as L}from"./index--BqaKNiR.js";import{w as F}from"./wNumb-DZfnXen2.js";import{n as k}from"./nouislider-B_G20eMg.js";T.adjustments={};T.adjustments.initialize=function(p){m.active_tab_ref=this,m.active_tab="adjustments",_.send_message(S.MSP_ADJUSTMENT_RANGES,!1,!1,U);function U(){_.send_message(S.MSP_RC,!1,!1,x)}function x(){I(async()=>{const{default:d}=await import("./adjustments-BZgG2hx-.js");return{default:d}},[],import.meta.url).then(({default:d})=>m.load(d,G))}function R(d,i,f){var E=e("#tab-adjustments-templates").find(".adjustments .adjustment"),n=E.clone();e(n).attr("id","adjustment-"+d),e(n).data("index",d);var t=e(n).find(".adjustmentSlot .slot");t.val(i.slotIndex);var t=e(n).find(".channelInfo .channel"),v=e(t).find("option");v.remove();for(var s=0;s<f;s++){var l=v.clone();l.text("CH "+(s+5)),l.val(s),t.append(l)}t.val(i.auxChannelIndex);var o=e(n).find(".functionSelection .function"),c=e(o).find("option"),a=59,c=e(c).slice(0,a);o.val(i.adjustmentFunction);var t=e(n).find(".functionSwitchChannel .channel"),v=e(t).find("option");v.remove();for(var s=0;s<f;s++){var l=v.clone();l.text("CH "+(s+5)),l.val(s),t.append(l)}t.val(i.auxSwitchChannelIndex);var h={min:[900],max:[2100]},A=[1300,1700],b=A;i.range!=null&&(b=[i.range.start,i.range.end]);var C=e(n).find(".channel-slider")[0];k.create(C,{start:b,behaviour:"snap-drag",margin:50,step:25,connect:!0,range:h,format:F({decimals:0}),pips:{mode:"values",values:[900,1e3,1200,1400,1500,1600,1800,2e3,2100],density:4,stepped:!0}}),C.noUiSlider.on("update",u=>{e(n).find(".lowerLimitValue").text(u[0]),e(n).find(".upperLimitValue").text(u[1])});var g=e(n).find(".enable");e(g).data("adjustmentElement",n),e(g).on("change",function(){var u=e(this).data("adjustmentElement");if(e(this).prop("checked")){e(u).find(":input").prop("disabled",!1),e(u).find(".channel-slider").removeAttr("disabled");var N=e(u).find(".range .channel-slider"),M=e(N).val();if(M[0]==M[1]){var D=[1300,1700];e(N).val(D)}}else e(u).find(":input").prop("disabled",!0),e(u).find(".channel-slider").attr("disabled","disabled");e(this).prop("disabled",!1)});var w=i.range.start!=i.range.end;return e(g).prop("checked",w).trigger("change"),n}function G(){for(var d=r.RC.active_channels-4,i=e(".tab-adjustments .adjustments tbody"),f=0;f<r.ADJUSTMENT_RANGES.length;f++){var E=R(f,r.ADJUSTMENT_RANGES[f],d);i.append(E)}j.localize(),e("a.save").on("click",function(){var o=r.ADJUSTMENT_RANGES.length;r.ADJUSTMENT_RANGES=[];var a={slotIndex:0,auxChannelIndex:0,range:{start:900,end:900},adjustmentFunction:0,auxSwitchChannelIndex:0};e(".tab-adjustments .adjustments .adjustment").each(function(){var v=e(this);if(e(v).find(".enable").prop("checked")){var h=e(this).find(".range .channel-slider")[0].noUiSlider.get(!0),A={slotIndex:parseInt(e(this).find(".adjustmentSlot .slot").val()),auxChannelIndex:parseInt(e(this).find(".channelInfo .channel").val()),range:{start:h[0],end:h[1]},adjustmentFunction:parseInt(e(this).find(".functionSelection .function").val()),auxSwitchChannelIndex:parseInt(e(this).find(".functionSwitchChannel .channel").val())};r.ADJUSTMENT_RANGES.push(A)}else r.ADJUSTMENT_RANGES.push(a)});for(var c=r.ADJUSTMENT_RANGES.length;c<o;c++)r.ADJUSTMENT_RANGES.push(a);J.sendAdjustmentRanges(t);function t(){_.send_message(S.MSP_EEPROM_WRITE,!1,!1,function(){m.log(j.getMessage("adjustmentsEepromSaved"))})}});function n(o,a){a<900?a=900:a>2100&&(a=2100);var c=(a-900)/1200*100;e(".adjustments .adjustment").each(function(){var t=e(this).find(".channel").val();t==o&&e(this).find(".range .marker").css("left",c+"%")})}function s(){_.send_message(S.MSP_RC,!1,!1,l)}function l(){for(var o=r.RC.active_channels-4,a=0;a<o;a++)n(a,r.RC.channels[a+4])}l(),L.add("aux_data_pull",s,50),m.content_ready(p)}};T.adjustments.cleanup=function(p){p&&p()};
