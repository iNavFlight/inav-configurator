import{G as B,i as C,M as x,d as F,n as G,F as p,s as te,er as ye,m as z,$ as n,z as Ee,c as K,T as se,_ as Y,k as Oe,o as Re,P as Me}from"./index--BqaKNiR.js";import{d as Ce}from"./dialog-CY10jn-b.js";var M={},ne;function De(){if(ne)return M;ne=1;/*!
 * inflection
 * Copyright(c) 2011 Ben Lin <ben@dreamerslab.com>
 * MIT Licensed
 *
 * @fileoverview
 * A port of inflection-js to node.js module.
 */Object.defineProperty(M,"__esModule",{value:!0}),M.pluralize=O,M.singularize=A,M.inflect=L,M.camelize=H,M.underscore=w,M.humanize=U,M.capitalize=N,M.dasherize=D,M.titleize=k,M.demodulize=$,M.tableize=S,M.classify=f,M.foreignKey=P,M.ordinalize=X,M.transform=he;const i=["accommodation","adulthood","advertising","advice","aggression","aid","air","aircraft","alcohol","anger","applause","arithmetic","assistance","athletics","bacon","baggage","beef","biology","blood","botany","bread","butter","carbon","cardboard","cash","chalk","chaos","chess","crossroads","countryside","dancing","deer","dignity","dirt","dust","economics","education","electricity","engineering","enjoyment","envy","equipment","ethics","evidence","evolution","fame","fiction","flour","flu","food","fuel","fun","furniture","gallows","garbage","garlic","genetics","gold","golf","gossip","gratitude","grief","guilt","gymnastics","happiness","hardware","harm","hate","hatred","health","heat","help","homework","honesty","honey","hospitality","housework","humour","hunger","hydrogen","ice","importance","inflation","information","innocence","iron","irony","jam","jewelry","judo","karate","knowledge","lack","laughter","lava","leather","leisure","lightning","linguine","linguini","linguistics","literature","litter","livestock","logic","loneliness","luck","luggage","macaroni","machinery","magic","management","mankind","marble","mathematics","mayonnaise","measles","methane","milk","minus","money","mud","music","mumps","nature","news","nitrogen","nonsense","nurture","nutrition","obedience","obesity","oxygen","pasta","patience","physics","poetry","pollution","poverty","pride","psychology","publicity","punctuation","quartz","racism","relaxation","reliability","research","respect","revenge","rice","rubbish","rum","safety","scenery","seafood","seaside","series","shame","sheep","shopping","sleep","smoke","smoking","snow","soap","software","soil","spaghetti","species","steam","stuff","stupidity","sunshine","symmetry","tennis","thirst","thunder","timber","traffic","transportation","trust","underwear","unemployment","unity","validity","veal","vegetation","vegetarianism","vengeance","violence","vitality","warmth","wealth","weather","welfare","wheat","wildlife","wisdom","yoga","zinc","zoology"],e={plural:{men:new RegExp("^(m|wom)en$","gi"),people:new RegExp("(pe)ople$","gi"),children:new RegExp("(child)ren$","gi"),tia:new RegExp("([ti])a$","gi"),analyses:new RegExp("((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)ses$","gi"),databases:new RegExp("(database)s$","gi"),drives:new RegExp("(drive)s$","gi"),hives:new RegExp("(hi|ti)ves$","gi"),curves:new RegExp("(curve)s$","gi"),lrves:new RegExp("([lr])ves$","gi"),aves:new RegExp("([a])ves$","gi"),foves:new RegExp("([^fo])ves$","gi"),movies:new RegExp("(m)ovies$","gi"),aeiouyies:new RegExp("([^aeiouy]|qu)ies$","gi"),series:new RegExp("(s)eries$","gi"),xes:new RegExp("(x|ch|ss|sh)es$","gi"),mice:new RegExp("([m|l])ice$","gi"),buses:new RegExp("(bus)es$","gi"),oes:new RegExp("(o)es$","gi"),shoes:new RegExp("(shoe)s$","gi"),crises:new RegExp("(cris|ax|test)es$","gi"),octopuses:new RegExp("(octop|vir)uses$","gi"),aliases:new RegExp("(alias|canvas|status|campus)es$","gi"),summonses:new RegExp("^(summons|bonus)es$","gi"),oxen:new RegExp("^(ox)en","gi"),matrices:new RegExp("(matr)ices$","gi"),vertices:new RegExp("(vert|ind)ices$","gi"),feet:new RegExp("^feet$","gi"),teeth:new RegExp("^teeth$","gi"),geese:new RegExp("^geese$","gi"),quizzes:new RegExp("(quiz)zes$","gi"),whereases:new RegExp("^(whereas)es$","gi"),criteria:new RegExp("^(criteri)a$","gi"),genera:new RegExp("^genera$","gi"),ss:new RegExp("ss$","gi"),s:new RegExp("s$","gi")},singular:{man:new RegExp("^(m|wom)an$","gi"),person:new RegExp("(pe)rson$","gi"),child:new RegExp("(child)$","gi"),drive:new RegExp("(drive)$","gi"),ox:new RegExp("^(ox)$","gi"),axis:new RegExp("(ax|test)is$","gi"),octopus:new RegExp("(octop|vir)us$","gi"),alias:new RegExp("(alias|status|canvas|campus)$","gi"),summons:new RegExp("^(summons|bonus)$","gi"),bus:new RegExp("(bu)s$","gi"),buffalo:new RegExp("(buffal|tomat|potat)o$","gi"),tium:new RegExp("([ti])um$","gi"),sis:new RegExp("sis$","gi"),ffe:new RegExp("(?:([^f])fe|([lr])f)$","gi"),focus:new RegExp("^(focus)$","gi"),hive:new RegExp("(hi|ti)ve$","gi"),aeiouyy:new RegExp("([^aeiouy]|qu)y$","gi"),x:new RegExp("(x|ch|ss|sh)$","gi"),matrix:new RegExp("(matr)ix$","gi"),vertex:new RegExp("(vert|ind)ex$","gi"),mouse:new RegExp("([m|l])ouse$","gi"),foot:new RegExp("^foot$","gi"),tooth:new RegExp("^tooth$","gi"),goose:new RegExp("^goose$","gi"),quiz:new RegExp("(quiz)$","gi"),whereas:new RegExp("^(whereas)$","gi"),criterion:new RegExp("^(criteri)on$","gi"),genus:new RegExp("^genus$","gi"),s:new RegExp("s$","gi"),common:new RegExp("$","gi")}},o=[[e.plural.men],[e.plural.people],[e.plural.children],[e.plural.tia],[e.plural.analyses],[e.plural.databases],[e.plural.drives],[e.plural.hives],[e.plural.curves],[e.plural.lrves],[e.plural.foves],[e.plural.aeiouyies],[e.plural.series],[e.plural.movies],[e.plural.xes],[e.plural.mice],[e.plural.buses],[e.plural.oes],[e.plural.shoes],[e.plural.crises],[e.plural.octopuses],[e.plural.aliases],[e.plural.summonses],[e.plural.oxen],[e.plural.matrices],[e.plural.feet],[e.plural.teeth],[e.plural.geese],[e.plural.quizzes],[e.plural.whereases],[e.plural.criteria],[e.plural.genera],[e.singular.man,"$1en"],[e.singular.person,"$1ople"],[e.singular.child,"$1ren"],[e.singular.drive,"$1s"],[e.singular.ox,"$1en"],[e.singular.axis,"$1es"],[e.singular.octopus,"$1uses"],[e.singular.alias,"$1es"],[e.singular.summons,"$1es"],[e.singular.bus,"$1ses"],[e.singular.buffalo,"$1oes"],[e.singular.tium,"$1a"],[e.singular.sis,"ses"],[e.singular.ffe,"$1$2ves"],[e.singular.focus,"$1es"],[e.singular.hive,"$1ves"],[e.singular.aeiouyy,"$1ies"],[e.singular.matrix,"$1ices"],[e.singular.vertex,"$1ices"],[e.singular.x,"$1es"],[e.singular.mouse,"$1ice"],[e.singular.foot,"feet"],[e.singular.tooth,"teeth"],[e.singular.goose,"geese"],[e.singular.quiz,"$1zes"],[e.singular.whereas,"$1es"],[e.singular.criterion,"$1a"],[e.singular.genus,"genera"],[e.singular.s,"s"],[e.singular.common,"s"]],r=[[e.singular.man],[e.singular.person],[e.singular.child],[e.singular.drive],[e.singular.ox],[e.singular.axis],[e.singular.octopus],[e.singular.alias],[e.singular.summons],[e.singular.bus],[e.singular.buffalo],[e.singular.tium],[e.singular.sis],[e.singular.ffe],[e.singular.focus],[e.singular.hive],[e.singular.aeiouyy],[e.singular.x],[e.singular.matrix],[e.singular.mouse],[e.singular.foot],[e.singular.tooth],[e.singular.goose],[e.singular.quiz],[e.singular.whereas],[e.singular.criterion],[e.singular.genus],[e.plural.men,"$1an"],[e.plural.people,"$1rson"],[e.plural.children,"$1"],[e.plural.databases,"$1"],[e.plural.drives,"$1"],[e.plural.genera,"genus"],[e.plural.criteria,"$1on"],[e.plural.tia,"$1um"],[e.plural.analyses,"$1$2sis"],[e.plural.hives,"$1ve"],[e.plural.curves,"$1"],[e.plural.lrves,"$1f"],[e.plural.aves,"$1ve"],[e.plural.foves,"$1fe"],[e.plural.movies,"$1ovie"],[e.plural.aeiouyies,"$1y"],[e.plural.series,"$1eries"],[e.plural.xes,"$1"],[e.plural.mice,"$1ouse"],[e.plural.buses,"$1"],[e.plural.oes,"$1"],[e.plural.shoes,"$1"],[e.plural.crises,"$1is"],[e.plural.octopuses,"$1us"],[e.plural.aliases,"$1"],[e.plural.summonses,"$1"],[e.plural.oxen,"$1"],[e.plural.matrices,"$1ix"],[e.plural.vertices,"$1ex"],[e.plural.feet,"foot"],[e.plural.teeth,"tooth"],[e.plural.geese,"goose"],[e.plural.quizzes,"$1"],[e.plural.whereases,"$1"],[e.plural.ss,"ss"],[e.plural.s,""]],d=["and","or","nor","a","an","the","so","but","to","of","at","by","from","into","on","onto","off","out","in","over","with","for"],_=new RegExp("(_ids|_id)$","g"),l=new RegExp("_","g"),u=new RegExp("[ _]","g"),m=new RegExp("([A-Z])","g"),v=new RegExp("^_");function I(c,E,R,b){if(b)return b;if(R.includes(c.toLocaleLowerCase()))return c;for(const T of E)if(c.match(T[0]))return T[1]!==void 0?c.replace(T[0],T[1]):c;return c}function O(c,E){return I(c,o,i,E)}function A(c,E){return I(c,r,i,E)}function L(c,E,R,b){return isNaN(E)?c:E===1?I(c,r,i,R):I(c,o,i,b)}function H(c,E){const R=c.split("/"),b=R.length;let T,h,V,W;for(let Z=0;Z<b;Z++){for(T=R[Z].split("_"),h=0,V=T.length;h<V;h++)h!==0&&(T[h]=T[h].toLowerCase()),W=T[h].charAt(0),W=E&&Z===0&&h===0?W.toLowerCase():W.toUpperCase(),T[h]=W+T[h].substring(1);R[Z]=T.join("")}return R.join("::")}function w(c,E){if(E&&c===c.toUpperCase())return c;const R=c.split("::"),b=R.length;for(let T=0;T<b;T++)R[T]=R[T].replace(m,"_$1"),R[T]=R[T].replace(v,"");return R.join("/").toLowerCase()}function U(c,E){return c=c.toLowerCase(),c=c.replace(_,""),c=c.replace(l," "),E||(c=N(c)),c}function N(c){return c=c.toLowerCase(),c.substring(0,1).toUpperCase()+c.substring(1)}function D(c){return c.replace(u,"-")}function k(c){c=c.toLowerCase().replace(l," ");const E=c.split(" "),R=E.length;let b,T;for(let h=0;h<R;h++){b=E[h].split("-"),T=b.length;for(let V=0;V<T;V++)d.indexOf(b[V].toLowerCase())<0&&(b[V]=N(b[V]));E[h]=b.join("-")}return c=E.join(" "),c=c.substring(0,1).toUpperCase()+c.substring(1),c}function $(c){const E=c.split("::");return E[E.length-1]}function S(c){return c=w(c),c=O(c),c}function f(c){return c=H(c),c=A(c),c}function P(c,E){return c=$(c),c=w(c)+(E?"":"_")+"id",c}function X(c){const E=c.split(" "),R=E.length;for(let b=0;b<R;b++){const T=parseInt(E[b],10);if(!isNaN(T)){const h=E[b].substring(E[b].length-2),V=E[b].substring(E[b].length-1);let W="th";h!="11"&&h!="12"&&h!="13"&&(V==="1"?W="st":V==="2"?W="nd":V==="3"&&(W="rd")),E[b]+=W}}return E.join(" ")}const Se={pluralize:O,singularize:A,camelize:H,underscore:w,humanize:U,capitalize:N,dasherize:D,titleize:k,demodulize:$,tableize:S,classify:f,foreignKey:P,ordinalize:X};function he(c,E){const R=E.length;for(let b=0;b<R;b++){const T=E[b],h=Se[T];h&&(c=h(c))}return c}return M}var ve=De();function we(i,e,o){var r=o||{},d=r.noTrailing,_=d===void 0?!1:d,l=r.noLeading,u=l===void 0?!1:l,m=r.debounceMode,v=m===void 0?void 0:m,I,O=!1,A=0;function L(){I&&clearTimeout(I)}function H(U){var N=U||{},D=N.upcomingOnly,k=D===void 0?!1:D;L(),O=!k}function w(){for(var U=arguments.length,N=new Array(U),D=0;D<U;D++)N[D]=arguments[D];var k=this,$=Date.now()-A;if(O)return;function S(){A=Date.now(),e.apply(k,N)}function f(){I=void 0}!u&&v&&!I&&S(),L(),v===void 0&&$>i?u?(A=Date.now(),_||(I=setTimeout(v?f:S,i))):S():_!==!0&&(I=setTimeout(v?f:S,v===void 0?i-$:i))}return w.cancel=H,w}function Le(i,e,o){var r={},d=r.atBegin,_=d===void 0?!1:d;return we(i,e,{debounceMode:_!==!1})}var a=a||{};a.LAST_CHAR=225;a.BLANK=32;a.MILLIOHM=98;a.BATT=99;a.RSSI=1;a.AH_RIGHT=301;a.AH_LEFT=300;a.THR=149;a.VOLT=31;a.AH_DECORATION_UP=21;a.AH_DECORATION_DOWN=22;a.WIND_SPEED_HORIZONTAL=134;a.WIND_SPEED_VERTICAL=135;a.FLY_M=159;a.ON_M=158;a.AH_CENTER_LINE=314;a.AH_CENTER_LINE_RIGHT=315;a.AH_BAR9_0=332;a.AZIMUTH=5;a.AH_DECORATION=305;a.AMP=106;a.MAH=153;a.WH=109;a.WATT=113;a.MAH_KM_0=107;a.MAH_KM_1=108;a.MAH_MI_0=147;a.MAH_MI_1=148;a.AH_V_FT_0=214;a.AH_V_FT_1=215;a.AH_V_M_0=216;a.AH_V_M_1=217;a.WH_KM=110;a.WH_MI=111;a.GPS_SAT1=8;a.GPS_SAT2=9;a.GPS_HDP1=14;a.GPS_HDP2=15;a.KM=131;a.KMH=144;a.KMH_3D=136;a.MPH=145;a.MPH_3D=137;a.ALT_M=118;a.ALT_FT=120;a.LAT=3;a.LON=4;a.AIR=140;a.DIRECTION=23;a.DIR_TO_HOME=316;a.SCALE=13;a.DIST_KM=126;a.DIST_MI=128;a.M=130;a.MI=132;a.HOME=16;a.TRIP_DIST=117;a.HEADING=12;a.DEGREES=11;a.HEADING_N=200;a.HEADING_E=202;a.HEADING_W=203;a.HEADING_DIVIDED_LINE=204;a.HEADING_LINE=205;a.VARIO_UP_2A=341;a.THROTTLE_GAUGE_EMPTY=363;a.THROTTLE_GAUGE_FULL=365;a.M_S=143;a.FT_S=141;a.CLOCK=160;a.ZERO_HALF_TRAILING_DOT=161;a.ZERO_HALF_LEADING_DOT=177;a.ROLL_LEFT=173;a.ROLL_LEVEL=174;a.ROLL_RIGHT=175;a.PITCH_UP=176;a.PITCH_DOWN=187;a.TEMP_C=151;a.TEMP_F=150;a.BARO_TEMP=192;a.IMU_TEMP=193;a.TEMP=194;a.GFORCE=188;a.GFORCE_X=189;a.GFORCE_Y=190;a.GFORCE_Z=191;a.RPM=139;a.ESC_TEMPERATURE=195;a.RSS2=17;a.DB=18;a.DBM=19;a.MW=114;a.SNR=20;a.LQ=2;a.GLIDESLOPE=156;a.DIST_NM=129;a.NM=133;a.KT_3D=138;a.KT=146;a.HUND_FTM=142;a.MAH_NM_0=96;a.MAH_NM_1=97;a.AH_NM=63;a.WH_NM=112;a.VTX_POWER=39;a.MAX=206;a.PROFILE=207;a.SWITCH_INDICATOR_HIGH=210;a.GLIDE_MINS=213;a.GLIDE_RANGE=212;a.FLIGHT_MINS_REMAINING=218;a.FLIGHT_DIST_REMAINING=359;a.GROUND_COURSE=220;a.ALERT=221;a.CROSS_TRACK_ERROR=252;a.ADSB=253;a.PAN_SERVO_IS_OFFSET_L=455;a.ODOMETER=360;a.BLACKBOX=254;a.PILOT_LOGO_SML_L=469;a.PILOT_LOGO_SML_C=470;a.PILOT_LOGO_SML_R=471;a.MIN_GND_SPEED=222;a.AH_AIRCRAFT0=418;a.AH_AIRCRAFT1=419;a.AH_AIRCRAFT2=420;a.AH_AIRCRAFT3=421;a.AH_AIRCRAFT4=422;a.SYM_HUD_SIGNAL_3=355;a.SYM_HUD_CARDINAL=442;a.RX_BAND=361;a.RX_MODE=362;a.AH_CROSSHAIRS=new Array(358,420,new Array(400,401,402),new Array(403,404,405),new Array(406,407,408),new Array(409,410,411),new Array(412,413,414),new Array(415,416,417));var y=null,ge=!1,t=t||{},J={layout:[],filled:!1},t=t||{};t.initData=function(){t.data||(t.data={loaded_font_file:"default",characters_bytes:[],characters:[],character_image_urls:[]})};t.constants={SIZES:{MAX_NVM_FONT_CHAR_SIZE:54,MAX_NVM_FONT_CHAR_FIELD_SIZE:64,CHAR_HEIGHT:18,CHAR_WIDTH:12,LINE:30},COLORS:{0:"rgba(0, 0, 0, 1)",1:"rgba(255, 255, 255, 0)",2:"rgba(255,255,255, 1)"}};t.parseMCMFontFile=function(i){if(i=i.split(`
`),t.data.characters.length=0,t.data.characters_bytes.length=0,t.data.character_image_urls.length=0,i.shift().trim()!="MAX7456"){var e="that font file doesn't have the MAX7456 header, giving up";console.debug(e),Promise.reject(e)}var o=[],r=[];t.data.hexstring=[];for(var d=function(){t.data.characters_bytes.push(r),t.data.characters.push(o),t.draw(t.data.characters.length-1),o=[],r=[]},_=0;_<i.length;_++){var l=i[_];t.data.hexstring.push("0x"+parseInt(l,2).toString(16)),o.length==t.constants.SIZES.MAX_NVM_FONT_CHAR_FIELD_SIZE*(8/2)&&d();for(var u=0;u<8;u=u+2){var m=parseInt(l.slice(u,u+2),2);o.push(m)}r.push(parseInt(l,2))}return d(),t.data.characters};t.openFontFile=function(i){return new Promise(function(e){var o={filters:[{name:"Font file",extensions:["mcm"]}]};Ce.showOpenDialog(o).then(r=>{if(r.canceled){console.log("No file selected");return}r.filePaths.length==1&&window.electronAPI.readFile(r.filePaths[0]).then(d=>{if(d.error){B.log(C.getMessage("ErrorReadingFile")),console.log(d.error);return}t.parseMCMFontFile(d.data.toString()),e()})}).catch(r=>{console.log(r)})})};var Ne=function(i){var e=document.createElement("canvas"),o=e.getContext("2d"),r=r||1,d=r*t.constants.SIZES.CHAR_WIDTH,_=r*t.constants.SIZES.CHAR_HEIGHT;e.width=d,e.height=_;for(var l=0;l<_;l++)for(var u=0;u<d;u++){i in t.data.characters||console.log("charAddress",i," is not in ",t.data.characters.length);var m=t.data.characters[i][l*d+u];o.fillStyle=t.constants.COLORS[m],o.fillRect(u,l,r,r)}return e};t.draw=function(i){var e=t.data.character_image_urls[i];return e||(e=t.data.character_image_urls[i]=Ne(i).toDataURL("image/png")),e};t.blank=function(){var i=t.constants.SIZES.MAX_NVM_FONT_CHAR_SIZE;return Array.apply(null,{length:i}).map(function(){return a.BLANK})};t.msp={encode:function(i){var e=[];i>255?e.push16(i):e.push8(i);var o=t.data.characters_bytes[i];return o||(o=t.blank()),e.concat(o.slice(0,t.constants.SIZES.MAX_NVM_FONT_CHAR_SIZE))}};t.upload=function(i){for(var e=512,o=[],r=0;r<e;r++){var d=r<256?r+256:r-256;o.push(d)}o.reduce(function(_,l,u){return _.then(function(){i&&i(u,e,u/e*100);var m=l<=255?x.constants.PROTOCOL_V1:x.constants.PROTOCOL_V2,v=t.msp.encode(l);return x.promise(F.MSP_OSD_CHAR_WRITE,v,m)})},Promise.resolve()).then(function(){return s.GUI.jbox.close(),x.promise(F.MSP_SET_REBOOT)})};t.preview=function(i){i.empty();for(var e=1;e<=a.LAST_CHAR;e++){var o=t.data.character_image_urls[e];i.append('<img src="'+o+'" title="0x'+e.toString(16)+" ("+e.toString(10)+') "></img> ')}};t.symbol=function(i){return String.fromCharCode(i)};t.embed_dot=function(i){var e=48,o=i.replace(/\d\.\d/,function(r){var d=r.charCodeAt(0)+a.ZERO_HALF_TRAILING_DOT-e,_=r.charCodeAt(2)+a.ZERO_HALF_LEADING_DOT-e;return t.symbol(d)+t.symbol(_)});return o};var s=s||{};function oe(i){switch(s.data.preferences.units){case 0:case 3:case 4:return"ft";default:return"m"}}function re(i,e){switch(s.data.preferences.units){case 0:case 3:case 4:return Math.round(e*3.28084);default:return e}}function le(i,e){switch(s.data.preferences.units){case 0:case 3:case 4:return Math.round(e/3.28084);default:return e}}function de(i,e){var o=1e4;switch(s.data.preferences.units){case 0:case 3:case 4:return Math.trunc(o*3.28084);default:return o}}function _e(i){return function(e,o){return i(e,o)}}function ue(){var i="16.8";return G.getInputValue("osd_main_voltage_decimals")==2&&(i+="3"),i+=t.symbol(a.VOLT),t.symbol(a.BATT)+t.embed_dot(i)}function Pe(){var i=t.symbol(a.BLANK)+"114";switch(G.getInputValue("osd_decimals_altitude")==4&&(i+="3"),G.getInputValue("osd_decimals_altitude")==5&&(i+="38"),s.data.preferences.units){case 0:case 3:case 4:i+=t.symbol(a.ALT_FT);default:i+=t.symbol(a.ALT_M)}return i}function xe(){return ie(a.FLIGHT_DIST_REMAINING)}function Ge(){return ie(a.HOME)}function He(){return ie(a.TRIP_DIST)}function ie(i){var e="24.9";switch(G.getInputValue("osd_decimals_distance")==4&&(e+="3"),G.getInputValue("osd_decimals_distance")==5&&(e="1"+e+"6"),e=t.embed_dot(e),s.data.preferences.units){case 0:case 3:e+=t.symbol(a.DIST_MI);break;case 4:e+=t.symbol(a.DIST_NM);break;default:e+=t.symbol(a.DIST_KM);break}return e=t.symbol(i)+e,e}function ce(){let i=G.getInputValue("osd_mah_precision"),e=Math.floor(1e13+Math.random()*9e13).toString();return e=e.replace("0",""),e.substring(0,i)+t.symbol(a.MAH)}function me(i,e){return function(){var o=G.getInputValue("osd_coordinate_digits");o||(o=11);var r=(""+parseInt(e)).length;return t.symbol(i)+t.embed_dot(e.toFixed(o-r))}}s.initData=function(){s.data={supported:!1,preferences:{video_system:null,main_voltage_decimals:null,ahi_reverse_roll:null,crosshairs_style:null,left_sidebar_scroll:null,right_sidebar_scroll:null,sidebar_scroll_arrows:null,units:null,stats_energy_unit:null,adsb_warning_style:null},alarms:{rssi:null,batt_cap:null,fly_minutes:null,max_altitude:null,dist:null,max_neg_altitude:null,gforce:null,gforce_axis_min:null,gforce_axis_max:null,current:null,imu_temp_alarm_min:null,imu_temp_alarm_max:null,baro_temp_alarm_min:null,baro_temp_alarm_max:null,adsb_distance_warning:null,adsb_distance_alert:null},layouts:[],layout_count:1,item_count:0,items:[],groups:{},preview:[]}};s.DjiElements={supported:["RSSI_VALUE","MAIN_BATT_VOLTAGE","MAIN_BATT_CELL_VOLTAGE","CRAFT_NAME","FLYMODE","ESC_TEMPERATURE","ALTITUDE","VERTICAL_SPEED_INDICATOR","CROSSHAIRS","HORIZON_SIDEBARS","PITCH_ANGLE","ROLL_ANGLE","CURRENT_DRAW","MAH_DRAWN","GPS_SPEED","GPS_SATS","LONGITUDE","LATITUDE","DIRECTION_TO_HOME","DISTANCE_TO_HOME"],emptyGroups:["MapsAndRadars","GForce","Timers","VTX","RX","SwitchIndicators","OSDCustomElements","GVars","PIDs","PIDOutputs","PowerLimits"],supportedSettings:["craft_name","units"],supportedAlarms:["rssi_alarm","osd_alt_alarm"],craftNameElements:["MESSAGES","THROTTLE_GAUGE","THROTTLE_POSITION","SCALED_THROTTLE_POSITION","3D_SPEED","EFFICIENCY_MAH","TRIP_DIST"]};s.constants={VISIBLE:8192,VIDEO_TYPES:["AUTO","PAL","NTSC","HDZERO","DJIWTF","AVATAR","BF43COMPAT","BFHDCOMPAT","DJI_NATIVE"],VIDEO_LINES:{PAL:16,NTSC:13,HDZERO:18,DJIWTF:22,AVATAR:20,BF43COMPAT:16,BFHDCOMPAT:20,DJI_NATIVE:20},VIDEO_COLS:{PAL:30,NTSC:30,HDZERO:50,DJIWTF:60,AVATAR:53,BF43COMPAT:30,BFHDCOMPAT:53,DJI_NATIVE:53},VIDEO_BUFFER_CHARS:{PAL:480,NTSC:390,HDZERO:900,DJIWTF:1320,AVATAR:1060,BF43COMPAT:480,BFHDCOMPAT:1060,DJI_NATIVE:1060},UNIT_TYPES:[{name:"osdUnitImperial",value:0},{name:"osdUnitMetric",value:1},{name:"osdUnitMetricMPH",tip:"osdUnitMetricMPHTip",value:2},{name:"osdUnitUK",tip:"osdUnitUKTip",value:3},{name:"osdUnitGA",tip:"osdUnitGATip",value:4}],AHISIDEBARWIDTHPOSITION:7,AHISIDEBARHEIGHTPOSITION:3,ADSB_WARNING_STYLE:{COMPACT:0,EXTENDED:1},ALL_ALARMS:[{name:"RSSI",field:"rssi",unit:"%",min:0,max:100},{name:"BATT_CAP",field:"batt_cap",unit:"mah",min:0,max:4294967295},{name:"FLY_MINUTES",field:"fly_minutes",unit:"minutes",min:0,max:600},{name:"MAX_ALTITUDE",field:"max_altitude",unit:oe,to_display:_e(re),from_display:_e(le),min:0,max:de},{name:"MAX_NEG_ALTITUDE",field:"max_neg_altitude",unit:oe,to_display:re,from_display:le,min:0,max:de},{name:"DIST",field:"dist",unit:function(i){switch(s.data.preferences.units){case 0:case 3:return"mi";case 4:return"NM";default:return"m"}},to_display:function(i,e){switch(s.data.preferences.units){case 0:case 3:return(e/1609.344).toFixed(2);case 4:return(e/1852.001).toFixed(2);default:return e}},from_display:function(i,e){switch(s.data.preferences.units){case 0:case 3:return Math.round(e*1609.344);case 4:return Math.round(e*1852.001);default:return e}},step:function(i){switch(s.data.preferences.units){case 0:case 3:case 4:return .01;default:return 1}},min:0,max:function(i){var e=5e4;switch(s.data.preferences.units){case 0:case 3:return Math.trunc(e/1609.344);case 4:return Math.trunc(e/1852.001);default:return e}}},{name:"GFORCE",field:"gforce",min_version:"2.2.0",step:.1,unit:"g",to_display:function(i,e){return e/1e3},from_display:function(i,e){return e*1e3},min:0,max:20},{name:"GFORCE_AXIS_MIN",field:"gforce_axis_min",min_version:"2.2.0",step:.1,unit:"g",to_display:function(i,e){return e/1e3},from_display:function(i,e){return e*1e3},min:-20,max:20},{name:"GFORCE_AXIS_MAX",field:"gforce_axis_max",min_version:"2.2.0",step:.1,unit:"g",to_display:function(i,e){return e/1e3},from_display:function(i,e){return e*1e3},min:-20,max:20},{name:"CURRENT",field:"current",min_version:"2.2.0",step:1,unit:"A",min:0,max:255},{name:"IMU_TEMPERATURE_MIN",field:"imu_temp_alarm_min",unit:"째C",step:.5,to_display:function(i,e){return e/10},from_display:function(i,e){return e*10},min:-55,max:125},{name:"IMU_TEMPERATURE_MAX",field:"imu_temp_alarm_max",step:.5,unit:"째C",to_display:function(i,e){return e/10},from_display:function(i,e){return e*10},min:-55,max:125},{name:"BARO_TEMPERATURE_MIN",field:"baro_temp_alarm_min",step:.5,unit:"째C",to_display:function(i,e){return e/10},from_display:function(i,e){return e*10},min:-55,max:125},{name:"BARO_TEMPERATURE_MAX",field:"baro_temp_alarm_max",step:.5,unit:"째C",to_display:function(i,e){return e/10},from_display:function(i,e){return e*10},min:-55,max:125},{name:"ADSB_MAX_DISTANCE_WARNING",field:"adsb_distance_warning",step:1,unit:"meters",min:1,max:64e3,min_version:"7.1.0"},{name:"ADSB_MAX_DISTANCE_ALERT",field:"adsb_distance_alert",step:1,unit:"meters",min:1,max:64e3,min_version:"7.1.0"}],ALL_DISPLAY_GROUPS:[{name:"osdGroupGeneral",items:[{name:"RSSI_VALUE",id:0,preview:t.symbol(a.RSSI)+"99"},{name:"MAIN_BATT_VOLTAGE",id:1,preview:ue},{name:"SAG_COMP_MAIN_BATT_VOLTAGE",id:53,preview:ue},{name:"MAIN_BATT_CELL_VOLTAGE",id:32,preview:t.symbol(a.BATT)+t.embed_dot("3.90")+t.symbol(a.VOLT)},{name:"SAG_COMP_MAIN_BATT_CELL_VOLTAGE",id:54,preview:t.symbol(a.BATT)+t.embed_dot("4.18")+t.symbol(a.VOLT)},{name:"POWER_SUPPLY_IMPEDANCE",id:55,preview:" 23"+t.symbol(a.MILLIOHM)},{name:"MAIN_BATT_REMAINING_PERCENTAGE",id:38,preview:t.symbol(a.BATT)+"100%"},{name:"REMAINING_FLIGHT_TIME",id:48,preview:t.symbol(a.FLIGHT_MINS_REMAINING)+"10:35"},{name:"REMAINING_FLIGHT_DISTANCE",id:49,preview:xe},{name:"THROTTLE_GAUGE",id:168,preview:t.symbol(a.THROTTLE_GAUGE_EMPTY)+`
`+t.symbol(a.THROTTLE_GAUGE_EMPTY)+`
`+t.symbol(a.THROTTLE_GAUGE_FULL)+`
`+t.symbol(a.THROTTLE_GAUGE_FULL)+`
`+t.symbol(a.THROTTLE_GAUGE_FULL)+`
`},{name:"THROTTLE_POSITION",id:9,preview:" "+t.symbol(a.THR)+" 69"},{name:"SCALED_THROTTLE_POSITION",id:33,preview:t.symbol(a.SCALE)+t.symbol(a.THR)+" 51"},{name:"CRAFT_NAME",id:8,preview:"[CRAFT_NAME]"},{name:"PILOT_NAME",id:142,preview:"[PILOT_NAME]"},{name:"PILOT_LOGO",id:146,preview:t.symbol(a.PILOT_LOGO_SML_L)+t.symbol(a.PILOT_LOGO_SML_C)+t.symbol(a.PILOT_LOGO_SML_R)},{name:"FLYMODE",id:7,preview:"ACRO"},{name:"MESSAGES",id:30,preview:"       SYSTEM MESSAGE       "},{name:"HEADING",id:24,preview:t.symbol(a.HEADING)+"175"+t.symbol(a.DEGREES)},{name:"HEADING_GRAPH",id:34,preview:t.symbol(a.HEADING_W)+t.symbol(a.HEADING_LINE)+t.symbol(a.HEADING_DIVIDED_LINE)+t.symbol(a.HEADING_LINE)+t.symbol(a.HEADING_N)+t.symbol(a.HEADING_LINE)+t.symbol(a.HEADING_DIVIDED_LINE)+t.symbol(a.HEADING_LINE)+t.symbol(a.HEADING_E)},{name:"AIR_SPEED",id:27,enabled:function(){return g.capabilities.usePitot},preview:function(i){var e;switch(s.data.preferences.units){case 0:case 2:case 3:e="115"+t.symbol(a.MPH);break;case 4:e="100"+t.symbol(a.KT);break;default:e="185"+t.symbol(a.KMH);break}return t.symbol(a.AIR)+e}},{name:"MIN_GROUND_SPEED",id:167,preview:function(i){var e;switch(s.data.preferences.units){case 0:case 2:case 3:e=" 22"+t.symbol(a.MPH);break;case 4:e=" 19"+t.symbol(a.KT);break;default:e=" 35"+t.symbol(a.KMH);break}return t.symbol(a.MIN_GND_SPEED)+e}},{name:"AIR_MAX_SPEED",id:127,enabled:function(){return g.capabilities.usePitot},preview:function(i){switch(s.data.preferences.units){case 0:case 2:case 3:return t.symbol(a.MAX)+t.symbol(a.AIR)+t.embed_dot("135")+t.symbol(a.MPH);case 4:return t.symbol(a.MAX)+t.symbol(a.AIR)+t.embed_dot("177")+t.symbol(a.KT);default:return t.symbol(a.MAX)+t.symbol(a.AIR)+t.embed_dot("217")+t.symbol(a.KMH)}}},{name:"RTC_TIME",id:29,preview:t.symbol(a.CLOCK)+"13:37:25"},{name:"RC_SOURCE",id:104,preview:"MSP"},{name:"ESC_RPM",id:106,min_version:"2.3.0",enabled:function(){return g.capabilities.useESCTelemetry},preview:function(){let i="112974".substr(6-parseInt(G.getInputValue("osd_esc_rpm_precision")));return t.symbol(a.RPM)+i}},{name:"GLIDESLOPE",id:124,min_version:"3.0.0",preview:t.symbol(a.GLIDESLOPE)+t.embed_dot("12.3")},{name:"GLIDE_TIME",id:136,min_version:"5.0.0",preview:t.symbol(a.GLIDE_MINS)+"02:34"},{name:"GLIDE_RANGE",id:137,min_version:"5.0.0",preview:function(i){switch(s.data.preferences.units){case 0:case 3:return t.symbol(a.GLIDE_RANGE)+t.embed_dot(" 12")+t.symbol(a.MI);case 4:return t.symbol(a.GLIDE_RANGE)+t.embed_dot(" 11")+t.symbol(a.NM);default:return t.symbol(a.GLIDE_RANGE)+t.embed_dot(" 21")+t.symbol(a.KM)}}},{name:"PAN_SERVO_CENTRED",id:143,min_version:"6.0.0",preview:t.symbol(a.PAN_SERVO_IS_OFFSET_L)+"120"+t.symbol(a.DEGREES)},{name:"MISSION INFO",id:129,min_version:"4.0.0",preview:"M1/6>101WP"},{name:"VERSION",id:119,min_version:"3.0.0",preview:"INAV 2.7.0"},{name:"MULTI FUNCTION STATUS",id:144,min_version:"6.0.0",preview:"0 WARNINGS"},{name:"BLACKBOX",id:152,min_version:"8.0.0",preview:function(i){return t.symbol(a.BLACKBOX)+t.embed_dot("000123")}}]},{name:"osdGroupTemperature",items:[{name:"IMU_TEMPERATURE",id:86,preview:function(i){switch(s.data.preferences.units){case 0:return t.symbol(a.IMU_TEMP)+" 90"+t.symbol(a.TEMP_F);default:return t.symbol(a.IMU_TEMP)+" 32"+t.symbol(a.TEMP_C)}}},{name:"BARO_TEMPERATURE",id:87,enabled:function(){return g.capabilities.useBaro},preview:function(i){switch(s.data.preferences.units){case 0:return t.symbol(a.BARO_TEMP)+" 90"+t.symbol(a.TEMP_F);default:return t.symbol(a.BARO_TEMP)+" 32"+t.symbol(a.TEMP_C)}}},{name:"ESC_TEMPERATURE",id:107,min_version:"2.5.0",enabled:function(){return g.capabilities.useESCTelemetry},preview:function(i){switch(s.data.preferences.units){case 0:return t.symbol(a.ESC_TEMPERATURE)+" 98"+t.symbol(a.TEMP_F);default:return t.symbol(a.ESC_TEMPERATURE)+" 38"+t.symbol(a.TEMP_C)}}},{name:"SENSOR1_TEMPERATURE",id:88,preview:function(i){switch(s.data.preferences.units){case 0:return" 90"+t.symbol(a.TEMP_F);default:return" 32"+t.symbol(a.TEMP_C)}}},{name:"SENSOR2_TEMPERATURE",id:89,preview:function(i){switch(s.data.preferences.units){case 0:return" 90"+t.symbol(a.TEMP_F);default:return" 32"+t.symbol(a.TEMP_C)}}},{name:"SENSOR3_TEMPERATURE",id:90,preview:function(i){switch(s.data.preferences.units){case 0:return" 90"+t.symbol(a.TEMP_F);default:return" 32"+t.symbol(a.TEMP_C)}}},{name:"SENSOR4_TEMPERATURE",id:91,preview:function(i){switch(s.data.preferences.units){case 0:return" 90"+t.symbol(a.TEMP_F);default:return" 32"+t.symbol(a.TEMP_C)}}},{name:"SENSOR5_TEMPERATURE",id:92,preview:function(i){switch(s.data.preferences.units){case 0:return" 90"+t.symbol(a.TEMP_F);default:return" 32"+t.symbol(a.TEMP_C)}}},{name:"SENSOR6_TEMPERATURE",id:93,preview:function(i){switch(s.data.preferences.units){case 0:return" 90"+t.symbol(a.TEMP_F);default:return" 32"+t.symbol(a.TEMP_C)}}},{name:"SENSOR7_TEMPERATURE",id:94,preview:function(i){switch(s.data.preferences.units){case 0:return" 90"+t.symbol(a.TEMP_F);default:return" 32"+t.symbol(a.TEMP_C)}}},{name:"SENSOR8_TEMPERATURE",id:95,preview:function(i){switch(s.data.preferences.units){case 0:return" 90"+t.symbol(a.TEMP_F);default:return" 32"+t.symbol(a.TEMP_C)}}}]},{name:"osdGroupAltitude",items:[{name:"ALTITUDE",id:15,preview:Pe},{name:"VARIO",id:25,preview:t.symbol(a.VARIO_UP_2A)+`
`+t.symbol(a.VARIO_UP_2A)+`
`+t.symbol(a.VARIO_UP_2A)+`
`+t.symbol(a.VARIO_UP_2A)+`
`+t.symbol(a.VARIO_UP_2A)+`
`},{name:"VERTICAL_SPEED_INDICATOR",id:26,preview:function(i){switch(s.data.preferences.units){case 0:case 3:return t.embed_dot("-1.6")+t.symbol(a.FT_S);case 4:return t.embed_dot("-2.6")+t.symbol(a.HUND_FTM);default:return t.embed_dot("-0.5")+t.symbol(a.M_S)}}},{name:"OSD_RANGEFINDER",id:120,preview:function(i){switch(s.data.preferences.units){case 0:case 3:return t.embed_dot("15.9")+t.symbol(a.DIST_MI);case 4:return t.embed_dot("13.8")+t.symbol(a.DIST_NM);default:return t.embed_dot("25.6")+t.symbol(a.DIST_KM)}}}]},{name:"osdGroupGForce",items:[{name:"G_FORCE",id:100,min_version:"2.2.0",preview:t.symbol(a.GFORCE)+t.embed_dot("1.00")},{name:"G_FORCE_X",id:101,min_version:"2.2.0",preview:t.symbol(a.GFORCE_X)+t.embed_dot("-0.10")},{name:"G_FORCE_Y",id:102,min_version:"2.2.0",preview:t.symbol(a.GFORCE_Y)+t.embed_dot("-0.20")},{name:"G_FORCE_Z",id:103,min_version:"2.2.0",preview:t.symbol(a.GFORCE_Z)+t.embed_dot("-0.30")}]},{name:"osdGroupTimers",items:[{name:"ONTIME_FLYTIME",id:28,preview:t.symbol(a.FLY_M)+"04:11"},{name:"ONTIME",id:5,preview:t.symbol(a.ON_M)+"04:11"},{name:"FLYTIME",id:6,preview:t.symbol(a.FLY_M)+"04:11"}]},{name:"osdGroupAttitude",items:[{name:"CROSSHAIRS",id:2,positionable:!1},{name:"ARTIFICIAL_HORIZON",id:3,positionable:!1},{name:"HORIZON_SIDEBARS",id:4,positionable:!1},{name:"PITCH_ANGLE",id:41,preview:function(){return t.symbol(a.PITCH_UP)+t.embed_dot(" 1.5")}},{name:"ROLL_ANGLE",id:42,preview:function(){return t.symbol(a.ROLL_LEFT)+t.embed_dot("31.4")}}]},{name:"osdGroupCurrentMeter",enabled:function(){return p.isFeatureEnabled("CURRENT_METER")},items:[{name:"CURRENT_DRAW",id:11,preview:function(){return t.embed_dot("42.1")+t.symbol(a.AMP)}},{name:"MAH_DRAWN",id:12,preview:function(){return ce()}},{name:"WH_DRAWN",id:36,preview:function(){return t.embed_dot("1.25")+t.symbol(a.WH)}},{name:"POWER",id:19,preview:function(){return" 69"+t.symbol(a.WATT)}},{name:"MAIN_BATT_REMAINING_CAPACITY",id:37,preview:function(){return ce()}},{name:"EFFICIENCY_MAH",id:35,preview:function(i){switch(s.data.preferences.units){case 0:case 3:return"116"+t.symbol(a.MAH_MI_0)+t.symbol(a.MAH_MI_1);case 4:return"101"+t.symbol(a.MAH_NM_0)+t.symbol(a.MAH_NM_1);default:return"187"+t.symbol(a.MAH_KM_0)+t.symbol(a.MAH_KM_1)}}},{name:"EFFICIENCY_WH",id:39,preview:function(i){switch(s.data.preferences.units){case 0:case 3:return t.embed_dot("0.76")+t.symbol(a.WH_MI);case 4:return t.embed_dot("0.66")+t.symbol(a.WH_NM);default:return t.embed_dot("1.23")+t.symbol(a.WH_KM)}}},{name:"CLIMB_EFFICIENCY",id:138,min_version:"5.0.0",preview:function(i){switch(s.data.preferences.units){case 0:case 3:case 4:return t.embed_dot("0.76")+t.symbol(a.AH_V_FT_0)+t.symbol(a.AH_V_FT_1);default:return t.embed_dot("1.23")+t.symbol(a.AH_V_M_0)+t.symbol(a.AH_V_M_1)}}}]},{name:"osdGroupPowerLimits",items:[{name:"PLIMIT_REMAINING_BURST_TIME",id:121,preview:t.embed_dot("10.0S")},{name:"PLIMIT_ACTIVE_CURRENT_LIMIT",id:122,preview:t.embed_dot("42.1")+t.symbol(a.AMP)},{name:"PLIMIT_ACTIVE_POWER_LIMIT",id:123,preview:"500"+t.symbol(a.WATT)}]},{name:"osdGroupGPS",enabled:function(){return p.isFeatureEnabled("GPS")},items:[{name:"MSL_ALTITUDE",id:96,preview:function(i){switch(s.data.preferences.units){case 0:case 3:case 4:return" 375"+t.symbol(a.ALT_FT);default:return" 114"+t.symbol(a.ALT_M)}}},{name:"GPS_SPEED",id:13,preview:function(i){switch(s.data.preferences.units){case 0:case 2:case 3:return t.embed_dot("115")+t.symbol(a.MPH);case 4:return t.embed_dot("100")+t.symbol(a.KT);default:return t.embed_dot("185")+t.symbol(a.KMH)}}},{name:"3D_SPEED",id:85,preview:function(i){switch(s.data.preferences.units){case 0:case 2:case 3:return t.embed_dot("127")+t.symbol(a.MPH_3D);case 4:return t.embed_dot("110")+t.symbol(a.KT_3D);default:return t.embed_dot("204")+t.symbol(a.KMH_3D)}}},{name:"GPS_MAX_SPEED",id:125,preview:function(i){switch(s.data.preferences.units){case 0:case 2:case 3:return t.symbol(a.MAX)+t.embed_dot("138")+t.symbol(a.MPH);case 4:return t.symbol(a.MAX)+t.embed_dot("120")+t.symbol(a.KT);default:return t.symbol(a.MAX)+t.embed_dot("222")+t.symbol(a.KMH)}}},{name:"3D_MAX_SPEED",id:126,preview:function(i){switch(s.data.preferences.units){case 0:case 2:case 3:return t.symbol(a.MAX)+t.embed_dot("150")+t.symbol(a.MPH_3D);case 4:return t.symbol(a.MAX)+t.embed_dot("130")+t.symbol(a.KT_3D);default:return t.symbol(a.MAX)+t.embed_dot("241")+t.symbol(a.KMH_3D)}}},{name:"GPS_SATS",id:14,preview:t.symbol(a.GPS_SAT1)+t.symbol(a.GPS_SAT2)+"14"},{name:"LONGITUDE",id:20,preview:me(a.LON,-114.7652134)},{name:"LATITUDE",id:21,preview:me(a.LAT,52.9872367)},{name:"PLUS_CODE",id:97,preview:function(){let i=parseInt(G.getInputValue("osd_plus_code_digits"))+1,e=parseInt(G.getInputValue("osd_plus_code_short"))*2;return console.log("DITIS",i),"9547X6PM+VWCCC".substr(e,i-e)}},{name:"DIRECTION_TO_HOME",id:22,preview:t.symbol(a.DIR_TO_HOME)},{name:"HOME_HEADING_ERROR",id:50,preview:t.symbol(a.HOME)+t.symbol(a.HEADING)+" -10"+t.symbol(a.DEGREES)},{name:"AZIMUTH",id:108,preview:t.symbol(a.AZIMUTH)+"120"+t.symbol(a.DEGREES)},{name:"DISTANCE_TO_HOME",id:23,preview:Ge},{name:"TRIP_DIST",id:40,min_version:"1.9.1",preview:He},{name:"ODOMETER",id:145,min_version:"6.1.0",preview:function(i){switch(s.data.preferences.units){case 0:case 3:return t.symbol(a.ODOMETER)+t.embed_dot("00016.9")+t.symbol(a.DIST_MI);case 4:return t.symbol(a.ODOMETER)+t.embed_dot("00014.7")+t.symbol(a.DIST_NM);default:return t.symbol(a.ODOMETER)+t.embed_dot("00027.2")+t.symbol(a.DIST_KM)}}},{name:"GPS_HDOP",id:31,preview:t.symbol(a.GPS_HDP1)+t.symbol(a.GPS_HDP2)+t.embed_dot("1.8")},{name:"WIND_SPEED_HORIZONTAL",id:46,preview:function(i){var e=t.symbol(a.WIND_SPEED_HORIZONTAL)+t.symbol(a.DIRECTION+1);switch(s.data.preferences.units){case 0:case 2:case 3:e+=t.embed_dot("3.27")+t.symbol(a.MPH);break;case 4:e+=t.embed_dot("2.84")+t.symbol(a.KT);break;default:e+=t.embed_dot("5.26")+t.symbol(a.KMH);break}return e}},{name:"WIND_SPEED_VERTICAL",id:47,preview:function(i){var e=t.symbol(a.WIND_SPEED_VERTICAL)+t.symbol(a.AH_DECORATION_UP);switch(s.data.preferences.units){case 0:case 2:case 3:e+=t.embed_dot("1.03")+t.symbol(a.MPH);break;case 4:e+=t.embed_dot("0.90")+t.symbol(a.KT);break;default:e+=t.embed_dot("1.66")+t.symbol(a.KMH);break}return e}},{name:"COURSE_HOLD_ERROR",id:51,preview:t.symbol(a.HEADING)+"  5"+t.symbol(a.DEGREES)},{name:"COURSE_HOLD_ADJUSTMENT",id:52,preview:t.symbol(a.HEADING)+" -90"+t.symbol(a.DEGREES)},{name:"GROUND COURSE",id:140,min_version:"6.0.0",preview:t.symbol(a.GROUND_COURSE)+"245"+t.symbol(a.DEGREES)},{name:"ADSB_WARNING_MESSAGE",id:150,min_version:"7.1.0",preview:function(i){var e,o,r;switch(s.data.preferences.units){case 0:case 2:e=a.KM,o=a.M,r=a.MPH;break;case 3:e=a.MI,o=a.ALT_FT,r=a.MPH;break;case 4:e=a.MI,o=a.ALT_FT,r=a.KT;break;default:e=a.KM,o=a.M,r=a.KMH;break}var d=t.symbol(a.ADSB)+t.embed_dot("9.28")+t.symbol(e)+t.symbol(a.SYM_HUD_CARDINAL+5)+t.embed_dot("-423")+t.symbol(o);return s.data.preferences.adsb_warning_style!==null&&s.data.preferences.adsb_warning_style===s.constants.ADSB_WARNING_STYLE.EXTENDED&&(d+=`
HEAVY `+t.symbol(a.DIR_TO_HOME+1)+t.embed_dot("653")+t.symbol(r)),d}},{name:"ADSB_INFO",id:151,min_version:"7.1.0",preview:t.symbol(a.ADSB)+"2"},{name:"CROSS TRACK ERROR",id:141,min_version:"6.0.0",preview:function(i){switch(s.data.preferences.units){case 0:case 3:return t.symbol(a.CROSS_TRACK_ERROR)+t.embed_dot("0.98")+t.symbol(a.DIST_MI);case 4:return t.symbol(a.CROSS_TRACK_ERROR)+t.embed_dot("0.85")+t.symbol(a.DIST_NM);default:return t.symbol(a.CROSS_TRACK_ERROR)+t.embed_dot("1.57")+t.symbol(a.DIST_KM)}}},{name:"COURSE_NEXT_GEOZONE",id:163,min_version:"8.0.0",enabled:function(){return p.isFeatureEnabled("GEOZONE")},preview:t.symbol(a.DIR_TO_HOME)},{name:"HOR_DIST_TO_NEXT_GEOZONE",id:164,min_version:"8.0.0",enabled:function(){return p.isFeatureEnabled("GEOZONE")},preview:function(i){switch(s.data.preferences.units){case 0:case 3:return"FD  "+t.embed_dot("0.88")+t.symbol(a.DIST_MI);case 4:return"FD  "+t.embed_dot("0.78")+t.symbol(a.DIST_NM);default:return"FD  "+t.embed_dot("1.42")+t.symbol(a.DIST_KM)}}},{name:"VERT_DIST_TO_NEXT_GEOZONE",id:165,min_version:"8.0.0",enabled:function(){return p.isFeatureEnabled("GEOZONE")},preview:function(i){switch(s.data.preferences.units){case 0:case 3:case 4:return"FD  466"+t.symbol(a.ALT_FT)+t.symbol(a.DIR_TO_HOME);default:return"FD  142"+t.symbol(a.ALT_M)+t.symbol(a.DIR_TO_HOME)}}}]},{name:"osdGroupMapsAndRadars",items:[{name:"MAP_NORTH",id:43,positionable:!1},{name:"MAP_TAKEOFF",id:44,positionable:!1},{name:"RADAR",id:45,positionable:!1},{name:"MAP_SCALE",id:98,preview:function(i){var e;switch(s.data.preferences.units){case 0:case 3:e=t.embed_dot("0.10")+t.symbol(a.MI);break;case 4:e=t.embed_dot("0.08")+t.symbol(a.NM);break;default:e="100"+t.symbol(a.M);break}return t.symbol(a.SCALE)+e}},{name:"MAP_REFERENCE",id:99,preview:t.symbol(a.DIRECTION)+`
N`},{name:"FORMATION_FLIGHT",id:153,min_version:"8.0.0",positionable:!0,preview:function(i){return t.symbol(a.DIRECTION)+"B"+t.symbol(a.SYM_HUD_SIGNAL_3)+t.symbol(a.SYM_HUD_CARDINAL)+`
 150
`+t.symbol(a.AH_DECORATION_UP)+" 27"}}]},{name:"osdGroupVTX",items:[{name:"VTX_CHANNEL",id:10,positionable:!0,preview:function(i){return"CH:F7:1"}},{name:"VTX_POWER",id:105,preview:t.symbol(a.VTX_POWER)+"1"}]},{name:"osdGroupRx",enabled:function(){return g.capabilities.useRx},items:[{name:"RSSI_DBM",id:109,positionable:!0,preview:t.symbol(a.RSSI)+"-100"+t.symbol(a.DBM)},{name:"LQ_UPLINK",id:110,positionable:!0,preview:function(i){var e;return g.capabilities.useCRSF&&G.getInputValue("osd_crsf_lq_format")==1?e=t.symbol(a.LQ)+"2:100":g.capabilities.useCRSF&&G.getInputValue("osd_crsf_lq_format")==2?e=t.symbol(a.LQ)+"300":e=t.symbol(a.LQ)+"100",e}},{name:"LQ_DOWNLINK",id:159,positionable:!0,preview:t.symbol(a.LQ)+"100"+t.symbol(a.AH_DECORATION_DOWN)},{name:"SNR_DB",id:111,positionable:!0,preview:t.symbol(a.SNR)+"-12"+t.symbol(a.DB)},{name:"TX_POWER_UPLINK",id:112,positionable:!0,preview:"  10"+t.symbol(a.MW)},{name:"RX_POWER_DOWNLINK",id:160,positionable:!0,preview:"  10"+t.symbol(a.MW)+t.symbol(a.AH_DECORATION_DOWN)},{name:"RX_BAND",id:161,positionable:!0,preview:t.symbol(a.RX_BAND)+"2.4G"},{name:"RX_MODE",id:162,positionable:!0,preview:t.symbol(a.RX_MODE)+"150HZ "}]},{name:"osdGroupSwitchIndicators",items:[{name:"SWITCH_INDICATOR_0",id:130,positionable:!0,preview:"SWI1"+t.symbol(a.SWITCH_INDICATOR_HIGH)},{name:"SWITCH_INDICATOR_1",id:131,positionable:!0,preview:"SWI2"+t.symbol(a.SWITCH_INDICATOR_HIGH)},{name:"SWITCH_INDICATOR_2",id:132,positionable:!0,preview:"SWI3"+t.symbol(a.SWITCH_INDICATOR_HIGH)},{name:"SWITCH_INDICATOR_3",id:133,positionable:!0,preview:"SWI4"+t.symbol(a.SWITCH_INDICATOR_HIGH)}]},{name:"osdGroupOSDCustomElements",items:[{name:"CUSTOM_ELEMENT_1",id:147,min_version:"7.1.0",positionable:!0,preview:"CE_1"},{name:"CUSTOM_ELEMENT_2",id:148,min_version:"7.1.0",positionable:!0,preview:"CE_2"},{name:"CUSTOM_ELEMENT_3",id:149,min_version:"7.1.0",positionable:!0,preview:"CE_3"},{name:"CUSTOM_ELEMENT_4",id:154,min_version:"8.0.0",positionable:!0,preview:"CE_4"},{name:"CUSTOM_ELEMENT_5",id:155,min_version:"8.0.0",positionable:!0,preview:"CE_5"},{name:"CUSTOM_ELEMENT_6",id:156,min_version:"8.0.0",positionable:!0,preview:"CE_6"},{name:"CUSTOM_ELEMENT_7",id:157,min_version:"8.0.0",positionable:!0,preview:"CE_7"},{name:"CUSTOM_ELEMENT_8",id:158,min_version:"8.0.0",positionable:!0,preview:"CE_8"}]},{name:"osdGroupGVars",items:[{name:"GVAR_0",id:113,positionable:!0,preview:"G0:01337"},{name:"GVAR_1",id:114,positionable:!0,preview:"G1:31415"},{name:"GVAR_2",id:115,positionable:!0,preview:"G2:01611"},{name:"GVAR_3",id:116,positionable:!0,preview:"G3:30126"}]},{name:"osdGroupPIDs",items:[{name:"ACTIVE_PROFILE",id:128,preview:function(i){return t.symbol(a.PROFILE)+"1"}},{name:"ROLL_PIDS",id:16,preview:"ROL  40  30  20  23"},{name:"PITCH_PIDS",id:17,preview:"PIT  40  30  20  23"},{name:"YAW_PIDS",id:18,preview:"YAW  85  45   0  20"},{name:"LEVEL_PIDS",id:56,preview:"LEV  20  15  80"},{name:"POS_XY_PIDS",id:57,preview:"PXY  20  15  80"},{name:"POS_Z_PIDS",id:58,preview:"PZ   20  15  80"},{name:"VEL_XY_PIDS",id:59,preview:"VXY  20  15  80"},{name:"VEL_Z_PIDS",id:60,preview:"VZ   20  15  80"},{name:"HEADING_P",id:61,preview:"HP  20"},{name:"BOARD_ALIGNMENT_ROLL",id:62,preview:"AR    0"},{name:"BOARD_ALIGNMENT_PITCH",id:63,preview:"AP   "+t.embed_dot("1.0")},{name:"THROTTLE_EXPO",id:66,preview:"TEX   0"},{name:"STABILIZED.RC_EXPO",id:64,preview:"EXP  20"},{name:"STABILIZED.RC_YAW_EXPO",id:65,preview:"YEX  20"},{name:"STABILIZED.PITCH_RATE",id:67,preview:"SPR  20"},{name:"STABILIZED.ROLL_RATE",id:68,preview:"SRR  20"},{name:"STABILIZED.YAW_RATE",id:69,preview:"SYR  20"},{name:"MANUAL_RC_EXPO",id:70,preview:"MEX  20"},{name:"MANUAL_RC_YAW_EXPO",id:71,preview:"MYX  20"},{name:"MANUAL_PITCH_RATE",id:72,preview:"MPR  20"},{name:"MANUAL_ROLL_RATE",id:73,preview:"MRR  20"},{name:"MANUAL_YAW_RATE",id:74,preview:"MYR  20"},{name:"NAV_FW_CRUISE_THROTTLE",id:75,preview:"CRS 1500"},{name:"NAV_FW_PITCH_TO_THROTTLE",id:76,preview:"P2T  10"},{name:"FW_MIN_THROTTLE_DOWN_PITCH_ANGLE",id:77,preview:"0TP  "+t.embed_dot("4.5")},{name:"THRUST_PID_ATTENUATION",id:117,preview:`TPA    0
BP  1500`},{name:"CONTROL_SMOOTHNESS",id:118,preview:"CTL S 3"},{name:"TPA_TIME_CONSTANT",id:134,preview:"TPA TC   10"},{name:"FW_LEVEL_TRIM",id:135,preview:"LEVEL  "+t.embed_dot("5.4")},{name:"MISSION_INDEX",id:139,preview:"WP NO 7"},{name:"FW_ALT_CONTROL_RESPONSE",id:166,preview:"ACR 40"}]},{name:"osdGroupPIDOutputs",items:[{name:"FW_ALT_PID_OUTPUTS",id:79,preview:"PZO  "+t.embed_dot("  1.2")+" "+t.embed_dot("  0.1")+" "+t.embed_dot("  0.0")+" "+t.embed_dot("  1.3")},{name:"FW_POS_PID_OUTPUTS",id:80,preview:"PXYO "+t.embed_dot("  1.2")+" "+t.embed_dot("  0.1")+" "+t.embed_dot("  0.0")+" "+t.embed_dot("  1.3")},{name:"MC_VEL_X_PID_OUTPUTS",id:81,preview:"VXO  "+t.embed_dot("  1.2")+" "+t.embed_dot("  0.1")+" "+t.embed_dot("  0.0")+" "+t.embed_dot("  1.3")},{name:"MC_VEL_Y_PID_OUTPUTS",id:82,preview:"VYO  "+t.embed_dot("  1.2")+" "+t.embed_dot("  0.1")+" "+t.embed_dot("  0.0")+" "+t.embed_dot("  1.3")},{name:"MC_VEL_Z_PID_OUTPUTS",id:83,preview:"VZO  "+t.embed_dot("  1.2")+" "+t.embed_dot("  0.1")+" "+t.embed_dot("  0.0")+" "+t.embed_dot("  1.3")},{name:"MC_POS_XYZ_P_OUTPUTS",id:84,preview:"POSO "+t.embed_dot("  1.2")+" "+t.embed_dot("  0.1")+" "+t.embed_dot("  0.0")}]}]};s.get_item=function(i){for(var e=0;e<s.constants.ALL_DISPLAY_GROUPS.length;e++)for(var o=s.constants.ALL_DISPLAY_GROUPS[e],r=0;r<o.items.length;r++)if(o.items[r].id==i)return o.items[r];return null};s.is_item_displayed=function(i,e){return!(!s.data.items[i.id]||p.getOsdDisabledFields().indexOf(i.name)!=-1||!e||typeof e.enabled=="function"&&e.enabled()===!1||i.min_version&&!te.gte(p.CONFIG.flightControllerVersion,i.min_version)||typeof i.enabled=="function"&&i.enabled()===!1)};s.get_item_preview=function(i){var e=i.preview;return typeof e=="function"?e():e};s.reload=function(i){s.initData();var e=function(){s.updateDisplaySize(),i&&i()};x.promise(F.MSP2_INAV_OSD_LAYOUTS).then(function(o){s.msp.decodeLayoutCounts(o);var r=Array.apply(null,{length:s.data.layout_count}).map(Number.call,Number),d=ye(r,function(_,l){var u=[];return u.push8(_),x.promise(F.MSP2_INAV_OSD_LAYOUTS,u).then(function(m){s.msp.decodeLayout(_,m)})});d.then(function(){s.updateSelectedLayout(s.data.selected_layout||0),x.promise(F.MSP2_INAV_OSD_ALARMS).then(function(_){s.msp.decodeAlarms(_),x.promise(F.MSP2_INAV_OSD_PREFERENCES).then(function(l){s.data.supported=!0,s.msp.decodePreferences(l),x.promise(F.MSP2_INAV_CUSTOM_OSD_ELEMENTS).then(()=>{z.loadOsdCustomElements(()=>{Ie(),e()})})})})})})};s.updateSelectedLayout=function(i){s.data.selected_layout=i,s.data.items=s.data.layouts[s.data.selected_layout]};s.updateDisplaySize=function(){y=s.constants.VIDEO_TYPES[s.data.preferences.video_system],y=="AUTO"&&(y="PAL");for(var i=[],e=0;e<s.data.layout_count;e++){for(var o=s.data.layouts[e],r=[],d=0;d<s.data.items.length;d++)r.push(s.msp.helpers.pack.position(o[d]));i.push(r)}t.constants.SIZES.LINE=s.constants.VIDEO_COLS[y],s.data.display_size={x:t.constants.SIZES.LINE,y:s.constants.VIDEO_LINES[y],total:s.constants.VIDEO_BUFFER_CHARS[y]};for(var e=0;e<s.data.layout_count;e++)for(var r=i[e],o=s.data.layouts[e],d=0;d<s.data.item_count;d++){var _=s.msp.helpers.unpack.position(r[d]);_.x<s.data.display_size.x&&_.y<s.data.display_size.y&&(o[d]=_)}n(".third_left").toggleClass("preview_avatar_side",y=="AVATAR"),n(".preview").toggleClass("preview_avatar cut43_left",y=="AVATAR"),n(".third_right").toggleClass("preview_avatar_side",y=="AVATAR"),n(".third_left").toggleClass("preview_dji_hd_side",y=="DJIWTF"),n(".preview").toggleClass("preview_dji_hd cut43_left",y=="DJIWTF"),n(".third_right").toggleClass("preview_dji_hd_side",y=="DJIWTF"),n(".third_left").toggleClass("preview_hdzero_side",y=="HDZERO"),n(".preview").toggleClass("preview_hdzero cut43_left",y=="HDZERO"),n(".third_right").toggleClass("preview_hdzero_side",y=="HDZERO"),n(".third_left").toggleClass("preview_bfhdcompat_side",y=="BFHDCOMPAT"||y=="DJI_NATIVE"),n(".preview").toggleClass("preview_bfhdcompat cut43_left",y=="BFHDCOMPAT"||y=="DJI_NATIVE"),n(".third_right").toggleClass("preview_bfhdcompat_side",y=="BFHDCOMPAT"||y=="DJI_NATIVE"),s.GUI.updateGuidesView(n("#videoGuides").find("input").is(":checked"))};s.saveAlarms=function(i){let e=s.msp.encodeAlarms();return x.promise(F.MSP2_INAV_OSD_SET_ALARMS,e).then(i)};s.saveConfig=function(i){return s.saveAlarms(function(){var e=s.msp.encodePreferences();return x.promise(F.MSP2_INAV_OSD_SET_PREFERENCES,e).then(i)})};s.saveItem=function(i,e){let o=s.data.items[i.id],r=s.msp.encodeLayoutItem(s.data.selected_layout,i,o);return x.promise(F.MSP2_INAV_OSD_SET_LAYOUT_ITEM,r).then(e)};s.msp={helpers:{unpack:{position:function(i){var e={};return e.x=i&63,e.y=i>>6&63,e.position=e.y*t.constants.SIZES.LINE+e.x,e.isVisible=(i&s.constants.VISIBLE)!=0,e}},calculate:{coords:function(i){return i.x=i.position%t.constants.SIZES.LINE&63,i.y=i.position/t.constants.SIZES.LINE&63,i}},pack:{position:function(i){return(i.isVisible?s.constants.VISIBLE:0)|(i.y&63)<<6|i.x&63}}},encodeAlarms:function(){var i=[];return i.push8(s.data.alarms.rssi),i.push16(s.data.alarms.fly_minutes),i.push16(s.data.alarms.max_altitude),i.push16(s.data.alarms.dist),i.push16(s.data.alarms.max_neg_altitude),i.push16(s.data.alarms.gforce),i.push16(s.data.alarms.gforce_axis_min),i.push16(s.data.alarms.gforce_axis_max),i.push8(s.data.alarms.current),i.push16(s.data.alarms.imu_temp_alarm_min),i.push16(s.data.alarms.imu_temp_alarm_max),i.push16(s.data.alarms.baro_temp_alarm_min),i.push16(s.data.alarms.baro_temp_alarm_max),i.push16(s.data.alarms.adsb_distance_warning),i.push16(s.data.alarms.adsb_distance_alert),i},decodeAlarms:function(i){var e=i.data;s.data.alarms.rssi=e.readU8(),s.data.alarms.fly_minutes=e.readU16(),s.data.alarms.max_altitude=e.readU16(),s.data.alarms.dist=e.readU16(),s.data.alarms.max_neg_altitude=e.readU16(),s.data.alarms.gforce=e.readU16(),s.data.alarms.gforce_axis_min=e.read16(),s.data.alarms.gforce_axis_max=e.read16(),s.data.alarms.current=e.readU8(),s.data.alarms.imu_temp_alarm_min=e.read16(),s.data.alarms.imu_temp_alarm_max=e.read16(),s.data.alarms.baro_temp_alarm_min=e.read16(),s.data.alarms.baro_temp_alarm_max=e.read16(),s.data.alarms.adsb_distance_warning=e.read16(),s.data.alarms.adsb_distance_alert=e.read16()},encodePreferences:function(){var i=[],e=s.data.preferences;return i.push8(e.video_system),i.push8(e.main_voltage_decimals),i.push8(e.ahi_reverse_roll),i.push8(e.crosshairs_style),i.push8(e.left_sidebar_scroll),i.push8(e.right_sidebar_scroll),i.push8(e.sidebar_scroll_arrows),i.push8(e.units),i.push8(e.stats_energy_unit),i.push8(e.adsb_warning_style),i},decodePreferences:function(i){var e=i.data,o=s.data.preferences;o.video_system=e.readU8(),o.main_voltage_decimals=e.readU8(),o.ahi_reverse_roll=e.readU8(),o.crosshairs_style=e.readU8(),o.left_sidebar_scroll=e.readU8(),o.right_sidebar_scroll=e.readU8(),o.sidebar_scroll_arrows=e.readU8(),o.units=e.readU8(),o.stats_energy_unit=e.readU8(),o.adsb_warning_style=e.readU8()},encodeLayoutItem:function(i,e,o){var r=[];return r.push8(i),r.push8(e.id),r.push16(this.helpers.pack.position(o)),r},decodeLayoutCounts:function(i){s.data.layout_count=i.data.readU8(),s.data.item_count=i.data.readU8()},decodeLayout:function(i,e){for(var o=[],r=0;r<s.data.item_count;r++){var d=e.data.readU16();o.push(this.helpers.unpack.position(d))}s.data.layouts[i]=o},encodeOther:function(){var i=[-1,s.data.preferences.video_system];return i.push8(s.data.preferences.units),i.push8(s.data.alarms.rssi),i.push16(s.data.alarms.batt_cap),i.push16(s.data.alarms.fly_minutes),i.push16(s.data.alarms.max_altitude),s.data.alarms.dist!==null&&i.push16(s.data.alarms.dist),s.data.alarms.max_neg_altitude!==null&&i.push16(s.data.alarms.max_neg_altitude),i},encodeItem:function(i,e){var o=[];return o.push8(i),o.push16(this.helpers.pack.position(e)),o},decode:function(i){if(!(i.length<=1)){var e=i.data,o=s.data;for(o.supported=e.readU8(),o.preferences.video_system=e.readU8(),o.preferences.units=e.readU8(),o.alarms.rssi=e.readU8(),o.alarms.batt_cap=e.readU16(),o.alarms.fly_minutes=e.readU16(),o.alarms.max_altitude=e.readU16(),o.alarms.dist=e.readU16(),o.alarms.max_neg_altitude=e.readU16(),o.items=[];e.offset<e.byteLength;){var r=e.readU16();o.items.push(this.helpers.unpack.position(r))}}}};s.GUI={};s.GUI.preview={onMouseEnter:function(){var i=n(this).data("item");i&&n(".field-"+i.id).addClass("mouseover")},onMouseLeave:function(){var i=n(this).data("item");i&&n(".field-"+i.id).removeClass("mouseover")},onDragStart:function(i){var e=i.originalEvent,o=n(e.target).data("item");e.dataTransfer.setData("text/plain",o.id),e.dataTransfer.setDragImage(o.preview_img,6,9)},onDragOver:function(i){var e=i.originalEvent;e.preventDefault(),e.dataTransfer.dropEffect="move",n(this).css({background:"rgba(0,0,0,.5)"})},onDragLeave:function(i){n(this).removeAttr("style")},onDrop:function(i){for(var e=i.originalEvent,o=n(this).removeAttr("style").data("position"),r=parseInt(e.dataTransfer.getData("text")),d=s.get_item(r),_=s.get_item_preview(d),l=0,u=0,m=0;m<_.length;m++){if(_[m]==`
`){u=Math.max(u,l),l=0;continue}l++}u=Math.max(u,l);var v=t.constants.SIZES.LINE-(o%t.constants.SIZES.LINE+u);v<0&&(o+=v),n("input."+r+".position").val(o).trigger("change")}};s.GUI.checkAndProcessSymbolPosition=function(i,e){typeof s.data.preview[i]=="object"&&s.data.preview[i][0]!==null?s.data.preview[i]=[s.data.preview[i][0],e,"red"]:s.data.preview[i]=e};const pe=[1,3,4,5,6,7,8],fe=[0,1,2];s.GUI.updateVideoMode=function(){var i=n(".video-types").empty();if(g.capabilities.isDjiHdFpv||n("#dji_settings").hide(),g.capabilities.isMspDisplay?pe.includes(s.data.preferences.video_system)==!1&&(s.data.preferences.video_system=s.constants.VIDEO_TYPES.indexOf("HDZERO"),s.updateDisplaySize(),s.GUI.saveConfig()):fe.includes(s.data.preferences.video_system)==!1&&(s.data.preferences.video_system=s.constants.VIDEO_TYPES.indexOf("AUTO"),s.updateDisplaySize(),s.GUI.saveConfig()),g.capabilities.isMspDisplay)for(var e=0;e<s.constants.VIDEO_TYPES.length;e++)pe.includes(e)&&i.append(n('<option value="'+s.constants.VIDEO_TYPES[e]+'">'+s.constants.VIDEO_TYPES[e]+"</option>").prop("selected",e===s.data.preferences.video_system).data("type",e));else for(var e=0;e<s.constants.VIDEO_TYPES.length;e++)fe.includes(e)&&i.append(n('<option value="'+s.constants.VIDEO_TYPES[e]+'">'+s.constants.VIDEO_TYPES[e]+"</option>").prop("selected",e===s.data.preferences.video_system).data("type",e));i.on("change",function(){s.data.preferences.video_system=n(this).find(":selected").data("type"),s.updateDisplaySize(),s.GUI.saveConfig()})};s.GUI.updateUnits=function(){for(var i=n("#unit_mode").empty(),e=n(".units .cf_tip"),o=0;o<s.constants.UNIT_TYPES.length;o++){var r=s.constants.UNIT_TYPES[o];if(!(r.min_version&&te.lt(p.CONFIG.flightControllerVersion,r.min_version))){var d=C.getMessage(r.name),_=n("<option>"+d+"</option>");_.attr("value",d),_.data("type",r.value),s.data.preferences.units===r.value&&_.prop("selected",!0),i.append(_)}}function l(){var u=s.constants.UNIT_TYPES[s.data.preferences.units],m;u.tip&&(m=C.getMessage(u.tip)),m?(e.attr("title",m),e.fadeIn()):e.fadeOut()}l(),i.on("change",function(u){var m=n(this).find(":selected");s.data.preferences.units=m.data("type"),Ee.osdUnits=s.data.preferences.units,s.GUI.saveConfig(),l()})};s.GUI.updateFields=function(i){var e=n("#osd_group_template").hide();n(".osd_group").remove();for(var o=0;o<s.constants.ALL_DISPLAY_GROUPS.length;o++){for(var r=s.constants.ALL_DISPLAY_GROUPS[o],d=[],_=0;_<r.items.length;_++){var l=r.items[_];s.is_item_displayed(l,r)&&(s.data.groups[l.id]=r,d.push(l))}if(d.length!=0){var u=e.clone().addClass("osd_group").show();u.attr("id",r.name);var m=u.find(".spacer_box_title"),v=C.getMessage(r.name);m.text(v);var I=C.getMessage(r.name+"_HELP");I&&n('<div class="helpicon cf_tip"></div>').css("margin-top","1px").attr("title",I).appendTo(m.parent()).jBox("Tooltip",{delayOpen:100,delayClose:100,position:{x:"right",y:"center"},outside:"x"});for(var O=u.find(".display-fields"),A=n(".osd_search"),_=0;_<d.length;_++){var l=d[_],L=s.data.items[l.id];L.isVisible;var H=n('<div class="display-field field-'+l.id+'"/>'),w=l.name,U="osdElement_"+w,N=C.getMessage(U);N?w=N:w=ve.titleize(w);var D=A.val();if(!(D.length>0&&!w.toLowerCase().includes(D.toLowerCase()))){var k=C.getMessage(U+"_HELP");k&&n('<div class="helpicon cf_tip"></div>').css("margin-top","1px").attr("title",k).appendTo(H).jBox("Tooltip",{delayOpen:100,delayClose:100,position:{x:"right",y:"center"},outside:"x"}),H.append(n('<input type="checkbox" name="'+l.name+'" class="togglesmall"></input>').data("item",l).attr("checked",L.isVisible).on("change",function(){var f=n(this).data("item"),P=s.data.items[f.id],X=n(this).parent().find(".position."+f.name);P.isVisible=!P.isVisible,P.isVisible?(s.msp.helpers.calculate.coords(P),(P.x>s.data.display_size.x||P.y>s.data.display_size.y)&&(P.x=P.y=P.position=0),X.show()):X.hide(),s.GUI.saveItem(f)})),H.append('<label for="'+l.name+'" class="char-label">'+w+"</label>"),l.positionable!==!1&&H.append(n('<input type="number" class="'+l.id+' position"></input>').data("item",l).val(L.position).on("change",Le(250,function(f){var P=n(this).data("item"),X=s.data.items[P.id];X.position=parseInt(n(this).val()),s.msp.helpers.calculate.coords(X),s.GUI.saveItem(P)}))),O.append(H)}}u.find(".display-fields").children().length>0&&e.parent().append(u)}}n("#videoGuidesToggle").length==!1&&n("#videoGuides").prepend(n('<input id="videoGuidesToggle" type="checkbox" class="toggle" />').attr("checked",ge).on("change",function(){s.GUI.updateGuidesView(this.checked),K.storeSet("showOSDGuides",this.checked),s.GUI.updatePreviews()})),n("#djiUnsupportedElementsToggle").length==!1&&n("#djiUnsupportedElements").prepend(n('<input id="djiUnsupportedElementsToggle" type="checkbox" class="toggle" />').attr("checked",g.capabilities.isDjiHdFpv&&!g.capabilities.isMspDisplay).on("change",function(){s.GUI.updateDjiView(this.checked),s.GUI.updatePreviews()})),B.switchery(),i!=null&&i.currentTarget!==A[0]&&(ee(),j(),ae())};s.GUI.removeBottomLines=function(){n(".display-field").removeClass("no-bottom"),n(".gui_box").each(function(i,e){var o=n(e).find(".display-fields, .settings").children(),r=!1;o.each(function(d,_){n(_).is(":visible")&&(r=n(_))}),r&&r.addClass("no-bottom")})};s.GUI.updateDjiMessageElements=function(i){n(".display-field").each(function(e,o){var r=n(o).find("input").attr("name");s.DjiElements.craftNameElements.includes(r)&&(i?n(o).addClass("blue").show():n("#djiUnsupportedElements").find("input").is(":checked")&&n(o).hide()),i||n(o).removeClass("blue")}),s.GUI.removeBottomLines()};s.GUI.updateGuidesView=function(i){let e=s.constants.VIDEO_TYPES[s.data.preferences.video_system]=="HDZERO";n(".hd_43_margin_left").toggleClass("hdzero_43_left",e&&i),n(".hd_43_margin_right").toggleClass("hdzero_43_right",e&&i),n(".hd_3016_box_top").toggleClass("hd_3016_top",e&&i),n(".hd_3016_box_bottom").toggleClass("hd_3016_bottom",e&&i),n(".hd_3016_box_left").toggleClass("hd_3016_left",e&&i),n(".hd_3016_box_right").toggleClass("hd_3016_right",e&&i);let o=s.constants.VIDEO_TYPES[s.data.preferences.video_system]=="DJIWTF";n(".hd_43_margin_left").toggleClass("dji_hd_43_left",o&&i),n(".hd_43_margin_right").toggleClass("dji_hd_43_right",o&&i);let r=s.constants.VIDEO_TYPES[s.data.preferences.video_system]=="AVATAR";n(".hd_43_margin_left").toggleClass("hd_avatar_43_left",r&&i),n(".hd_43_margin_right").toggleClass("hd_avatar_43_right",r&&i),n(".hd_avatar_bottom_bar").toggleClass("hd_avatar_bottom",r&&i),n(".hd_avatar_storage_box_top").toggleClass("hd_avatar_storagebox_t",r&&i),n(".hd_avatar_storage_box_bottom").toggleClass("hd_avatar_storagebox_b",r&&i),n(".hd_avatar_storage_box_left").toggleClass("hd_avatar_storagebox_l",r&&i),n(".hd_avatar_storage_box_right").toggleClass("hd_avatar_storagebox_r",r&&i);let d=s.constants.VIDEO_TYPES[s.data.preferences.video_system]=="BFHDCOMPAT"||s.constants.VIDEO_TYPES[s.data.preferences.video_system]=="DJI_NATIVE";n(".hd_43_margin_left").toggleClass("hd_bfhdcompat_43_left",d&&i),n(".hd_43_margin_right").toggleClass("hd_bfhdcompat_43_right",d&&i),n(".hd_bfhdcompat_bottom_box").toggleClass("hd_bfhdcompat_bottom",d&&i),n(".hd_bfhdcompat_storage_box").toggleClass("hd_bfhdcompat_storagebox",d&&i);let _=s.constants.VIDEO_TYPES[s.data.preferences.video_system]=="PAL"||s.constants.VIDEO_TYPES[s.data.preferences.video_system]=="AUTO";n(".pal_ntsc_box_bottom").toggleClass("ntsc_bottom",_&&i)};s.GUI.updateDjiView=function(i){if(i){n(s.DjiElements.emptyGroups).each(function(d,_){n("#osdGroup"+_).hide()});var e=n(".display-field");e.each(function(d,_){var l=n(_).find("input").attr("name");s.DjiElements.supported.includes(l)||n(_).hide()});var o=n(".settings-container").find(".settings").children();o.each(function(d,_){var l=n(_).attr("class");s.DjiElements.supportedSettings.includes(l)||n(_).hide()});var o=n(".decimals-container").find(".settings").children();o.each(function(d,_){var l=n(_).attr("class");s.DjiElements.supportedSettings.includes(l)||n(_).hide()});var r=n(".alarms-container").find(".settings").children();r.each(function(d,_){var l=n(_).attr("for");s.DjiElements.supportedAlarms.includes(l)||n(_).hide()}),n(".switch-indicator-container").hide()}else n(s.DjiElements.emptyGroups).each(function(d,_){n("#osdGroup"+_).show()}),n(".display-field").show().removeClass("no-bottom"),n(".settings-container, .decimals-container, .alarms-container").find(".settings").children().show().removeClass("no-bottom"),n(".switch-indicator-container").show();s.GUI.updateDjiMessageElements(n("#useCraftnameForMessages").is(":checked"))};s.GUI.updateAlarms=function(){n(".osd_use_airspeed_alarm").toggle(g.capabilities.usePitot),n(".osd_use_baro_temp_alarm").toggle(g.capabilities.useBaro),n(".osd_use_esc_telemetry").toggle(g.capabilities.useESCTelemetry),n(".osd_use_rx").toggle(g.capabilities.useRx),n(".osd_use_crsf").toggle(g.capabilities.useCRSF)};s.GUI.updateMapPreview=function(i,e,o,r){n('input[name="'+e+'"]').prop("checked")&&(s.data.display_size.x-2,s.GUI.checkAndProcessSymbolPosition(i,r))};s.GUI.updatePreviews=function(){if(s.data.preview=[],s.data.display_size!=null){for(let f=0;f<s.data.display_size.total;f++)s.data.preview.push([null,32]);for(var i=0;i<s.data.items.length;i++){var e=s.get_item(i);if(!(!e||!s.is_item_displayed(e,s.data.groups[e.id]))){var o=s.data.items[i];if(o.isVisible&&!(o.x>=s.data.display_size.x)&&!(s.DjiElements.craftNameElements.includes(e.name)&&n("#djiUnsupportedElements").find("input").is(":checked"))){var r=o.position>=0?o.position:o.position+s.data.display_size.total;e.preview_img=new Image;var d=document.createElement("canvas"),_=d.getContext("2d"),l=s.get_item_preview(e);if(l){var u=0,m=0;for(let f=0;f<l.length;f++){var v=l.charCodeAt(f);if(v==10){u=0,m++;continue}var I=r+u+m*s.data.display_size.x;if(I>=s.data.preview.length){u++;continue}s.data.preview[I][0]!==null?s.data.preview[I]=[e,v,"red"]:s.data.preview[I]=[e,v];var O=new Image;O.src=t.draw(v),_.drawImage(O,u*t.constants.SIZES.CHAR_WIDTH,m*t.constants.SIZES.CHAR_HEIGHT),u++}e.preview_img.src=d.toDataURL("image/png"),e.preview_img.style.pointerEvents="none"}}}}var A=s.data.display_size.x*s.data.display_size.y/2;s.data.display_size.y%2==0&&(A+=Math.floor(s.data.display_size.x/2));let S=A-s.constants.VIDEO_COLS[y]*n("#osd_horizon_offset").val();if(n('input[name="ARTIFICIAL_HORIZON"]').prop("checked"))for(let f=0;f<9;f++)s.GUI.checkAndProcessSymbolPosition(S-4+f,a.AH_BAR9_0+4);if(n('input[name="CROSSHAIRS"]').prop("checked")){let f=G.getInputValue("osd_crosshairs_style");f==1?(s.GUI.checkAndProcessSymbolPosition(S-2,a.AH_AIRCRAFT0),s.GUI.checkAndProcessSymbolPosition(S-1,a.AH_AIRCRAFT1),s.GUI.checkAndProcessSymbolPosition(S,a.AH_AIRCRAFT2),s.GUI.checkAndProcessSymbolPosition(S+1,a.AH_AIRCRAFT3),s.GUI.checkAndProcessSymbolPosition(S+2,a.AH_AIRCRAFT4)):f>1&&f<8?(s.GUI.checkAndProcessSymbolPosition(S-1,a.AH_CROSSHAIRS[f][0]),s.GUI.checkAndProcessSymbolPosition(S,a.AH_CROSSHAIRS[f][1]),s.GUI.checkAndProcessSymbolPosition(S+1,a.AH_CROSSHAIRS[f][2])):(s.GUI.checkAndProcessSymbolPosition(S-1,a.AH_CENTER_LINE),s.GUI.checkAndProcessSymbolPosition(S,a.AH_CROSSHAIRS[f]),s.GUI.checkAndProcessSymbolPosition(S+1,a.AH_CENTER_LINE_RIGHT))}if(n('input[name="HORIZON_SIDEBARS"]').prop("checked")){var L=s.constants.AHISIDEBARWIDTHPOSITION,H=s.constants.AHISIDEBARHEIGHTPOSITION;for(let f=-H;f<=H;f++)s.GUI.checkAndProcessSymbolPosition(S-L+f*t.constants.SIZES.LINE,a.AH_DECORATION),s.GUI.checkAndProcessSymbolPosition(S+L+f*t.constants.SIZES.LINE,a.AH_DECORATION);s.GUI.checkAndProcessSymbolPosition(S-L+1,a.AH_LEFT),s.GUI.checkAndProcessSymbolPosition(S+L-1,a.AH_RIGHT)}s.GUI.updateMapPreview(A,"MAP_NORTH","N",a.HOME),s.GUI.updateMapPreview(A,"MAP_TAKEOFF","T",a.HOME),s.GUI.updateMapPreview(A,"RADAR",null,a.DIR_TO_HOME);var w=n(".display-layout .preview").empty(),U=n('<div class="row"/>');for(let f=0;f<s.data.display_size.total;){var v=s.data.preview[f],N="";if(typeof v=="object"){var e=s.data.preview[f][0];v=s.data.preview[f][1],s.data.preview[f][2]!==void 0&&(N='style="background-color: '+s.data.preview[f][2]+';"')}var D=n('<div class="char"'+N+"><img src="+t.draw(v)+"></img></div>").on("mouseenter",s.GUI.preview.onMouseEnter).on("mouseleave",s.GUI.preview.onMouseLeave).on("dragover",s.GUI.preview.onDragOver).on("dragleave",s.GUI.preview.onDragLeave).on("drop",s.GUI.preview.onDrop).data("item",e).data("position",f);if(D.find("img").css("pointer-events","none"),e&&e.positionable!==!1){var k="osdElement_"+e.name,$=C.getMessage(k);$||($=ve.titleize(e.name)),D.addClass("field-"+e.id).data("item",e).prop("draggable",!0).on("dragstart",s.GUI.preview.onDragStart).prop("title",$)}U.append(D),++f%s.data.display_size.x==0&&(w.append(U),U=n('<div class="row"/>'))}}};s.GUI.updateAll=function(){if(!s.data.supported){n(".unsupported").fadeIn();return}var i=n(".osd_layouts"),e=n(".osd_copy"),o=n(".osd_paste").hide(),r=n(".osd_clear");if(s.data.layout_count>1){i.empty();for(var d=0;d<s.data.layout_count;d++){var _=d>0?C.getMessage("osdLayoutAlternative",[d]):C.getMessage("osdLayoutDefault");n("<option/>").val(d).text(_).appendTo(i)}i.val(s.data.selected_layout),i.show(),i.on("change",function(){s.updateSelectedLayout(parseInt(i.val())),s.GUI.updateFields(),s.GUI.updateGuidesView(n("#videoGuides").find("input").is(":checked")),s.GUI.updateDjiView(n("#djiUnsupportedElements").find("input").is(":checked")),s.GUI.updatePreviews()}),e.on("click",function(){s.data.selected_layout>=0&&s.data.selected_layout<s.data.layout_count&&(J={layout:JSON.parse(JSON.stringify(s.data.layouts[s.data.selected_layout])),filled:!0},o.show(),B.log(C.getMessage("osdLayoutInsertedIntoClipboard")))}),o.on("click",async function(){if(J.filled==!0){var l=JSON.parse(JSON.stringify(s.data.layouts[s.data.selected_layout]));s.data.layouts[s.data.selected_layout]=JSON.parse(JSON.stringify(J.layout)),i.trigger("change");for(var u in s.data.layouts[s.data.selected_layout]){var m=s.data.layouts[s.data.selected_layout][u];!(m.isVisible===!1&&l[u].isVisible===!1)&&(l[u].x!==m.x||l[u].y!==m.y||l[u].position!==m.position||l[u].isVisible!==m.isVisible)&&await s.saveItem({id:u})}B.log(C.getMessage("osdLayoutPasteFromClipboard"))}}),r.on("click",async function(){var l=JSON.parse(JSON.stringify(s.data.layouts[s.data.selected_layout])),u=[];l.forEach(function(v,I){var O=JSON.parse(JSON.stringify(v));O.isVisible=!1,u[I]=O}),s.data.layouts[s.data.selected_layout]=u,i.trigger("change");for(var m in s.data.layouts[s.data.selected_layout])s.data.layouts[s.data.selected_layout][m],l[m].isVisible===!0&&await s.saveItem({id:m});B.log(C.getMessage("osdClearLayout"))})}else i.hide(),i.off("change"),e.hide(),e.off("change"),o.hide(),o.off("change"),r.hide(),r.off("change");n(".osd_search").on("input",function(l){s.GUI.updateFields(l)}),n(".supported").fadeIn(),s.GUI.updateVideoMode(),s.GUI.updateUnits(),s.GUI.updateFields(),s.GUI.updatePreviews(),s.GUI.updateGuidesView(n("#videoGuides").find("input").is(":checked")),s.GUI.updateDjiView(g.capabilities.isDjiHdFpv&&!g.capabilities.isMspDisplay),s.GUI.updateAlarms()};s.GUI.update=function(){s.reload(function(){s.GUI.updateAll()})};s.GUI.saveItem=function(i){s.saveItem(i,function(){s.GUI.updatePreviews()})};s.GUI.saveConfig=function(){s.saveConfig(function(){s.GUI.updatePreviews()})};let g={};g.init=function(){g.capabilities={isDjiHdFpv:!1,isMspDisplay:!1,useESCTelemetry:!1,useRx:!1,useCRSF:!1,useBaro:!1,usePitot:!1}};g.update=function(i){g.init(),x.send_message(F.MSP2_CF_SERIAL_CONFIG,!1,!1,function(){n.each(p.SERIAL_CONFIG.ports,function(e,o){o.functions.includes("DJI_FPV")&&(g.capabilities.isDjiHdFpv=!0),o.functions.includes("MSP_DISPLAYPORT")&&(g.capabilities.isMspDisplay=!0),o.functions.includes("ESC")&&(g.capabilities.useESCTelemetry=!0)}),z.loadRxConfig(function(){g.capabilities.useCRSF=p.RX_CONFIG.serialrx_provider==6,g.capabilities.useRx=p.RX_CONFIG.serialrx_provider==6||p.RX_CONFIG.receiver_type==2||p.RX_CONFIG.serialrx_provider==12,z.loadSensorConfig(function(){g.capabilities.useBaro=p.SENSOR_CONFIG.barometer!=0,g.capabilities.usePitot=p.SENSOR_CONFIG.pitot!=0,i&&i()})})})};se.osd={};se.osd.initialize=function(i){z.loadServoMixRules(),z.loadLogicConditions(),B.active_tab!="osd"&&(B.active_tab="osd");function e(){console.log("save_to_eeprom"),x.send_message(F.MSP_EEPROM_WRITE,!1,!1,function(){B.log(C.getMessage("eepromSaved"))})}g.update(function(){Y(async()=>{const{default:o}=await import("./osd-CHg8cuKe.js");return{default:o}},[],import.meta.url).then(({default:o})=>B.load(o,G.processHtml(function(){C.localize(),s.GUI.jbox=new Oe("Modal",{width:750,height:300,position:{y:"bottom"},offset:{y:-50},closeButton:"title",animation:!1,attach:n("#fontmanager"),title:"OSD Font Manager",content:n("#fontmanagercontent")}),n("a.save").on("click",function(){G.saveInputs(e)}),ge=K.storeGet("showOSDGuides",!1),n(".osdSwitchInd_channel option").each(function(){n(this).text("Ch "+n(this).text())}),n(".osdSwitchIndName").on("keyup",function(){let u=new RegExp("^[A-Za-z0-9]"),m=n(this).val();u.test(m.slice(-1))?n(this).val(m.toUpperCase().slice(0,4)):n(this).val(m.slice(0,-1)),ee()}),n("#switchIndicators_alignLeft").on("change",function(){ee()}),n("#osdPanServoIndicatorShowDegrees").on("change",function(){ae()}),n("#panServoOutput").on("change",function(){ae()}),n("#craft_name").on("keyup",function(){let u=new RegExp("^[A-Za-z0-9 !_,:;=@#\\%\\&\\-\\*\\^\\(\\)\\.\\+\\<\\>\\[\\]]"),m=n(this).val();u.test(m.slice(-1))?n(this).val(m.toUpperCase()):n(this).val(m.slice(0,-1)),j()}),n("#pilot_name").on("keyup",function(){let u=new RegExp("^[A-Za-z0-9 !_,:;=@#\\%\\&\\-\\*\\^\\(\\)\\.\\+\\<\\>\\[\\]]"),m=n(this).val();u.test(m.slice(-1))?n(this).val(m.toUpperCase()):n(this).val(m.slice(0,-1)),j()});var r=n(".font-preview");t.initData();var d=n(".fontbuttons button");d.on("click",function(){n(this).data("font-file")&&(d.removeClass("active"),n(this).addClass("active"),K.storeSet("osd_font",n(this).data("font-file")),Re(Object.assign({"../resources/osd/analogue/bold.mcm":()=>Y(()=>import("./bold-DxZLzY9A.js"),[],import.meta.url),"../resources/osd/analogue/clarity.mcm":()=>Y(()=>import("./clarity-DDbxYXIg.js"),[],import.meta.url),"../resources/osd/analogue/clarity_medium.mcm":()=>Y(()=>import("./clarity_medium-BwblFGi5.js"),[],import.meta.url),"../resources/osd/analogue/default.mcm":()=>Y(()=>import("./default-DD6jfuLp.js"),[],import.meta.url),"../resources/osd/analogue/impact.mcm":()=>Y(()=>import("./impact-BD7ZWInd.js"),[],import.meta.url),"../resources/osd/analogue/impact_mini.mcm":()=>Y(()=>import("./impact_mini-DJtpZKTl.js"),[],import.meta.url),"../resources/osd/analogue/large.mcm":()=>Y(()=>import("./large-C_-utXbK.js"),[],import.meta.url),"../resources/osd/analogue/vision.mcm":()=>Y(()=>import("./vision-insBN90h.js"),[],import.meta.url)}),`../resources/osd/analogue/${n(this).data("font-file")}.mcm`,5).then(({default:u})=>{t.parseMCMFontFile(u),t.preview(r),s.GUI.update()}))});var _=K.storeGet("osd_font",!1),l;_&&(l=n('.fontbuttons button[data-font-file="'+_+'"]'),l.attr("data-font-file")==null&&(l=void 0)),typeof l>"u"?d.first().trigger("click"):l.trigger("click"),n("button.load_font_file").on("click",function(){d.removeClass("active"),t.openFontFile().then(function(){t.preview(r),s.GUI.update()})}),n("a.flash_font").on("click",function(){if(!B.connect_lock){var u=n(".progressLabel"),m=n(".progress"),v=C.getMessage("uploadingCharacters");u.text(v);var I=function(O,A,L){m.val(L),O==A?u.text(C.getMessage("uploadedCharacters"),[A]):u.text(v+" ("+O+"/"+A+")")};t.upload(I)}}),n(".update_preview").on("change",function(){s.data&&setTimeout(function(){s.GUI.saveItem({id:0})},100)}),n("#useCraftnameForMessages").on("change",function(){s.GUI.updateDjiMessageElements(this.checked)}),te.gte(p.CONFIG.flightControllerVersion,"7.1.0")&&z.loadOsdCustomElements(Ie),B.content_ready(i),j()})))})};function Ie(){if(p.OSD_CUSTOM_ELEMENTS.settings.customElementsCount==0){n(".custom-element-container").remove();return}n("#INAVCharacterMapDocURL").attr("href",Ee.configuratorTreeLocation+"resources/osd/INAV%20Character%20Map.md");for(var i=n("#osdCustomElements"),e=!0,o=0;o<p.OSD_CUSTOM_ELEMENTS.settings.customElementsCount;o++){var r=n("<label>"),d=n("<table>").addClass("osdCustomElement_main_table"),_=n("<tr>").data("row",o),l=n("<tr>").data("row",o),u=n("<tr>");u.append(n("<td>").attr("colspan",2).append(n("<span>").html(C.getMessage("custom_element")+" "+(o+1))));for(var m=0;m<p.OSD_CUSTOM_ELEMENTS.settings.customElementParts;m++){var v=n("<select>").addClass("osdCustomElement-"+o+"-part-"+m+"-type").data("valueCellClass","osdCustomElement-"+o+"-part-"+m+"-value").html(`
                        <option value="0">none</option>
                        <option data-value="text" value="1">Text</option>
                        <option data-value="ico" value="2">Icon Static</option>
                        <option data-value="ico_gv" value="3">Icon from Global Variable</option>
                        <option data-value="ico_lc" value="4">Icon from Logic Condition</option>
                        <option data-value="gv" value="5">Global Variable 0</option>
                        <option data-value="gv" value="6">Global Variable 00</option>
                        <option data-value="gv" value="7">Global Variable 000</option>
                        <option data-value="gv" value="8">Global Variable 0000</option>
                        <option data-value="gv" value="9">Global Variable 00000</option>
                        <option data-value="gv" value="10">Global Variable 0.0</option>
                        <option data-value="gv" value="11">Global Variable 0.00</option>
                        <option data-value="gv" value="12">Global Variable 00.0</option>
                        <option data-value="gv" value="13">Global Variable 00.00</option>
                        <option data-value="gv" value="14">Global Variable 000.0</option>
                        <option data-value="gv" value="15">Global Variable 000.00</option>
                        <option data-value="gv" value="16">Global Variable 0000.0</option>
                        <option data-value="lc" value="17">Logic Condition 0</option>
                        <option data-value="lc" value="18">Logic Condition 00</option>
                        <option data-value="lc" value="19">Logic Condition 000</option>
                        <option data-value="lc" value="20">Logic Condition 0000</option>
                        <option data-value="lc" value="21">Logic Condition 00000</option>
                        <option data-value="lc" value="22">Logic Condition 0.0</option>
                        <option data-value="lc" value="23">Logic Condition 0.00</option>
                        <option data-value="lc" value="24">Logic Condition 00.0</option>
                        <option data-value="lc" value="25">Logic Condition 00.00</option>
                        <option data-value="lc" value="26">Logic Condition 000.0</option>
                        <option data-value="lc" value="27">Logic Condition 000.00</option>
                        <option data-value="lc" value="28">Logic Condition 0000.0</option>
                        `);_.append(n("<td>").append(v)),l.append(n("<td>").addClass("osdCustomElement-"+o+"-part-"+m+"-value").append(n("<input>").addClass("value").addClass("text").attr("type","text").attr("maxlength",p.OSD_CUSTOM_ELEMENTS.settings.customElementTextSize).hide()).append(n("<input>").addClass("value").addClass("ico").attr("min",1).attr("max",255).hide()).append(n("<select>").addClass("value").addClass("ico_gv").html(q()).hide()).append(n("<select>").addClass("value").addClass("ico_lc").html(Q()).hide()).append(n("<select>").addClass("value").addClass("gv").html(q()).hide()).append(n("<select>").addClass("value").addClass("lc").html(Q()).hide())),v.change(function(){var O=n(this).find(":selected").data("value"),A=n("."+n(this).data("valueCellClass"));A.find(".value").hide(),A.find("."+O).show(),e||be()})}var I=n("<select>").addClass("osdCustomElement-"+o+"-visibility-type").data("valueCellClass","osdCustomElement-"+o+"-visibility-value").html(`
            <option value="0">always</option>
            <option data-value="gv" value="1">Global Variable</option>
            <option data-value="lc" value="2">Logic Condition</option>
        `);_.append(n("<td>").append(I)),l.append(n("<td>").addClass("osdCustomElement-"+o+"-visibility-value").append(n("<select>").addClass("value").addClass("gv").html(q()).hide()).append(n("<select>").addClass("value").addClass("lc").html(Q()).hide())),I.change(function(){var O=n(this).find(":selected").data("value"),A=n("."+n(this).data("valueCellClass"));A.find(".value").hide(),A.find("."+O).show()}),d.append(u).append(_).append(l),r.append(d),i.append(r)}Ue(),Fe(),e=!1}function be(){let i=0,e=s.constants.ALL_DISPLAY_GROUPS.filter(function(_){return _.name=="osdGroupOSDCustomElements"})[0];for(var o=0;o<p.OSD_CUSTOM_ELEMENTS.settings.customElementsCount;o++){if(n(".osdCustomElement-"+o+"-part-0-type").val()!=null){for(let _=0;_<e.items.length;_++)if(e.items[_].name=="CUSTOM_ELEMENT_"+(o+1)){let l="";i++;for(let u=0;u<p.OSD_CUSTOM_ELEMENTS.settings.customElementParts;u++){var r=n(".osdCustomElement-"+o+"-part-"+u+"-type"),d=n(".osdCustomElement-"+o+"-part-"+u+"-value");switch(parseInt(r.val())){case 1:l+=d.find(".text").val().trim();break;case 2:l+=t.symbol("0x"+parseInt(d.find(".ico").val()).toString(16).toUpperCase());break;case 3:l+=t.symbol(a.HOME);break;case 4:l+=t.symbol(a.HOME);break;case 5:case 17:l+=t.symbol(a.BLANK)+"2";break;case 6:case 18:l+=t.symbol(a.BLANK)+"57";break;case 7:case 19:l+=t.symbol(a.BLANK)+"316";break;case 8:case 20:l+=t.symbol(a.BLANK)+"6926";break;case 9:case 21:l+=t.symbol(a.BLANK)+"36520";break;case 10:case 22:l+=t.symbol(a.BLANK)+t.embed_dot("1.6");break;case 11:case 23:l+=t.symbol(a.BLANK)+t.embed_dot("2.64");break;case 12:case 24:l+=t.symbol(a.BLANK)+t.embed_dot("21.4");break;case 13:case 25:l+=t.symbol(a.BLANK)+t.embed_dot("34.26");break;case 14:case 26:l+=t.symbol(a.BLANK)+t.embed_dot("315.7");break;case 15:case 27:l+=t.symbol(a.BLANK)+t.embed_dot("562.46");break;case 16:case 28:l+=t.symbol(a.BLANK)+t.embed_dot("4629.1");break}}l==""&&(l="CE_"+(o+1)),e.items[_].preview=l}}if(i>=p.OSD_CUSTOM_ELEMENTS.settings.customElementsCount)break}s.GUI.updatePreviews()}function Ue(){for(var i=0;i<p.OSD_CUSTOM_ELEMENTS.settings.customElementsCount;i++){for(var e=0;e<p.OSD_CUSTOM_ELEMENTS.settings.customElementParts;e++){n(".osdCustomElement-"+i+"-part-"+e+"-type").val(p.OSD_CUSTOM_ELEMENTS.items[i].customElementItems[e].type).trigger("change");var o=n(".osdCustomElement-"+i+"-part-"+e+"-value");switch(p.OSD_CUSTOM_ELEMENTS.items[i].customElementItems[e].type){case 1:o.find(".text").val(p.OSD_CUSTOM_ELEMENTS.items[i].customElementText).trigger("change");break;case 2:o.find(".ico").val(p.OSD_CUSTOM_ELEMENTS.items[i].customElementItems[e].value).trigger("change");break;case 3:o.find(".ico_gv").val(p.OSD_CUSTOM_ELEMENTS.items[i].customElementItems[e].value).trigger("change");break;case 4:o.find(".ico_lc").val(p.OSD_CUSTOM_ELEMENTS.items[i].customElementItems[e].value).trigger("change");break;case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:o.find(".gv").val(p.OSD_CUSTOM_ELEMENTS.items[i].customElementItems[e].value).trigger("change");break;case 17:case 18:case 19:case 20:case 21:case 22:case 23:case 24:case 25:case 26:case 27:case 28:o.find(".lc").val(p.OSD_CUSTOM_ELEMENTS.items[i].customElementItems[e].value).trigger("change");break}}n(".osdCustomElement-"+i+"-visibility-type").val(p.OSD_CUSTOM_ELEMENTS.items[i].customElementVisibility.type).trigger("change");var r=n(".osdCustomElement-"+i+"-visibility-value");switch(p.OSD_CUSTOM_ELEMENTS.items[i].customElementVisibility.type){case 1:r.find(".gv").val(p.OSD_CUSTOM_ELEMENTS.items[i].customElementVisibility.value).trigger("change");break;case 2:r.find(".lc").val(p.OSD_CUSTOM_ELEMENTS.items[i].customElementVisibility.value).trigger("change");break}Te(i),Ae(i)}}function Fe(){var i=function(){var o=n(this).closest("tr").data("row");Te(o),Ae(o),x.promise(F.MSP2_INAV_SET_CUSTOM_OSD_ELEMENTS,Ve(o))},e=n("#osdCustomElements");e.find("input, select").change(i),e.find("input").keyup(i)}function Te(i){for(var e=0;e<p.OSD_CUSTOM_ELEMENTS.settings.customElementParts;e++){var o=n(".osdCustomElement-"+i+"-part-"+e+"-type"),r=n("."+o.data("valueCellClass"));switch(parseInt(o.val())){case 1:r.find(".text").val(r.find(".text").val().toUpperCase()),r.find(".text").val(r.find(".text").val().replace(/[^A-Z0-9!.\* ]/g,""));break;case 2:r.find(".ico").val(r.find(".ico").val()>255?255:r.find(".ico").val()),r.find(".ico").val(r.find(".ico").val()!=""&&r.find(".ico").val()<1?1:r.find(".ico").val())}}be()}function Ae(i){var e=!1;for(let o=0;o<p.OSD_CUSTOM_ELEMENTS.settings.customElementParts;o++){let r=n(".osdCustomElement-"+i+"-part-"+o+"-type");if(parseInt(r.val())===1){e=o;break}}for(let o=0;o<p.OSD_CUSTOM_ELEMENTS.settings.customElementParts;o++){let r=n(".osdCustomElement-"+i+"-part-"+o+"-type");o!==e&&e!==!1?r.find('option[value="1"]').attr("disabled","disabled"):r.find('option[value="1"]').removeAttr("disabled")}}function Ve(i){var e=[];e.push8(i);for(var o="",r=0;r<p.OSD_CUSTOM_ELEMENTS.settings.customElementParts;r++){var d=n(".osdCustomElement-"+i+"-part-"+r+"-type"),_=n("."+d.data("valueCellClass")),l=0;switch(parseInt(d.val())){case 1:o=_.find(".text").val();break;case 2:l=parseInt(_.find(".ico").val());break;case 3:l=parseInt(_.find(".ico_gv").find(":selected").val());break;case 4:l=parseInt(_.find(".ico_lc").find(":selected").val());break;case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:l=parseInt(_.find(".gv").find(":selected").val());break;case 17:case 18:case 19:case 20:case 21:case 22:case 23:case 24:case 25:case 26:case 27:case 28:l=parseInt(_.find(".lc").find(":selected").val());break}e.push8(parseInt(d.val())),e.push16(l)}var u=n(".osdCustomElement-"+i+"-visibility-type"),m=n("."+u.data("valueCellClass")),v=null;switch(parseInt(u.val())){case 1:v=parseInt(m.find(".gv").find(":selected").val());break;case 2:v=parseInt(m.find(".lc").find(":selected").val());break}e.push8(parseInt(u.val())),e.push16(v),console.log("Saving osd custom data for number "+i+" | data: "+e);for(var I=0;I<p.OSD_CUSTOM_ELEMENTS.settings.customElementTextSize;I++)I<o.length?e.push8(o.charCodeAt(I)):e.push8(0);return e}function q(){for(var i="",e=0;e<8;e++)i+='<option value="'+e+'">GV '+e+"</option>";return i}function Q(){for(var i="",e=0;e<p.LOGIC_CONDITIONS.getMaxLogicConditionCount();e++)p.LOGIC_CONDITIONS.isEnabled(e)&&(i+='<option value="'+e+'">LC '+e+"</option>");return i}function ee(){let i=s.constants.ALL_DISPLAY_GROUPS.filter(function(e){return e.name=="osdGroupSwitchIndicators"})[0];for(let e=0;e<i.items.length;e++){let o=i.items[e];if(n("#osdSwitchInd"+e+"_name").val()!=null){let r=n("#osdSwitchInd"+e+"_name").val();r==""?o.preview=t.symbol(a.SWITCH_INDICATOR_HIGH):n("#switchIndicators_alignLeft").prop("checked")?o.preview=r+t.symbol(a.SWITCH_INDICATOR_HIGH):o.preview=t.symbol(a.SWITCH_INDICATOR_HIGH)+r}}s.GUI.updatePreviews()}function j(){let i=n("#pilot_name").val()==null,e=n("#craft_name").val()==null,o=s.constants.ALL_DISPLAY_GROUPS.filter(function(r){return r.name=="osdGroupGeneral"})[0];if(n("#craft_name").val()!=null||n("#pilot_name").val()!=null)for(let r=0;r<o.items.length;r++){if(o.items[r].name=="CRAFT_NAME"){let d=n("#craft_name").val();d==""?o.items[r].preview="CRAFT_NAME":o.items[r].preview=d,e=!0}if(o.items[r].name=="PILOT_NAME"){let d=n("#pilot_name").val();d==""?o.items[r].preview="PILOT_NAME":o.items[r].preview=d,i=!0}if(e&&i)break}s.GUI.updatePreviews()}function ae(){n("#panServoOutput").val()==="0"?(n("#osd_pan_settings").hide(),n("#panServoOutput").parent().addClass("no-bottom")):(n("#osd_pan_settings").show(),n("#panServoOutput").parent().removeClass("no-bottom"));let i=p.SERVO_RULES;n("#panServoOutput option").each(function(){let o=n(this).val();if(o==="0")n(this).text("OFF");else{let r=i.getServoMixRuleFromTarget(o);if(r==null)n(this).remove();else{let d=parseInt(r.getInput());n(this).text("Servo "+o+": "+p.getServoMixInputName(d))}}});let e=s.constants.ALL_DISPLAY_GROUPS.filter(function(o){return o.name=="osdGroupGeneral"})[0];for(let o=0;o<e.items.length;o++)if(e.items[o].name=="PAN_SERVO_CENTRED"){n("#craft_name").val(),n("#osdPanServoIndicatorShowDegrees").prop("checked")?e.items[o].preview=t.symbol(a.PAN_SERVO_IS_OFFSET_L)+"120"+t.symbol(a.DEGREES):e.items[o].preview=t.symbol(a.PAN_SERVO_IS_OFFSET_L);break}s.GUI.updatePreviews()}se.osd.cleanup=function(i){Me.flush_callbacks(),n(document).unbind("keypress"),n(document).off("click","span.progressLabel a"),delete s.GUI.jbox,n(".jBox-wrapper").remove(),i&&i()};
